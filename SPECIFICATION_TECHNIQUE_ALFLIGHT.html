<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpÃ©cification Technique ComplÃ¨te - ALFlight</title>
    <style>
        @page {
            size: A4;
            margin: 2cm;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #fff;
        }

        h1 {
            color: #93163C;
            border-bottom: 3px solid #93163C;
            padding-bottom: 10px;
            margin-top: 40px;
            font-size: 32px;
        }

        h2 {
            color: #93163C;
            border-bottom: 2px solid #ddd;
            padding-bottom: 8px;
            margin-top: 30px;
            font-size: 26px;
        }

        h3 {
            color: #333;
            margin-top: 25px;
            font-size: 20px;
            border-left: 4px solid #93163C;
            padding-left: 15px;
        }

        h4 {
            color: #555;
            margin-top: 20px;
            font-size: 16px;
            font-weight: 600;
        }

        .toc {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 8px;
            margin: 30px 0;
            border: 1px solid #ddd;
        }

        .toc h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .toc ul {
            list-style: none;
            padding-left: 0;
        }

        .toc ul ul {
            padding-left: 30px;
        }

        .toc li {
            margin: 10px 0;
        }

        .toc a {
            text-decoration: none;
            color: #93163C;
            font-weight: 500;
        }

        .toc a:hover {
            text-decoration: underline;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 14px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th {
            background: #93163C;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 10px 12px;
            border: 1px solid #ddd;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            color: #d63384;
        }

        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #93163C;
            overflow-x: auto;
            font-size: 13px;
            line-height: 1.4;
        }

        pre code {
            background: none;
            padding: 0;
            color: #333;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #0366d6;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .error-box {
            background: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin: 0 5px 5px 0;
        }

        .badge-primary {
            background: #93163C;
            color: white;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-warning {
            background: #ffc107;
            color: #333;
        }

        .badge-info {
            background: #17a2b8;
            color: white;
        }

        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        li {
            margin: 8px 0;
        }

        .file-tree {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.8;
            border: 1px solid #ddd;
        }

        .highlight {
            background: #ffeb3b;
            padding: 2px 4px;
            font-weight: 600;
        }

        strong {
            color: #93163C;
        }

        .page-break {
            page-break-after: always;
        }

        @media print {
            body {
                font-size: 11pt;
            }

            h1 {
                page-break-before: always;
                page-break-after: avoid;
            }

            h2, h3 {
                page-break-after: avoid;
            }

            table {
                page-break-inside: avoid;
            }

            .info-box, .warning-box, .success-box, .error-box {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>

<!-- PAGE DE GARDE -->
<div style="text-align: center; padding: 100px 0;">
    <h1 style="font-size: 48px; border: none; color: #93163C;">ALFLIGHT</h1>
    <h2 style="font-size: 32px; border: none; color: #555; margin-top: 20px;">SpÃ©cification Technique ComplÃ¨te</h2>
    <p style="font-size: 18px; color: #777; margin-top: 40px;">Documentation exhaustive du systÃ¨me de prÃ©paration de vol</p>
    <p style="font-size: 14px; color: #999; margin-top: 60px;">Version 3.0.0 (Architecture Zustand)</p>
    <p style="font-size: 14px; color: #999;">Date: <span id="doc-date"></span></p>
    <script>document.getElementById('doc-date').textContent = new Date().toLocaleDateString('fr-FR');</script>
</div>

<div class="page-break"></div>

<!-- TABLE DES MATIÃˆRES -->
<div class="toc">
    <h2>Table des matiÃ¨res</h2>
    <ul>
        <li><a href="#intro">1. Introduction GÃ©nÃ©rale</a>
            <ul>
                <li><a href="#intro-objectif">1.1 Objectif Global</a></li>
                <li><a href="#intro-vision">1.2 Vision et FinalitÃ©</a></li>
                <li><a href="#intro-archi">1.3 Architecture GÃ©nÃ©rale</a></li>
            </ul>
        </li>
        <li><a href="#modules">2. Description DÃ©taillÃ©e des Modules</a>
            <ul>
                <li><a href="#modules-core">2.1 Modules de Planification de Vol</a></li>
                <li><a href="#modules-support">2.2 Modules de Support</a></li>
                <li><a href="#modules-admin">2.3 Modules Administratifs</a></li>
            </ul>
        </li>
        <li><a href="#assistants">3. Les Deux Assistants IntÃ©grÃ©s</a>
            <ul>
                <li><a href="#assistant-aircraft">3.1 Assistant de CrÃ©ation d'Avion</a></li>
                <li><a href="#assistant-flight">3.2 Assistant de PrÃ©paration de Vol</a></li>
                <li><a href="#assistant-interaction">3.3 Interactions Entre Assistants</a></li>
            </ul>
        </li>
        <li><a href="#database">4. Base de DonnÃ©es Supabase</a>
            <ul>
                <li><a href="#db-structure">4.1 Structure ComplÃ¨te</a></li>
                <li><a href="#db-tables">4.2 Tables et Relations</a></li>
                <li><a href="#db-triggers">4.3 Triggers et Fonctions</a></li>
                <li><a href="#db-storage">4.4 Storage Buckets</a></li>
            </ul>
        </li>
        <li><a href="#services">5. Couche de Services (32 Services)</a>
            <ul>
                <li><a href="#services-aixm">5.1 Services AIXM/SIA</a></li>
                <li><a href="#services-vac">5.2 Services VAC</a></li>
                <li><a href="#services-perf">5.3 Services Performance</a></li>
                <li><a href="#services-integration">5.4 Services d'IntÃ©gration</a></li>
            </ul>
        </li>
        <li><a href="#architecture">6. Architecture du Projet</a>
            <ul>
                <li><a href="#archi-files">6.1 Inventaire Complet des Fichiers</a></li>
                <li><a href="#archi-structure">6.2 Structure des RÃ©pertoires</a></li>
                <li><a href="#archi-tech">6.3 Stack Technologique</a></li>
            </ul>
        </li>
        <li><a href="#dataflow">7. Flux de Communication</a>
            <ul>
                <li><a href="#flow-state">7.1 Gestion d'Ã‰tat (Zustand)</a></li>
                <li><a href="#flow-contexts">7.2 Contextes React</a></li>
                <li><a href="#flow-inter">7.3 Interconnexions Modules</a></li>
            </ul>
        </li>
        <li><a href="#automation">8. CapacitÃ©s d'Automatisation</a>
            <ul>
                <li><a href="#auto-ai">8.1 Intelligence Artificielle</a></li>
                <li><a href="#auto-calc">8.2 Calculs Automatiques</a></li>
                <li><a href="#auto-sync">8.3 Synchronisation Cloud</a></li>
            </ul>
        </li>
        <li><a href="#technical">9. Aspects Techniques et Performance</a>
            <ul>
                <li><a href="#tech-stack">9.1 Technologies UtilisÃ©es</a></li>
                <li><a href="#tech-perf">9.2 Optimisations Performance</a></li>
                <li><a href="#tech-security">9.3 SÃ©curitÃ©</a></li>
            </ul>
        </li>
        <li><a href="#annexes">10. Annexes</a>
            <ul>
                <li><a href="#annex-glossary">10.1 Glossaire</a></li>
                <li><a href="#annex-dependencies">10.2 DÃ©pendances</a></li>
                <li><a href="#annex-config">10.3 Configuration</a></li>
            </ul>
        </li>
    </ul>
</div>

<div class="page-break"></div>

<!-- SECTION 1: INTRODUCTION GÃ‰NÃ‰RALE -->
<h1 id="intro">1. Introduction GÃ©nÃ©rale</h1>

<h2 id="intro-objectif">1.1 Objectif Global de ALFlight</h2>

<p><strong>ALFlight</strong> est une application web progressive (PWA) de prÃ©paration de vol complÃ¨te, conÃ§ue spÃ©cifiquement pour l'aviation lÃ©gÃ¨re et la navigation VFR/IFR en France. L'application vise Ã  centraliser toutes les Ã©tapes de prÃ©paration de vol dans un environnement unique, moderne et hautement automatisÃ©.</p>

<div class="success-box">
    <strong>ğŸ¯ Mission Principale:</strong> Fournir aux pilotes privÃ©s et professionnels un outil complet de planification de vol qui intÃ¨gre donnÃ©es aÃ©ronautiques officielles (AIXM, SIA France), calculs de performances avancÃ©s, gestion du carburant, masse et centrage, mÃ©tÃ©o en temps rÃ©el, et gÃ©nÃ©ration automatique de plans de vol rÃ©glementaires.
</div>

<h3>Objectifs SpÃ©cifiques</h3>

<ul>
    <li><strong>Centralisation des donnÃ©es:</strong> Regrouper toutes les informations aÃ©ronautiques (aÃ©rodromes, espaces aÃ©riens, points VFR, cartes VAC, NOTAM, mÃ©tÃ©o) dans une interface unique</li>
    <li><strong>Automatisation des calculs:</strong> Calculs automatiques de distance, temps, carburant, performances, masse et centrage, Top of Descent (TOD)</li>
    <li><strong>Intelligence artificielle:</strong> Extraction automatique des tableaux de performances depuis les manuels de vol (MANEX) via OpenAI Vision</li>
    <li><strong>ConformitÃ© rÃ©glementaire:</strong> Respect des minimas rÃ©glementaires pour rÃ©serves de carburant, masse et centrage, limitations opÃ©rationnelles</li>
    <li><strong>Hors-ligne first:</strong> Fonctionnement complet sans connexion Internet grÃ¢ce au stockage local (IndexedDB) des donnÃ©es AIXM (42MB), cartes VAC, et configurations avion</li>
    <li><strong>Partage communautaire:</strong> Base de donnÃ©es partagÃ©e de configurations avion complÃ¨tes (masse, centrage, performances) avec systÃ¨me de votes</li>
</ul>

<h2 id="intro-vision">1.2 Vision et FinalitÃ© du Projet</h2>

<h3>Vision Ã  Long Terme</h3>

<p>ALFlight aspire Ã  devenir <strong>la rÃ©fÃ©rence francophone</strong> pour la prÃ©paration de vol en aviation lÃ©gÃ¨re, en offrant:</p>

<ol>
    <li><strong>âœ… APPLICATION PREMIUM PAYANTE DÃˆS LE DÃ‰BUT:</strong> Abonnement requis pour accÃ©der Ã  toutes les fonctionnalitÃ©s. QualitÃ© professionnelle garantie avec mises Ã  jour continues et support prioritaire.</li>
    <li><strong>IntÃ©gration mobile native:</strong> Applications iOS et Android via Capacitor pour utilisation en cockpit sur tablette ou smartphone</li>
    <li><strong>Extension internationale:</strong> Support des donnÃ©es AIXM europÃ©ennes (EUROCONTROL), puis mondiales (USA FAA, Canada Nav Canada, etc.)</li>
    <li><strong>Support multi-types d'aÃ©ronefs:</strong> Extension future aux hÃ©licoptÃ¨res et ULM avec calculs de performances spÃ©cifiques</li>
    <li><strong>Ã‰cosystÃ¨me ouvert:</strong> API publique pour intÃ©gration avec autres outils (EFB, cartes Ã©lectroniques, systÃ¨mes embarquÃ©s)</li>
</ol>

<h3>FinalitÃ© pour les Utilisateurs</h3>

<div class="info-box">
    <strong>Pour le Pilote PrivÃ©:</strong>
    <ul>
        <li>PrÃ©parer un vol complet en 15-20 minutes (vs 45-60 minutes manuellement)</li>
        <li>Avoir confiance dans les calculs de performances et de masse grÃ¢ce aux donnÃ©es issues des manuels officiels</li>
        <li>Respecter automatiquement les minimas rÃ©glementaires</li>
        <li>GÃ©nÃ©rer un dossier de vol PDF imprimable et archivable</li>
    </ul>
</div>

<div class="info-box">
    <strong>Pour l'Ã‰cole de Pilotage:</strong>
    <ul>
        <li>Outil pÃ©dagogique pour enseigner la prÃ©paration de vol</li>
        <li>Base de donnÃ©es centralisÃ©e des avions de la flotte</li>
        <li>Suivi des vols et statistiques par Ã©lÃ¨ve</li>
        <li>ConformitÃ© avec les procÃ©dures internes</li>
    </ul>
</div>

<h2 id="intro-archi">1.3 Architecture GÃ©nÃ©rale (Vue d'Ensemble)</h2>

<h3>Architecture en 4 Couches</h3>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   COUCHE PRÃ‰SENTATION                         â”‚
â”‚                                                                â”‚
â”‚  â€¢ React 18.2 (UI Components)                                 â”‚
â”‚  â€¢ Material-UI 7.3 (Design System)                            â”‚
â”‚  â€¢ Leaflet 1.9.4 (Cartes interactives)                        â”‚
â”‚  â€¢ Recharts 3.1.2 (Graphiques)                                â”‚
â”‚  â€¢ 18 Feature Modules                                         â”‚
â”‚  â€¢ 2 Assistants (Avion, Vol)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   COUCHE LOGIQUE MÃ‰TIER                       â”‚
â”‚                                                                â”‚
â”‚  â€¢ 32 Services (AIXM, VAC, Performance, Weather, etc.)       â”‚
â”‚  â€¢ Hooks mÃ©tier (useNavigationResults, useAlternates, etc.)  â”‚
â”‚  â€¢ Calculs (interpolation, navigation, masse et centrage)    â”‚
â”‚  â€¢ Validations (conformitÃ© rÃ©glementaire)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   COUCHE GESTION D'Ã‰TAT                       â”‚
â”‚                                                                â”‚
â”‚  â€¢ Zustand (15 stores globaux)                               â”‚
â”‚  â€¢ React Contexts (couche d'accÃ¨s)                           â”‚
â”‚  â€¢ localStorage (donnÃ©es simples)                            â”‚
â”‚  â€¢ IndexedDB (fichiers volumineux: MANEX, AIXM, VAC)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   COUCHE DONNÃ‰ES                              â”‚
â”‚                                                                â”‚
â”‚  â€¢ Supabase PostgreSQL (avions, plans de vol, communautÃ©)   â”‚
â”‚  â€¢ Supabase Storage (MANEX PDFs, VAC PDFs, photos)          â”‚
â”‚  â€¢ AIXM XML Local (42MB donnÃ©es aÃ©ronautiques France)        â”‚
â”‚  â€¢ APIs Externes (OpenAI, AVWX Weather, OpenAIP)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3>Choix Architecturaux ClÃ©s</h3>

<table>
    <thead>
        <tr>
            <th>Aspect</th>
            <th>Choix Technologique</th>
            <th>Justification</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Framework UI</td>
            <td>React 18.2</td>
            <td>Ã‰cosystÃ¨me mature, performances, composants rÃ©utilisables</td>
        </tr>
        <tr>
            <td>Build Tool</td>
            <td>Vite 7.0.6</td>
            <td>Build ultra-rapide (10x plus rapide que Webpack), HMR instantanÃ©</td>
        </tr>
        <tr>
            <td>State Management</td>
            <td>Zustand 4.5.7</td>
            <td>Simple, performant, pas de boilerplate, immer intÃ©grÃ©</td>
        </tr>
        <tr>
            <td>Backend</td>
            <td>Supabase (PostgreSQL + Storage)</td>
            <td>Backend-as-a-Service, authentification intÃ©grÃ©e, temps rÃ©el, coÃ»t minimal</td>
        </tr>
        <tr>
            <td>Mobile</td>
            <td>Capacitor 7.4.3</td>
            <td>Code partagÃ© web/mobile, accÃ¨s natif (GPS, filesystem, etc.)</td>
        </tr>
        <tr>
            <td>Cartes</td>
            <td>Leaflet 1.9.4</td>
            <td>LÃ©ger, extensible, compatible mobile</td>
        </tr>
        <tr>
            <td>PDF</td>
            <td>pdf-lib + pdfjs-dist</td>
            <td>GÃ©nÃ©ration et lecture PDF cÃ´tÃ© client</td>
        </tr>
        <tr>
            <td>IA</td>
            <td>OpenAI GPT-4o Vision</td>
            <td>Extraction donnÃ©es depuis images de tableaux de performances</td>
        </tr>
    </tbody>
</table>

<h3>Front-End vs Back-End</h3>

<div class="warning-box">
    <strong>âš ï¸ Architecture Front-End Heavy:</strong> ALFlight est principalement une application front-end. Le back-end (Supabase) sert uniquement de stockage cloud optionnel. <strong>Toute la logique mÃ©tier</strong> (calculs, interpolations, validations) est cÃ´tÃ© client pour permettre le fonctionnement hors-ligne.
</div>

<ul>
    <li><strong>Front-End (Client):</strong> 99% de la logique
        <ul>
            <li>Parsing AIXM XML (42MB)</li>
            <li>Calculs de navigation (distance, cap, temps)</li>
            <li>Interpolation des performances (2D/3D)</li>
            <li>Calculs de masse et centrage</li>
            <li>GÃ©nÃ©ration PDF</li>
            <li>Gestion d'Ã©tat complÃ¨te</li>
        </ul>
    </li>
    <li><strong>Back-End (Supabase):</strong> 1% stockage optionnel
        <ul>
            <li>Sauvegarde plans de vol (optionnel)</li>
            <li>Partage configurations avion (communautÃ©)</li>
            <li>Authentification utilisateur</li>
            <li>Synchronisation multi-appareils</li>
        </ul>
    </li>
</ul>

<div class="page-break"></div>

<!-- SECTION 2: MODULES DÃ‰TAILLÃ‰S -->
<h1 id="modules">2. Description DÃ©taillÃ©e des Modules</h1>

<p>ALFlight est organisÃ© en <strong>18 modules fonctionnels</strong> autonomes, chacun responsable d'un aspect spÃ©cifique de la prÃ©paration de vol.</p>

<h2 id="modules-core">2.1 Modules de Planification de Vol (Core)</h2>

<h3 id="module-aircraft">2.1.1 Module Aircraft (Gestion des Avions)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/aircraft/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Base de donnÃ©es complÃ¨te des avions avec masse, centrage, performances, vitesses, Ã©quipements<br>
    <strong>ğŸ“¦ Store:</strong> <code>aircraftStore</code> (Zustand) + Supabase sync<br>
    <strong>ğŸ’¾ Persistance:</strong> IndexedDB (avions locaux) + Supabase (communautÃ©)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
            <th>Lignes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>AircraftModule.jsx</code></td>
            <td>Interface liste avions + sÃ©lection</td>
            <td>~800</td>
        </tr>
        <tr>
            <td>Wizard CrÃ©ation</td>
            <td><code>AircraftCreationWizard.jsx</code></td>
            <td>Assistant 7 Ã©tapes (dÃ©taillÃ© section 3.1)</td>
            <td>1420</td>
        </tr>
        <tr>
            <td>Import MANEX</td>
            <td><code>ManexImporter.jsx</code></td>
            <td>Upload manuel de vol (PDF)</td>
            <td>~350</td>
        </tr>
        <tr>
            <td>Analyseur Perf</td>
            <td><code>AdvancedPerformanceAnalyzer.jsx</code></td>
            <td>IA extraction tableaux performances</td>
            <td>~600</td>
        </tr>
        <tr>
            <td>ABAC Builder</td>
            <td><code>AbacBuilderWrapper.jsx</code></td>
            <td>Digitalisation abaques interactifs</td>
            <td>~500</td>
        </tr>
    </tbody>
</table>

<h4>Structure de DonnÃ©es Avion</h4>

<pre><code>{
  // Identification
  id: UUID,
  registration: "F-HSTR",
  model: "DA40 NG",
  manufacturer: "Diamond Aircraft",
  aircraftType: "Avion monomoteur",

  // Vitesses caractÃ©ristiques (kt)
  speeds: {
    vso: 43,  // DÃ©crochage config atterrissage
    vs1: 48,  // DÃ©crochage lisse
    vne: 154, // Ne jamais dÃ©passer
    vno: 127, // Normale max
    vfe: 111, // Volets max
    vy: 76,   // Meilleur taux montÃ©e
    vx: 60,   // Meilleur angle montÃ©e
    // ... 10+ vitesses
  },

  // Masses (kg storage, convertible gal/lbs/ltr)
  weights: {
    emptyWeight: 795,
    mtow: 1150,
    maxPayload: 355,
    // ...
  },

  // Bras de levier (m depuis datum)
  arms: {
    empty: 2.15,
    frontSeats: 2.40,
    rearSeats: 2.85,
    fuelMain: 2.60,
    // ...
  },

  // Enveloppe de centrage
  cgLimits: {
    forward: 2.10,
    aft: 2.50
  },
  cgEnvelope: {
    forwardPoints: [{weight, cg}, ...],
    aftPoints: [{weight, cg}, ...]
  },

  // Performances (tables + modÃ¨les IA)
  performanceTables: [
    {
      type: "takeoff",
      conditions: {altitude, temperature, mass},
      data: [[...], [...]] // Matrice interpolable
    }
  ],
  performanceModels: { /* ModÃ¨les OpenAI extraits */ },

  // Ã‰quipements (codes OACI)
  equipmentCom: {vhf1: true, vhf2: true, ...},
  equipmentNav: {vor: true, dme: true, gnss: true, ...},
  equipmentSurv: {transponderMode: 'C', adsb: false, ...},

  // MANEX PDF
  manex: {
    fileName: "DA40_AFM.pdf",
    fileSize: "25 MB",
    pdfData: "base64..." // ou remoteUrl Supabase
  }
}
</code></pre>

<h4>FonctionnalitÃ©s ClÃ©s</h4>

<ul>
    <li><strong>CrÃ©ation guidÃ©e:</strong> Wizard 7 Ã©tapes avec validation Ã  chaque Ã©tape</li>
    <li><strong>Import MANEX:</strong> Upload PDF manuel de vol jusqu'Ã  50MB</li>
    <li><strong>Extraction IA:</strong> GPT-4o Vision extrait automatiquement tableaux de performances depuis images</li>
    <li><strong>ABAC Curves:</strong> SystÃ¨me TypeScript complet pour digitaliser abaques (courbes de performances)</li>
    <li><strong>Partage communautaire:</strong> Upload configuration avion sur Supabase avec votes up/down</li>
    <li><strong>Variants:</strong> CrÃ©er variantes d'avion existant (ex: F-GBCD basÃ© sur F-HSTR avec masse diffÃ©rente)</li>
    <li><strong>Synchronisation:</strong> Sync bidirectionnelle IndexedDB â†” Supabase</li>
</ul>

<h4>Variables Principales</h4>

<table>
    <thead>
        <tr>
            <th>Variable</th>
            <th>Type</th>
            <th>Source</th>
            <th>Usage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>selectedAircraft</code></td>
            <td>Object</td>
            <td>aircraftStore</td>
            <td>Avion actif pour calculs</td>
        </tr>
        <tr>
            <td><code>aircraftList</code></td>
            <td>Array</td>
            <td>aircraftStore</td>
            <td>Liste complÃ¨te avions</td>
        </tr>
        <tr>
            <td><code>isInitialized</code></td>
            <td>Boolean</td>
            <td>aircraftStore</td>
            <td>Supabase chargÃ©</td>
        </tr>
        <tr>
            <td><code>performanceTables</code></td>
            <td>Array</td>
            <td>aircraft.performanceTables</td>
            <td>Interpolation perf</td>
        </tr>
    </tbody>
</table>

<h4>Interfaces avec Autres Modules</h4>

<ul>
    <li><strong>â†’ Performance Module:</strong> Fournit <code>performanceTables</code> pour interpolation</li>
    <li><strong>â†’ Weight-Balance Module:</strong> Fournit <code>arms</code>, <code>cgLimits</code>, <code>cgEnvelope</code></li>
    <li><strong>â†’ Fuel Module:</strong> Fournit <code>fuelConsumption</code>, <code>fuelCapacity</code></li>
    <li><strong>â†’ Navigation Module:</strong> Fournit <code>cruiseSpeed</code>, <code>climbRate</code></li>
    <li><strong>â†’ Flight Wizard:</strong> SÃ©lection avion Ã©tape 1</li>
</ul>

<div class="page-break"></div>

<h3 id="module-navigation">2.1.2 Module Navigation (Planification de Route)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/navigation/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Planification route avec waypoints, calcul distance/temps/carburant, analyse espaces aÃ©riens<br>
    <strong>ğŸ“¦ Store:</strong> <code>navigationStore</code><br>
    <strong>ğŸ—ºï¸ Carte:</strong> Leaflet avec couches OpenStreetMap + Espaces aÃ©riens
</div>

<h4>Composants Majeurs (20+)</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>RÃ´le</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>NavigationModule.jsx</code></td>
            <td>Interface principale: tableau navigation + carte</td>
        </tr>
        <tr>
            <td><code>AirportSelectorSIA.jsx</code></td>
            <td>Recherche aÃ©rodrome (493 aÃ©rodromes France AIXM)</td>
        </tr>
        <tr>
            <td><code>ReportingPointsSelector.jsx</code></td>
            <td>Points VFR depuis cartes VAC</td>
        </tr>
        <tr>
            <td><code>WaypointCardWithRunways.jsx</code></td>
            <td>Carte waypoint avec pistes, frÃ©quences, Ã©lÃ©vation</td>
        </tr>
        <tr>
            <td><code>RunwayAnalyzer.jsx</code></td>
            <td>Analyse pistes: vent, surface, longueur</td>
        </tr>
        <tr>
            <td><code>AirspaceAnalyzer.jsx</code></td>
            <td>DÃ©tection conflits espaces aÃ©riens</td>
        </tr>
        <tr>
            <td><code>WindAnalysis.jsx</code></td>
            <td>Composantes vent (travers, effectif)</td>
        </tr>
        <tr>
            <td><code>TopOfDescent.jsx</code></td>
            <td>Calcul TOD/TOC</td>
        </tr>
    </tbody>
</table>

<h4>Hook Principal: useNavigationResults</h4>

<pre><code>// Hook qui calcule AUTOMATIQUEMENT tous les rÃ©sultats de navigation
const navigationResults = useNavigationResults();

// Retourne:
{
  totalDistance: 347.2,    // NM
  totalTime: 210,          // minutes
  fuelRequired: 105.3,     // liters (unitÃ©s storage)
  legs: [
    {
      from: "LFST",
      to: "LFMP",
      distance: 167.8,     // NM
      bearing: 245,        // degrÃ©s
      time: 101,           // minutes
      fuelRequired: 50.5   // liters
    },
    // ... autres segments
  ],
  airspaceConflicts: [...] // Espaces traversÃ©s
}
</code></pre>

<h4>DonnÃ©es de Navigation</h4>

<pre><code>// navigationStore
{
  waypoints: [
    {
      type: "departure",
      icao: "LFST",
      name: "STRASBOURG ENTZHEIM",
      lat: 48.5444,
      lon: 7.6283,
      elevation: 490 // ft
    },
    {
      type: "vfr",
      name: "STS (Strasbourg)",
      lat: 48.5742,
      lon: 7.7658,
      elevation: 0
    },
    {
      type: "arrival",
      icao: "LFMP",
      name: "PERPIGNAN RIVESALTES",
      lat: 42.7405,
      lon: 2.8721,
      elevation: 144
    }
  ],
  segmentAltitudes: {
    "LFST-STS": { startAlt: 2500, cruiseAlt: 3500 },
    "STS-LFMP": { startAlt: 3500, cruiseAlt: 4500 }
  },
  flightType: "VFR",
  dayNight: "day"
}
</code></pre>

<h4>Calculs Automatiques</h4>

<table>
    <thead>
        <tr>
            <th>Calcul</th>
            <th>Formule</th>
            <th>UnitÃ©s</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Distance</td>
            <td>Haversine (lat1, lon1, lat2, lon2)</td>
            <td>NM</td>
        </tr>
        <tr>
            <td>Cap</td>
            <td>atan2(Î”lon, Î”lat) avec correction magnÃ©tique</td>
            <td>degrÃ©s</td>
        </tr>
        <tr>
            <td>Temps</td>
            <td>distance / groundSpeed</td>
            <td>minutes</td>
        </tr>
        <tr>
            <td>Carburant</td>
            <td>(time / 60) Ã— fuelConsumption</td>
            <td>liters</td>
        </tr>
        <tr>
            <td>TOD</td>
            <td>(altToDescent / descentRate) Ã— groundSpeed</td>
            <td>NM avant destination</td>
        </tr>
    </tbody>
</table>

<h4>Sources de DonnÃ©es AÃ©ronautiques</h4>

<ul>
    <li><strong>AIXM 4.5 XML (42MB):</strong> Fichier <code>AIXM4.5_all_FR_OM_2025-11-27.xml</code> contenant:
        <ul>
            <li>493 aÃ©rodromes France mÃ©tropolitaine</li>
            <li>Runways (QFU, dimensions, TORA/TODA/ASDA/LDA)</li>
            <li>FrÃ©quences (TWR, APP, GND, ATIS)</li>
            <li>Points VFR (Designated Points)</li>
            <li>Navaids (VOR, NDB, DME)</li>
        </ul>
    </li>
    <li><strong>OpenAIP Airspaces:</strong> GÃ©omÃ©tries espaces aÃ©riens (CTR, TMA, zones rÃ©glementÃ©es)</li>
    <li><strong>VAC Charts:</strong> Points VFR reporting points extraits des cartes VAC</li>
</ul>

<h4>Interfaces avec Autres Modules</h4>

<ul>
    <li><strong>â†’ Fuel Module:</strong> <code>navigationResults.fuelRequired</code> alimente automatiquement le carburant voyage</li>
    <li><strong>â†’ Alternates Module:</strong> Route utilisÃ©e pour calculer zone de recherche dÃ©routements</li>
    <li><strong>â†’ Weather Module:</strong> ICAOs waypoints â†’ auto-fetch METARs</li>
    <li><strong>â†’ VAC Module:</strong> ICAOs â†’ tÃ©lÃ©chargement VAC correspondantes</li>
    <li><strong>â†’ Performance Module:</strong> Altitudes segments pour calculs performances</li>
</ul>

<div class="success-box">
    <strong>âœ¨ Point Fort:</strong> Le hook <code>useNavigationResults()</code> recalcule automatiquement distance, temps et carburant Ã  chaque modification de la route. Les modules dÃ©pendants (Fuel, Alternates) reÃ§oivent instantanÃ©ment les mises Ã  jour grÃ¢ce aux Contexts React.
</div>

<h3 id="module-alternates">2.1.3 Module Alternates (Gestion des DÃ©routements)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/alternates/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Recherche et sÃ©lection d'aÃ©rodromes de dÃ©routement avec calcul de distance, mÃ©tÃ©o, et scoring automatique<br>
    <strong>ğŸ“¦ Store:</strong> <code>alternatesStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (alternates sÃ©lectionnÃ©s)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
            <th>Lignes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>AlternatesModule.jsx</code></td>
            <td>Interface sÃ©lection dÃ©routements + carte</td>
            <td>~600</td>
        </tr>
        <tr>
            <td>SÃ©lecteur UnifiÃ©</td>
            <td><code>AlternateSelectorUnified.jsx</code></td>
            <td>Liste suggestions avec scoring</td>
            <td>~400</td>
        </tr>
        <tr>
            <td>Carte Alternates</td>
            <td><code>AlternatesMapView.jsx</code></td>
            <td>Visualisation gÃ©ographique + cercle recherche</td>
            <td>~350</td>
        </tr>
        <tr>
            <td>Hook SÃ©lection</td>
            <td><code>useAdvancedAlternateSelection.js</code></td>
            <td>Algorithme de scoring et tri</td>
            <td>~200</td>
        </tr>
    </tbody>
</table>

<h4>Algorithme de Scoring Alternates</h4>

<p>Le systÃ¨me calcule un <strong>score de pertinence</strong> pour chaque aÃ©rodrome basÃ© sur plusieurs critÃ¨res:</p>

<pre><code>Score Total = (Distance Ã— 0.35) + (Piste Ã— 0.30) + (Ã‰quipements Ã— 0.20) + (MÃ©tÃ©o Ã— 0.15)

DÃ©tails:
- Distance: 1.0 si < 50 NM, dÃ©gressif jusqu'Ã  100 NM
- Piste: Longueur > 1000m = 1.0, 800-1000m = 0.7, < 800m = 0.4
- Ã‰quipements: TWR/APP/GND (+0.3 chacun), ILS (+0.1)
- MÃ©tÃ©o: VMC = 1.0, Marginal = 0.6, IMC = 0.3
</code></pre>

<h4>Calcul du Rayon de Recherche</h4>

<p>Le rayon de recherche est calculÃ© automatiquement en fonction du carburant disponible aprÃ¨s le vol:</p>

<pre><code>// Carburant restant aprÃ¨s le vol
remainingFuel = totalFuel - (taxi + climb + cruise)

// Endurance restante (heures)
remainingEndurance = remainingFuel / fuelConsumption

// Rayon de recherche (NM)
searchRadius = remainingEndurance Ã— cruiseSpeed Ã— 0.7 // coefficient de sÃ©curitÃ©

Exemple:
- Carburant restant: 40L
- Consommation: 25L/h
- Vitesse croisiÃ¨re: 120 kt
â†’ Endurance: 1.6h
â†’ Rayon: 1.6 Ã— 120 Ã— 0.7 = 134 NM
</code></pre>

<h4>Affichage DÃ©tails AÃ©rodrome</h4>

<p>Chaque aÃ©rodrome sÃ©lectionnÃ© affiche:</p>
<ul>
    <li><strong>CoordonnÃ©es complÃ¨tes:</strong> DÃ©cimales + DMS (DegrÃ©s Minutes Secondes)</li>
    <li><strong>Pistes par direction:</strong> QFU, TORA, TODA, ASDA, LDA pour chaque sens</li>
    <li><strong>Altitude terrain:</strong> Ã‰lÃ©vation officielle</li>
    <li><strong>Distance:</strong> Depuis le dernier waypoint de la route</li>
    <li><strong>Score de pertinence:</strong> Pourcentage calculÃ©</li>
</ul>

<h4>Interfaces avec Autres Modules</h4>

<ul>
    <li><strong>â†’ Fuel Module:</strong> <code>alternateFuelRequired</code> alimente le carburant dÃ©routement</li>
    <li><strong>â†’ Weather Module:</strong> ICAOs alternates â†’ auto-fetch METARs</li>
    <li><strong>â†’ Navigation Module:</strong> Route utilisÃ©e pour calculer position et rayon</li>
    <li><strong>â†’ VAC Module:</strong> ICAOs â†’ tÃ©lÃ©chargement VAC correspondantes</li>
</ul>

<div class="success-box">
    <strong>âœ¨ Point Fort:</strong> Le hook <code>useAdvancedAlternateSelection()</code> recalcule automatiquement les suggestions Ã  chaque modification de la route ou du carburant. Le cercle de recherche est affichÃ© sur la carte avec rayon dynamique.
</div>

<h3 id="module-fuel">2.1.4 Module Fuel (Gestion du Carburant)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/fuel/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Calcul rÃ©glementaire du carburant avec minimas, rÃ©serves, et synchronisation automatique depuis navigation<br>
    <strong>ğŸ“¦ Store:</strong> <code>fuelStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (fuel data + FOB)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>FuelModule.jsx</code></td>
            <td>Tableau carburant avec 7 postes</td>
        </tr>
        <tr>
            <td>Hook Sync</td>
            <td><code>useFuelSync.js</code></td>
            <td>Synchronisation auto depuis navigation</td>
        </tr>
        <tr>
            <td>FuelRow</td>
            <td><code>FuelRow</code> (composant)</td>
            <td>Ligne Ã©ditable avec conversion unitÃ©s</td>
        </tr>
    </tbody>
</table>

<h4>Structure du Carburant (7 Postes)</h4>

<table>
    <thead>
        <tr>
            <th>Poste</th>
            <th>Description</th>
            <th>Calcul</th>
            <th>Ã‰ditable</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Roulage</strong></td>
            <td>Taxi dÃ©part + taxi arrivÃ©e</td>
            <td>DÃ©faut: 5L (configurable)</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td><strong>Trip (Voyage)</strong></td>
            <td>Carburant route complÃ¨te</td>
            <td><code>navigationResults.fuelRequired</code></td>
            <td>ğŸ”’ Auto (lecture seule)</td>
        </tr>
        <tr>
            <td><strong>Contingency (ImprÃ©vus)</strong></td>
            <td>5% du trip fuel (rÃ©glementaire)</td>
            <td><code>trip Ã— 0.05</code></td>
            <td>âœ… Oui (min 5%)</td>
        </tr>
        <tr>
            <td><strong>Alternate (DÃ©routement)</strong></td>
            <td>Carburant vers alternate le plus loin</td>
            <td><code>maxDistanceAlternate / GS Ã— flow</code></td>
            <td>ğŸ”’ Auto si alternates sÃ©lectionnÃ©s</td>
        </tr>
        <tr>
            <td><strong>Final Reserve</strong></td>
            <td>30 min en croisiÃ¨re (VFR jour)</td>
            <td><code>(30/60) Ã— fuelConsumption</code></td>
            <td>âœ… Oui (min 30 min)</td>
        </tr>
        <tr>
            <td><strong>Additional (Additionnel)</strong></td>
            <td>Marge dÃ©cision pilote</td>
            <td>DÃ©faut: 0L</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td><strong>Extra</strong></td>
            <td>Surplus embarquÃ©</td>
            <td>DÃ©faut: 0L</td>
            <td>âœ… Oui</td>
        </tr>
    </tbody>
</table>

<h4>Conversion Automatique des UnitÃ©s</h4>

<p>Le module gÃ¨re 4 unitÃ©s de carburant avec conversion bidirectionnelle:</p>

<pre><code>UnitÃ©s supportÃ©es: L (litres), gal (US gallons), kg, lbs

Conversions:
- 1 gal = 3.78541 L
- 1 L AVGAS = 0.8 kg (densitÃ©)
- 1 lbs = 0.453592 kg

Stockage interne: TOUJOURS en L et gal
Affichage: Selon prÃ©fÃ©rence utilisateur (hook useUnits)
</code></pre>

<h4>Validation RÃ©glementaire FOB</h4>

<p>Le systÃ¨me vÃ©rifie automatiquement que le <strong>Fuel On Board (FOB)</strong> est suffisant:</p>

<pre><code>FOB_required = roulage + trip + contingency + alternate + finalReserve + additional

if (FOB_actual < FOB_required) {
  // âŒ Alerte: Carburant insuffisant
  // EmpÃªche la validation du plan de vol
}

Affichage:
- âœ… Vert si FOB >= required + 10%
- âš ï¸  Orange si FOB >= required
- âŒ Rouge si FOB < required
</code></pre>

<h4>Synchronisation Automatique</h4>

<div class="success-box">
    <strong>âš¡ Auto-Sync:</strong> Le hook <code>useFuelSync()</code> Ã©coute les changements de navigation, alternates, et avion pour recalculer automatiquement:
    <ul>
        <li>Trip fuel depuis <code>navigationResults.fuelRequired</code></li>
        <li>Alternate fuel depuis <code>alternateFuelRequired</code></li>
        <li>Final reserve depuis consommation avion (30 min)</li>
    </ul>
</div>

<h3 id="module-performance">2.1.5 Module Performance (Calculs de Performances)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/performance/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Calculs dÃ©collage/atterrissage avec interpolation 2D/3D des abaques digitalisÃ©s<br>
    <strong>ğŸ“¦ Hook:</strong> <code>usePerformanceCalculations</code><br>
    <strong>ğŸ’¾ Persistance:</strong> IndexedDB (abaques aircraft)<br>
    <strong>ğŸ”¬ PrÃ©cision:</strong> Interpolation mathÃ©matique avec facteurs correctifs temps rÃ©el
</div>

<h4>Introduction aux Performances AÃ©ronautiques</h4>

<p>Le module Performance d'ALFlight calcule automatiquement les <strong>distances de dÃ©collage et d'atterrissage</strong> en fonction des conditions rÃ©elles (altitude terrain, tempÃ©rature, vent, pente de piste, masse de l'avion). Ces calculs sont <strong>critiques pour la sÃ©curitÃ©</strong> car ils dÃ©terminent si un vol peut Ãªtre effectuÃ© en toute sÃ©curitÃ©.</p>

<h4>DiffÃ©rence Fondamentale : Abaques vs Tableaux de Performances</h4>

<div class="info-box">
    <strong>ğŸ“Š ABAQUES (Nomogrammes Graphiques)</strong><br><br>
    <strong>DÃ©finition :</strong> ReprÃ©sentation graphique permettant de rÃ©soudre graphiquement des Ã©quations Ã  plusieurs variables sans calcul mathÃ©matique direct.<br><br>
    <strong>CaractÃ©ristiques :</strong>
    <ul>
        <li><strong>Format :</strong> Graphique avec axes X/Y (ex: tempÃ©rature vs distance de dÃ©collage)</li>
        <li><strong>Source :</strong> Manuels de vol officiels (MANEX, POH - Pilot Operating Handbook)</li>
        <li><strong>PrÃ©cision :</strong> Lecture manuelle avec interpolation visuelle (~5% de marge d'erreur)</li>
        <li><strong>Avantage :</strong> Vision intuitive de l'impact des paramÃ¨tres</li>
        <li><strong>InconvÃ©nient :</strong> NÃ©cessite numÃ©risation et extraction des donnÃ©es</li>
    </ul>
</div>

<p><strong>Exemple typique dans un MANEX :</strong></p>
<pre><code>Abaque DÃ©collage - DA40 NG
-----------------------------
Axe X : TempÃ©rature extÃ©rieure (Â°C)  -20 Ã  +40Â°C
Axe Y : Distance de dÃ©collage (m)    200 Ã  800m
Courbes : Une par altitude pression (0ft, 2000ft, 4000ft, 6000ft, 8000ft)
</code></pre>

<p><strong>Structure des donnÃ©es extraites d'un abaque :</strong></p>
<pre><code>{
  "chartName": "Takeoff Distance - Sea Level",
  "chartType": "takeoff",
  "pressureAltitude": 0,
  "dataPoints": [
    { "temperature": -20, "distance": 215 },
    { "temperature": -10, "distance": 240 },
    { "temperature": 0, "distance": 265 },
    { "temperature": 10, "distance": 295 },
    { "temperature": 20, "distance": 330 },
    { "temperature": 30, "distance": 370 },
    { "temperature": 40, "distance": 420 }
  ]
}
</code></pre>

<div class="success-box">
    <strong>ğŸ“ˆ TABLEAUX DE PERFORMANCES (Tables NumÃ©riques)</strong><br><br>
    <strong>DÃ©finition :</strong> Tableaux structurÃ©s avec valeurs numÃ©riques exactes organisÃ©es en lignes et colonnes.<br><br>
    <strong>CaractÃ©ristiques :</strong>
    <ul>
        <li><strong>Format :</strong> Grille de donnÃ©es (lignes = tempÃ©ratures, colonnes = altitudes)</li>
        <li><strong>Source :</strong> Manuels de vol, supplÃ©ments de performances</li>
        <li><strong>PrÃ©cision :</strong> Valeurs exactes nÃ©cessitant interpolation mathÃ©matique</li>
        <li><strong>Avantage :</strong> DonnÃ©es structurÃ©es facilement exploitables par ordinateur</li>
        <li><strong>InconvÃ©nient :</strong> Moins intuitif visuellement</li>
    </ul>
</div>

<p><strong>Exemple tableau performances :</strong></p>
<pre><code>TABLEAU DÃ‰COLLAGE DA40 NG (masses 1200-1310kg)
------------------------------------------------
Temp (Â°C) | 0 ft | 2000 ft | 4000 ft | 6000 ft
----------|------|---------|---------|--------
   -20    | 215m |   250m  |   290m  |   335m
   -10    | 240m |   280m  |   325m  |   380m
     0    | 265m |   310m  |   365m  |   430m
    10    | 295m |   350m  |   410m  |   485m
    20    | 330m |   390m  |   460m  |   545m
    30    | 370m |   440m  |   520m  |   615m
    40    | 420m |   500m  |   590m  |   700m
</code></pre>

<h4>SÃ©quence et Interaction des Calculs de Performances</h4>

<p>Le flux de calcul complet suit cette sÃ©quence en 8 Ã©tapes :</p>

<pre><code>[1] ENTRÃ‰ES UTILISATEUR
    â”œâ”€ AÃ©rodrome dÃ©part/arrivÃ©e (ICAO)
    â”œâ”€ Avion sÃ©lectionnÃ© (masse, performances)
    â””â”€ Passagers et bagages (masse et centrage)
          â†“
[2] RÃ‰CUPÃ‰RATION DONNÃ‰ES MÃ‰TÃ‰O
    â”œâ”€ METAR dÃ©part/arrivÃ©e (API CheckWX)
    â”œâ”€ Extraction tempÃ©rature OAT (Â°C)
    â”œâ”€ Extraction QNH (hPa)
    â””â”€ Extraction vent (directionÂ°, vitesse kt)
          â†“
[3] CALCUL ALTITUDE PRESSION
    â”‚   Formula: PA = Elevation + (1013 - QNH) * 27
    â”‚   OÃ¹:
    â”‚   - Elevation = altitude terrain (ft)
    â”‚   - QNH = pression atmosphÃ©rique ajustÃ©e (hPa)
    â”‚   - 27 ft/hPa = constante ISA
          â†“
[4] SÃ‰LECTION ABAQUE/TABLEAU
    â”œâ”€ Recherche abaque pour altitude pression calculÃ©e
    â”œâ”€ Si multiple abaques â†’ interpolation entre 2 abaques encadrants
    â””â”€ Si aucun abaque â†’ fallback sur formule empirique
          â†“
[5] INTERPOLATION TEMPÃ‰RATURE
    â”‚   Formula: D = D1 + (T - T1) / (T2 - T1) * (D2 - D1)
    â”‚   OÃ¹:
    â”‚   - D = distance recherchÃ©e
    â”‚   - T = tempÃ©rature actuelle (Â°C)
    â”‚   - D1, D2 = distances encadrantes dans l'abaque
    â”‚   - T1, T2 = tempÃ©ratures encadrantes
          â†“
[6] FACTEURS CORRECTIFS
    â”œâ”€ Vent effectif sur piste
    â”‚   â€¢ Vent de face : Distance Ã— (1 - WindComponent / 100)
    â”‚   â€¢ Vent arriÃ¨re : Distance Ã— (1 + WindComponent / 50)
    â”œâ”€ Pente de piste
    â”‚   â€¢ Montante : Distance Ã— (1 + Slope% / 2)
    â”‚   â€¢ Descendante : Distance Ã— (1 - Slope% / 4)
    â”œâ”€ Surface piste
    â”‚   â€¢ Herbe : Distance Ã— 1.20
    â”‚   â€¢ Gravier : Distance Ã— 1.15
    â”‚   â€¢ Asphalte/BÃ©ton : Distance Ã— 1.00
    â””â”€ Ã‰tat surface
        â€¢ MouillÃ©e : Distance Ã— 1.15
        â€¢ EnneigÃ©e : Distance Ã— 1.40
        â€¢ VerglacÃ©e : Distance Ã— 2.00
          â†“
[7] MARGES DE SÃ‰CURITÃ‰
    â”‚   Formula: Distance_Safe = Distance_CalculÃ©e Ã— 1.33
    â”‚   (Marge de 33% rÃ©glementaire)
          â†“
[8] RÃ‰SULTAT FINAL
    â”œâ”€ Distance nÃ©cessaire dÃ©collage/atterrissage (m)
    â”œâ”€ Distance disponible (TORA/LDA de la piste)
    â”œâ”€ Verdict : SAFE / WARNING / UNSAFE
    â””â”€ Alertes visuelles si piste trop courte
</code></pre>

<h4>Code Source - SÃ©quence Calcul</h4>

<p><strong>Fichier :</strong> <code>src/features/performance/PerformanceModule.jsx</code></p>

<pre><code>// Ã‰TAPE 1 : RÃ©cupÃ©ration tempÃ©rature depuis METAR
const departureTemp = useMemo(() => {
  if (!departureAirport) return null;

  // TempÃ©rature depuis METAR dÃ©codÃ©
  const metarTemp = departureWeather?.metar?.decoded?.temperature;

  // âš ï¸ CRITIQUE : Ne JAMAIS utiliser ISA comme fallback (sÃ©curitÃ©)
  if (metarTemp === undefined || metarTemp === null) {
    console.warn('âŒ Pas de tempÃ©rature METAR disponible');
    return null;
  }

  return metarTemp; // TempÃ©rature en Â°C
}, [departureAirport, departureWeather]);

// Ã‰TAPE 2 : Calcul altitude pression
const pressureAltitude = useMemo(() => {
  const elevation = departureAirport?.elevation || 0; // ft
  const qnh = departureWeather?.metar?.decoded?.pressure || 1013; // hPa

  // Formula: PA = Elevation + (1013 - QNH) * 27 ft/hPa
  return elevation + (1013 - qnh) * 27;
}, [departureAirport, departureWeather]);

// Ã‰TAPE 3 : SÃ©lection abaques pour interpolation
const selectedCharts = useMemo(() => {
  if (!aircraftPerformanceTables) return null;

  // Trouver abaques encadrant l'altitude pression
  const charts = aircraftPerformanceTables.filter(chart =>
    chart.chartType === 'takeoff'
  ).sort((a, b) => a.pressureAltitude - b.pressureAltitude);

  // Interpolation entre 2 abaques si altitude entre 2 valeurs
  const lowerChart = charts.filter(c => c.pressureAltitude <= pressureAltitude).pop();
  const upperChart = charts.find(c => c.pressureAltitude >= pressureAltitude);

  return { lowerChart, upperChart, pressureAltitude };
}, [aircraftPerformanceTables, pressureAltitude]);

// Ã‰TAPE 4 : Interpolation bilinÃ©aire tempÃ©rature + altitude
function interpolateDistance(charts, temperature, pressureAlt) {
  const { lowerChart, upperChart } = charts;

  if (!lowerChart || !upperChart) return null;

  // Interpolation linÃ©aire sur tempÃ©rature pour chaque altitude
  const distLower = interpolateTemperature(lowerChart.dataPoints, temperature);
  const distUpper = interpolateTemperature(upperChart.dataPoints, temperature);

  // Interpolation linÃ©aire entre altitudes
  const altRatio = (pressureAlt - lowerChart.pressureAltitude) /
                   (upperChart.pressureAltitude - lowerChart.pressureAltitude);

  return distLower + altRatio * (distUpper - distLower);
}

// Fonction interpolation tempÃ©rature
function interpolateTemperature(dataPoints, temperature) {
  // Trouver points encadrant la tempÃ©rature
  const sorted = dataPoints.sort((a, b) => a.temperature - b.temperature);

  let lower = sorted[0];
  let upper = sorted[sorted.length - 1];

  for (let i = 0; i < sorted.length - 1; i++) {
    if (sorted[i].temperature <= temperature && sorted[i + 1].temperature >= temperature) {
      lower = sorted[i];
      upper = sorted[i + 1];
      break;
    }
  }

  // Interpolation linÃ©aire
  const tempRatio = (temperature - lower.temperature) /
                    (upper.temperature - lower.temperature);

  return lower.distance + tempRatio * (upper.distance - lower.distance);
}

// Ã‰TAPE 5 : Application facteurs correctifs
function applyCorrectiveFactors(baseDistance, conditions) {
  let correctedDistance = baseDistance;

  // Facteur vent
  if (conditions.headwind > 0) {
    correctedDistance *= (1 - conditions.headwind / 100);
  } else if (conditions.tailwind > 0) {
    correctedDistance *= (1 + conditions.tailwind / 50);
  }

  // Facteur pente
  if (conditions.slope > 0) {
    correctedDistance *= (1 + conditions.slope / 2); // Pente montante
  } else if (conditions.slope < 0) {
    correctedDistance *= (1 - Math.abs(conditions.slope) / 4); // Pente descendante
  }

  // Facteur surface
  const surfaceFactors = {
    'asphalt': 1.00,
    'concrete': 1.00,
    'grass': 1.20,
    'gravel': 1.15
  };
  correctedDistance *= surfaceFactors[conditions.surface] || 1.00;

  // Facteur Ã©tat
  if (conditions.wet) correctedDistance *= 1.15;
  if (conditions.snow) correctedDistance *= 1.40;
  if (conditions.ice) correctedDistance *= 2.00;

  // Marge de sÃ©curitÃ© 33%
  return correctedDistance * 1.33;
}
</code></pre>

<h4>Ã‰quations MathÃ©matiques UtilisÃ©es</h4>

<div class="info-box">
    <strong>ğŸ“ Altitude Pression (Pressure Altitude)</strong><br><br>
    <code>PA = Elevation + (1013 - QNH) Ã— 27</code><br><br>
    <strong>OÃ¹ :</strong>
    <ul>
        <li><strong>PA</strong> = Pressure Altitude (ft)</li>
        <li><strong>Elevation</strong> = Altitude terrain (ft)</li>
        <li><strong>QNH</strong> = Pression atmosphÃ©rique ajustÃ©e au niveau de la mer (hPa)</li>
        <li><strong>27 ft/hPa</strong> = Gradient vertical ISA (International Standard Atmosphere)</li>
    </ul>
    <strong>Exemple :</strong><br>
    - Elevation LFST (Strasbourg) = 502 ft<br>
    - QNH actuel = 1005 hPa<br>
    - PA = 502 + (1013 - 1005) Ã— 27 = 502 + 216 = <strong>718 ft</strong>
</div>

<div class="success-box">
    <strong>ğŸ“ Interpolation LinÃ©aire Simple (1D)</strong><br><br>
    <code>y = yâ‚ + (x - xâ‚) / (xâ‚‚ - xâ‚) Ã— (yâ‚‚ - yâ‚)</code><br><br>
    <strong>OÃ¹ :</strong>
    <ul>
        <li><strong>y</strong> = Valeur recherchÃ©e</li>
        <li><strong>x</strong> = Variable d'entrÃ©e (ex: tempÃ©rature)</li>
        <li><strong>(xâ‚, yâ‚)</strong> = Point infÃ©rieur encadrant</li>
        <li><strong>(xâ‚‚, yâ‚‚)</strong> = Point supÃ©rieur encadrant</li>
    </ul>
    <strong>Exemple TempÃ©rature :</strong><br>
    - Points abaque: (-10Â°C, 240m) et (0Â°C, 265m)<br>
    - TempÃ©rature actuelle: -5Â°C<br>
    - Distance = 240 + (-5 - (-10)) / (0 - (-10)) Ã— (265 - 240)<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 240 + 5/10 Ã— 25<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= 240 + 12.5<br>
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;= <strong>252.5 m</strong>
</div>

<div class="warning-box">
    <strong>ğŸ”¬ Interpolation BilinÃ©aire (2D)</strong><br><br>
    Pour interpoler simultanÃ©ment sur 2 variables (tempÃ©rature ET altitude):<br><br>
    <code>f(x, y) = f(0,0) Ã— (1-s) Ã— (1-t) + f(1,0) Ã— s Ã— (1-t) + f(0,1) Ã— (1-s) Ã— t + f(1,1) Ã— s Ã— t</code><br><br>
    <strong>OÃ¹ :</strong>
    <ul>
        <li><strong>s</strong> = (x - xâ‚€) / (xâ‚ - xâ‚€)</li>
        <li><strong>t</strong> = (y - yâ‚€) / (yâ‚ - yâ‚€)</li>
        <li><strong>f(i,j)</strong> = Valeurs aux 4 coins de la grille</li>
    </ul>
    <strong>Exemple concret :</strong><br>
    DonnÃ©es abaques:<br>
    - 0 ft, -10Â°C â†’ 240m<br>
    - 0 ft, 0Â°C â†’ 265m<br>
    - 2000 ft, -10Â°C â†’ 280m<br>
    - 2000 ft, 0Â°C â†’ 310m<br><br>
    Calcul pour: 1000 ft, -5Â°C<br>
    - s = (-5 - (-10)) / (0 - (-10)) = 0.5<br>
    - t = (1000 - 0) / (2000 - 0) = 0.5<br>
    Distance = 240Ã—0.25 + 265Ã—0.25 + 280Ã—0.25 + 310Ã—0.25 = <strong>273.75 m</strong>
</div>

<h4>Composante de Vent Effectif sur Piste</h4>

<pre><code>Headwind = WindSpeed Ã— cos(WindAngle - RunwayHeading)
Crosswind = WindSpeed Ã— sin(WindAngle - RunwayHeading)

Facteur Correction DÃ©collage:
- Si Headwind > 0: Distance Ã— (1 - Headwind / 100)
- Si Tailwind > 0: Distance Ã— (1 + Tailwind / 50)

Exemple:
- Piste 08 (QFU 080Â°)
- Vent 120Â° / 15 kt
- Angle relatif = 120Â° - 80Â° = 40Â°
- Headwind = 15 Ã— cos(40Â°) = 15 Ã— 0.766 = 11.5 kt
- Distance de base = 300m
- Distance corrigÃ©e = 300 Ã— (1 - 11.5/100) = 300 Ã— 0.885 = 265.5 m
  (Le vent de face rÃ©duit la distance nÃ©cessaire)
</code></pre>

<h4>Correction Pente de Piste</h4>

<pre><code>Distance_Pente = Distance_Base Ã— (1 + Slope% / FacteurPente)

OÃ¹:
- FacteurPente_Montante = 2.0 (pente divisÃ©e par 2)
- FacteurPente_Descendante = 4.0 (pente divisÃ©e par 4)

Exemple pente montante 2%:
- Distance de base = 300m
- Distance corrigÃ©e = 300 Ã— (1 + 2/2) = 300 Ã— 2 = 600m
  (Pente montante DOUBLE la distance !)

Exemple pente descendante -2%:
- Distance de base = 300m
- Distance corrigÃ©e = 300 Ã— (1 - 2/4) = 300 Ã— 0.5 = 150m
  (Pente descendante rÃ©duit la distance)
</code></pre>

<h4>MÃ©thode de CrÃ©ation d'Abaques NumÃ©riques de A Ã  Z</h4>

<p><strong>Workflow Complet en 8 Ã‰tapes :</strong></p>

<pre><code>[1] ACQUISITION MANEX PDF
    â†“
[2] EXTRACTION IMAGE ABAQUE
    â”œâ”€ Outil: PDF.js (pdfjs-dist)
    â”œâ”€ Page identifiÃ©e manuellement (ex: page 35)
    â””â”€ Exportation PNG haute rÃ©solution (300 DPI)
    â†“
[3] NUMÃ‰RISATION AXES ET COURBES
    â”œâ”€ MÃ©thode manuelle: Lecture coordonnÃ©es pixels
    â”œâ”€ MÃ©thode semi-auto: DÃ©tection contours (OpenCV.js)
    â””â”€ MÃ©thode IA: OpenAI Vision API (GPT-4 Vision)
    â†“
[4] EXTRACTION POINTS DE DONNÃ‰ES
    â”œâ”€ Identification courbes (altitude 0, 2000, 4000...)
    â”œâ”€ Lecture points sur chaque courbe (tous les 10Â°C)
    â””â”€ Conversion pixels â†’ valeurs rÃ©elles
    â†“
[5] VALIDATION ET VÃ‰RIFICATION
    â”œâ”€ Comparaison avec valeurs connues du MANEX
    â”œâ”€ VÃ©rification cohÃ©rence (distances croissantes)
    â””â”€ Tests avec conditions rÃ©elles
    â†“
[6] STRUCTURATION JSON
    â”œâ”€ MÃ©tadonnÃ©es: nom, type, unitÃ©s
    â”œâ”€ Courbes: altitude pression
    â””â”€ DataPoints: tempÃ©rature â†’ distance
    â†“
[7] STOCKAGE INDEXEDDB
    â”œâ”€ Table: aircraftPerformanceTables
    â”œâ”€ Indexation: aircraftId + chartType
    â””â”€ Compression: gzip pour optimiser
    â†“
[8] UTILISATION DANS L'APP
    â””â”€ Interpolation temps rÃ©el avec conditions actuelles
</code></pre>

<h4>Exemple Pratique : NumÃ©risation Abaque DA40 NG</h4>

<p><strong>Ã‰tape 1 : Abaque Original (Papier)</strong></p>
<pre><code>TAKEOFF DISTANCE - SEA LEVEL
Diamond DA40 NG (MTOW 1310 kg)

[Graphique avec:]
- Axe X: OAT (Outside Air Temperature) de -20Â°C Ã  +40Â°C
- Axe Y: Ground Roll Distance de 200m Ã  450m
- Courbes: Pression altitude 0 ft, 2000 ft, 4000 ft
</code></pre>

<p><strong>Ã‰tape 2 : Identification CoordonnÃ©es Pixels</strong></p>
<pre><code>// Calibration axes (mesure manuelle avec outil de mesure)
const chart = {
  pixelOrigin: { x: 150, y: 850 }, // Coin bas-gauche du graphique
  pixelMaxX: 950,                   // Coin bas-droit
  pixelMaxY: 150,                   // Coin haut-gauche

  realMinX: -20,  // Â°C
  realMaxX: 40,   // Â°C
  realMinY: 200,  // m
  realMaxY: 450   // m
};

// Fonction conversion pixel â†’ valeur rÃ©elle
function pixelToReal(px, py) {
  const xRatio = (px - chart.pixelOrigin.x) / (chart.pixelMaxX - chart.pixelOrigin.x);
  const yRatio = (chart.pixelOrigin.y - py) / (chart.pixelOrigin.y - chart.pixelMaxY);

  const realX = chart.realMinX + xRatio * (chart.realMaxX - chart.realMinX);
  const realY = chart.realMinY + yRatio * (chart.realMaxY - chart.realMinY);

  return { temperature: realX, distance: realY };
}
</code></pre>

<p><strong>Ã‰tape 3 : Structure JSON Finale</strong></p>
<pre><code>{
  "id": "da40ng-takeoff-sea-level",
  "aircraftId": "f-hstr",
  "chartName": "Takeoff Distance - Sea Level",
  "chartType": "takeoff",
  "phase": "ground_roll",
  "pressureAltitude": 0,
  "units": {
    "temperature": "celsius",
    "distance": "meters"
  },
  "conditions": {
    "wind": "calm",
    "surface": "hard_paved",
    "flaps": 0,
    "weight": 1310
  },
  "dataPoints": [
    { "temperature": -20, "distance": 215 },
    { "temperature": -10, "distance": 240 },
    { "temperature": 0, "distance": 265 },
    { "temperature": 10, "distance": 295 },
    { "temperature": 20, "distance": 330 },
    { "temperature": 30, "distance": 370 },
    { "temperature": 40, "distance": 420 }
  ],
  "metadata": {
    "source": "DA40 NG Flight Manual",
    "version": "Rev. 5",
    "dateExtracted": "2024-12-15",
    "extractedBy": "manual_digitization",
    "validated": true
  }
}
</code></pre>

<h4>MÃ©thode de Classement des Abaques</h4>

<p><strong>Organisation hiÃ©rarchique :</strong></p>
<pre><code>performanceTables/
â”œâ”€â”€ takeoff/
â”‚   â”œâ”€â”€ sea_level/
â”‚   â”‚   â”œâ”€â”€ 1200kg.json
â”‚   â”‚   â”œâ”€â”€ 1250kg.json
â”‚   â”‚   â””â”€â”€ 1310kg.json (MTOW)
â”‚   â”œâ”€â”€ 2000ft/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ 4000ft/
â”‚   â””â”€â”€ 6000ft/
â”œâ”€â”€ landing/
â”‚   â”œâ”€â”€ sea_level/
â”‚   â”œâ”€â”€ 2000ft/
â”‚   â””â”€â”€ 4000ft/
â””â”€â”€ climb/
    â””â”€â”€ rate_of_climb.json
</code></pre>

<p><strong>Nomenclature fichiers :</strong></p>
<pre><code>{aircraftType}_{phase}_{altitude}_{mass}_{conditions}.json

Exemples:
- da40ng_takeoff_0ft_1310kg_flaps0.json
- da40ng_landing_2000ft_1250kg_fullflaps.json
- c172_takeoff_sl_max_gross.json
</code></pre>

<h4>Exemple Graphique d'Abaque NumÃ©risÃ©</h4>

<p><strong>ReprÃ©sentation Visuelle ASCII :</strong></p>
<pre><code>TAKEOFF DISTANCE vs OAT - DA40 NG (Sea Level)
Distance (m)
   450 |                                      *  (40Â°C)
       |                                   *
   420 |                                *
       |                             *
   390 |                          *
       |                       *
   360 |                    *
       |                 *                     Courbe: 0 ft PA
   330 |              * (20Â°C)
       |           *
   300 |        *
       |     *
   270 |  * (0Â°C)
       |*
   240 |* (-10Â°C)
       |
   215 |* (-20Â°C)
       +----+----+----+----+----+----+----+----+---- OAT (Â°C)
      -20  -10   0   10   20   30   40

LÃ‰GENDE:
* = Points de donnÃ©es extraits de l'abaque
Ligne continue = Interpolation linÃ©aire entre points
</code></pre>

<h4>Exemple Calcul Complet</h4>

<pre><code>// DonnÃ©es d'entrÃ©e
const inputs = {
  aircraft: "F-HSTR (DA40 NG)",
  departure: "LFST (Strasbourg Entzheim)",
  elevation: 502, // ft
  qnh: 1005, // hPa
  temperature: 15, // Â°C
  wind: { direction: 270, speed: 10 }, // kt
  runway: { heading: 87, length: 2400, surface: 'asphalt' },
  mass: 1285 // kg
};

// Ã‰tape 1 : Altitude pression
const PA = inputs.elevation + (1013 - inputs.qnh) * 27;
console.log(`Altitude pression: ${PA} ft`); // 718 ft

// Ã‰tape 2 : Interpolation abaque
const baseDistance = interpolateFromChart(
  PA,              // 718 ft
  inputs.temperature, // 15Â°C
  inputs.mass      // 1285 kg
);
console.log(`Distance de base (abaque): ${baseDistance} m`); // 310 m

// Ã‰tape 3 : Vent effectif
const windAngle = inputs.wind.direction - inputs.runway.heading;
const headwind = inputs.wind.speed * Math.cos(windAngle * Math.PI / 180);
console.log(`Vent effectif: ${headwind.toFixed(1)} kt`); // 0.5 kt (quasi-nul)

const windFactor = headwind > 0 ? (1 - headwind / 100) : (1 + Math.abs(headwind) / 50);
const distanceWithWind = baseDistance * windFactor;
console.log(`Distance avec vent: ${distanceWithWind.toFixed(0)} m`); // 308 m

// Ã‰tape 4 : Marge de sÃ©curitÃ© 33%
const safeDistance = distanceWithWind * 1.33;
console.log(`Distance sÃ©curisÃ©e: ${safeDistance.toFixed(0)} m`); // 410 m

// Ã‰tape 5 : Verdict
const runwayAvailable = inputs.runway.length;
const margin = runwayAvailable - safeDistance;
const verdict = margin > 0 ? 'SAFE' : 'UNSAFE';

console.log(`\n=== RÃ‰SULTAT ===`);
console.log(`Distance nÃ©cessaire: ${safeDistance.toFixed(0)} m`);
console.log(`Piste disponible: ${runwayAvailable} m`);
console.log(`Marge: ${margin.toFixed(0)} m`);
console.log(`Verdict: ${verdict} âœ…`);
</code></pre>

<p><strong>Output console :</strong></p>
<pre><code>Altitude pression: 718 ft
Distance de base (abaque): 310 m
Vent effectif: 0.5 kt
Distance avec vent: 308 m
Distance sÃ©curisÃ©e: 410 m

=== RÃ‰SULTAT ===
Distance nÃ©cessaire: 410 m
Piste disponible: 2400 m
Marge: 1990 m
Verdict: SAFE âœ…
</code></pre>

<h4>Gestion des Cas Limites et Erreurs</h4>

<table>
    <thead>
        <tr>
            <th>Cas Limite</th>
            <th>DÃ©tection</th>
            <th>Action</th>
            <th>SÃ©vÃ©ritÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Absence METAR</td>
            <td><code>temperature === null</code></td>
            <td>Bloquer calcul + demander saisie manuelle</td>
            <td>ğŸ”´ CRITIQUE</td>
        </tr>
        <tr>
            <td>Extrapolation hors limites</td>
            <td><code>temp < minTemp || temp > maxTemp</code></td>
            <td>Prolongement linÃ©aire avec warning</td>
            <td>ğŸŸ¡ WARNING</td>
        </tr>
        <tr>
            <td>Masse > MTOW</td>
            <td><code>mass > aircraft.maxTakeoffWeight</code></td>
            <td>Bloquer calcul</td>
            <td>ğŸ”´ BLOCKING</td>
        </tr>
        <tr>
            <td>Vent travers excessif</td>
            <td><code>crosswind > maxDemonstrated</code></td>
            <td>Alerte visuelle</td>
            <td>ğŸŸ¡ WARNING</td>
        </tr>
    </tbody>
</table>

<h4>Performance et Optimisations</h4>

<p><strong>Mise en cache des calculs :</strong></p>
<pre><code>import { useMemo } from 'react';

// MÃ©moÃ¯sation des calculs coÃ»teux
const performanceResults = useMemo(() => {
  return calculatePerformance(
    aircraft,
    conditions,
    performanceTables
  );
}, [aircraft.id, conditions.temperature, conditions.altitude, performanceTables]);
</code></pre>

<p><strong>PrÃ©-calcul tables de lookup :</strong></p>
<pre><code>// PrÃ©-gÃ©nÃ©rer une table de lookup pour accÃ¨s instantanÃ©
const lookupTable = useMemo(() => {
  const table = {};

  for (let temp = -20; temp <= 40; temp += 1) {
    for (let alt = 0; alt <= 8000; alt += 500) {
      const key = `${temp}_${alt}`;
      table[key] = interpolateFromChart(alt, temp, mass);
    }
  }

  return table;
}, [performanceTables, mass]);

// Utilisation O(1) au lieu de O(n) interpolation
const distance = lookupTable[`${temperature}_${altitude}`];
</code></pre>

<h4>Tests Unitaires</h4>

<pre><code>describe('Performance Calculations', () => {
  test('Interpolation tempÃ©rature simple', () => {
    const dataPoints = [
      { temperature: -10, distance: 240 },
      { temperature: 0, distance: 265 }
    ];

    const result = interpolateTemperature(dataPoints, -5);
    expect(result).toBeCloseTo(252.5, 1);
  });

  test('Calcul altitude pression', () => {
    const PA = calculatePressureAltitude(502, 1005);
    expect(PA).toBeCloseTo(718, 0);
  });

  test('Vent de face rÃ©duit distance', () => {
    const corrected = applyWindCorrection(300, 10, 'headwind');
    expect(corrected).toBeLessThan(300);
  });

  test('Pente montante augmente distance', () => {
    const corrected = applySlopeCorrection(300, 2); // 2% montÃ©e
    expect(corrected).toBeCloseTo(600, 0);
  });
});
</code></pre>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
            <th>Lignes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>PerformanceModule.jsx</code></td>
            <td>Interface calculs TO/LDG</td>
            <td>~600</td>
        </tr>
        <tr>
            <td>Calculateur Tables</td>
            <td><code>PerformanceTableCalculator.jsx</code></td>
            <td>Interpolation abaques + rÃ©sultats</td>
            <td>~800</td>
        </tr>
        <tr>
            <td>Suggestion Piste</td>
            <td><code>RunwaySuggestionEnhanced.jsx</code></td>
            <td>Analyse QFU optimal selon vent</td>
            <td>~400</td>
        </tr>
        <tr>
            <td>Hook Calculs</td>
            <td><code>usePerformanceCalculations.js</code></td>
            <td>ISA, densitÃ© altitude, corrections</td>
            <td>~300</td>
        </tr>
    </tbody>
</table>

<div class="warning-box">
    <strong>âš ï¸ Limitations Actuelles :</strong>
    <ul>
        <li>Abaques doivent Ãªtre digitalisÃ©s au prÃ©alable (via Aircraft Wizard Step 4)</li>
        <li>Interpolation limitÃ©e aux plages dÃ©finies dans les abaques</li>
        <li>Corrections manuelles nÃ©cessaires pour conditions spÃ©ciales (piste mouillÃ©e, neige, pente)</li>
        <li>Pas de support automatique pour surfaces contaminÃ©es (slush, standing water)</li>
    </ul>
</div>

<h3 id="module-weight-balance">2.1.6 Module Weight-Balance (Masse et Centrage)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/weight-balance/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Calcul masse, moments, CG avec 3 scÃ©narios (dÃ©part, arrivÃ©e, atterrissage) et enveloppe graphique<br>
    <strong>ğŸ“¦ Store:</strong> <code>weightBalanceStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (loads)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>WeightBalanceModule.jsx</code></td>
            <td>Interface chargement + rÃ©sultats</td>
        </tr>
        <tr>
            <td>LoadInput</td>
            <td><code>LoadInput.jsx</code></td>
            <td>Input poids avec bras de levier</td>
        </tr>
        <tr>
            <td>ScenarioCards</td>
            <td><code>ScenarioCards.jsx</code></td>
            <td>Affichage 3 scÃ©narios</td>
        </tr>
        <tr>
            <td>Chart</td>
            <td><code>WeightBalanceChart.jsx</code></td>
            <td>Graphique enveloppe CG</td>
        </tr>
        <tr>
            <td>Calculations</td>
            <td><code>calculations.js</code></td>
            <td>Calculs CG + scÃ©narios</td>
        </tr>
    </tbody>
</table>

<h4>Postes de Chargement</h4>

<table>
    <thead>
        <tr>
            <th>Poste</th>
            <th>Bras (m)</th>
            <th>Limite</th>
            <th>Notes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ğŸ‘¨â€âœˆï¸ SiÃ¨ge avant gauche</td>
            <td>Configurable</td>
            <td>Aucune</td>
            <td>Pilote obligatoire</td>
        </tr>
        <tr>
            <td>ğŸ§‘â€ğŸ¤â€ğŸ§‘ SiÃ¨ge avant droit</td>
            <td>Configurable</td>
            <td>Aucune</td>
            <td>Optionnel</td>
        </tr>
        <tr>
            <td>ğŸ‘¥ SiÃ¨ges arriÃ¨re (Ã—2)</td>
            <td>Configurable</td>
            <td>Selon avion</td>
            <td>Optionnels</td>
        </tr>
        <tr>
            <td>ğŸ’ Bagages (compartiments)</td>
            <td>Variable</td>
            <td>Max par compartiment</td>
            <td>Dynamique selon avion</td>
        </tr>
        <tr>
            <td>â›½ Carburant</td>
            <td>Configurable</td>
            <td>CapacitÃ© rÃ©servoir</td>
            <td>Automatique depuis FOB</td>
        </tr>
    </tbody>
</table>

<h4>Calcul du Centre de GravitÃ©</h4>

<pre><code>// Pour chaque poste i
moment_i = mass_i Ã— arm_i

// Total
total_mass = empty_mass + Î£(loads)
total_moment = empty_moment + Î£(moments)

// Position CG (en mÃ¨tres depuis datum)
CG = total_moment / total_mass

// VÃ©rification limites
forward_limit = aircraft.cgLimits.forward  // ex: 2.00m
aft_limit = aircraft.cgLimits.aft          // ex: 2.45m

if (CG < forward_limit) â†’ âŒ CG trop avant
if (CG > aft_limit) â†’ âŒ CG trop arriÃ¨re
else â†’ âœ… CG dans l'enveloppe
</code></pre>

<h4>Les 3 ScÃ©narios CalculÃ©s</h4>

<div class="info-box">
    <strong>ScÃ©nario 1 - Ramp (Parking):</strong><br>
    Masse totale au roulage = Empty + Occupants + Bagages + FOB<br>
    <code>CG doit Ãªtre dans enveloppe Ã  cette masse</code>
</div>

<div class="info-box">
    <strong>ScÃ©nario 2 - Takeoff (DÃ©collage):</strong><br>
    AprÃ¨s roulage = Ramp - taxi fuel<br>
    <code>CG dÃ©cale lÃ©gÃ¨rement (carburant consommÃ©)</code>
</div>

<div class="info-box">
    <strong>ScÃ©nario 3 - Landing (Atterrissage):</strong><br>
    AprÃ¨s vol = Takeoff - trip fuel - alternate fuel - reserve utilisÃ©e<br>
    <code>CG dÃ©cale significativement vers l'avant (si rÃ©servoir arriÃ¨re)</code>
</div>

<div class="warning-box">
    <strong>âš ï¸ Point Critique:</strong> Un avion peut Ãªtre dans l'enveloppe au dÃ©collage mais <strong>SORTIR de l'enveloppe Ã  l'atterrissage</strong> Ã  cause de la consommation de carburant. Le module vÃ©rifie automatiquement les 3 scÃ©narios.
</div>

<h4>Graphique Enveloppe</h4>

<p>Le composant <code>WeightBalanceChart</code> affiche:</p>
<ul>
    <li><strong>Enveloppe CG:</strong> Polygone vert dÃ©finissant limites forward/aft selon masse</li>
    <li><strong>3 points scÃ©narios:</strong> Ramp (bleu), Takeoff (orange), Landing (vert)</li>
    <li><strong>Ligne de consommation:</strong> Trajectoire du CG pendant le vol</li>
    <li><strong>Limites MTOW:</strong> Ligne horizontale rouge si dÃ©passement</li>
</ul>

<h4>Compartiments Bagages Dynamiques</h4>

<p>Le systÃ¨me supporte des compartiments bagages configurables:</p>

<pre><code>aircraft.baggageCompartments = [
  { id: 'main', name: 'Bagages principaux', maxWeight: 40, arm: 3.50 },
  { id: 'aux', name: 'Bagages auxiliaires', maxWeight: 20, arm: 3.70 },
  { id: 'tube', name: 'Tube bagages', maxWeight: 10, arm: 4.00 }
];

// Les inputs sont gÃ©nÃ©rÃ©s dynamiquement
baggageCompartments.map(comp => (
  <LoadInput
    label={comp.name}
    maxWeight={comp.maxWeight}
    arm={comp.arm}
  />
))
</code></pre>

<h4>Synchronisation Automatique Carburant</h4>

<div class="success-box">
    <strong>âš¡ Auto-Sync:</strong> Le module Ã©coute <code>fobFuel</code> et recalcule automatiquement les 3 scÃ©narios Ã  chaque changement de carburant, de chargement, ou de trajet.
</div>

<h3 id="module-weather">2.1.7 Module Weather (MÃ©tÃ©o AÃ©ronautique)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/weather/</code><br>
    <strong>ğŸ¯ Fonction:</strong> RÃ©cupÃ©ration METAR/TAF temps rÃ©el via AVWX API avec dÃ©codage automatique et cache intelligent<br>
    <strong>ğŸ“¦ Store:</strong> <code>weatherStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (weatherData avec timestamps)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>WeatherModule.jsx</code></td>
            <td>Interface recherche + affichage METAR/TAF</td>
        </tr>
        <tr>
            <td>WeatherCard</td>
            <td><code>WeatherCard.jsx</code></td>
            <td>Affichage dÃ©taillÃ© d'une mÃ©tÃ©o</td>
        </tr>
        <tr>
            <td>Weather Service</td>
            <td><code>weatherService.js</code></td>
            <td>Appels API AVWX + parsing</td>
        </tr>
        <tr>
            <td>Rate Limit Indicator</td>
            <td><code>WeatherRateLimitIndicator.jsx</code></td>
            <td>Affichage quota API restant</td>
        </tr>
    </tbody>
</table>

<h4>API AVWX - ParamÃ¨tres</h4>

<pre><code>Service: https://avwx.rest/api/
Rate Limit: 100 requÃªtes/jour (plan gratuit)
Format rÃ©ponse: JSON avec METAR/TAF dÃ©codÃ©s

Endpoints utilisÃ©s:
- GET /metar/{icao}?options=info,translate
- GET /taf/{icao}?options=info,translate

RÃ©ponse dÃ©codÃ©e inclut:
- QNH (hPa)
- TempÃ©rature (Â°C)
- Point de rosÃ©e (Â°C)
- Vent: direction (Â°), vitesse (kt), rafales (kt)
- VisibilitÃ© (m)
- Plafond (ft)
- PhÃ©nomÃ¨nes mÃ©tÃ©o (RA, SN, FG, etc.)
- Traduction texte franÃ§ais
</code></pre>

<h4>Cache et FraÃ®cheur des DonnÃ©es</h4>

<p>Le systÃ¨me implÃ©mente un cache intelligent pour Ã©conomiser les appels API:</p>

<pre><code>// DurÃ©e validitÃ© METAR
METAR_VALIDITY = 30 minutes

// VÃ©rification fraÃ®cheur
const isStale = (timestamp) => {
  return (Date.now() - timestamp) > (30 * 60 * 1000);
};

// Logique de fetch
if (!weatherData[icao] || isStale(weatherData[icao].timestamp)) {
  // âœ… RÃ©cupÃ©rer depuis API
  await fetchWeather(icao);
} else {
  // âœ… Utiliser cache
  console.log('Using cached weather');
}
</code></pre>

<h4>Chargement Automatique</h4>

<p>Le module charge automatiquement la mÃ©tÃ©o pour:</p>

<ul>
    <li><strong>Waypoints de la route:</strong> Tous les ICAOs dans <code>waypoints[]</code></li>
    <li><strong>Alternates sÃ©lectionnÃ©s:</strong> ICAOs des dÃ©routements</li>
    <li><strong>AÃ©rodromes Performance:</strong> DÃ©part/arrivÃ©e pour calculs TO/LDG</li>
</ul>

<pre><code>// Hook dans WeatherModule
useEffect(() => {
  const waypointIcaos = waypoints
    .map(wp => wp.name)
    .filter(name => name && name.match(/^[A-Z]{4}$/));

  if (waypointIcaos.length > 0) {
    fetchMultiple(waypointIcaos); // Appels parallÃ¨les
  }
}, [waypoints, fetchMultiple]);
</code></pre>

<h4>DÃ©codage METAR/TAF</h4>

<table>
    <thead>
        <tr>
            <th>Ã‰lÃ©ment</th>
            <th>Code METAR</th>
            <th>DÃ©codage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>QNH</td>
            <td>Q1013</td>
            <td>1013 hPa</td>
        </tr>
        <tr>
            <td>TempÃ©rature</td>
            <td>28/18</td>
            <td>28Â°C / 18Â°C dew point</td>
        </tr>
        <tr>
            <td>Vent</td>
            <td>27015G25KT</td>
            <td>270Â° Ã  15 kt, rafales 25 kt</td>
        </tr>
        <tr>
            <td>VisibilitÃ©</td>
            <td>9999</td>
            <td>> 10 km</td>
        </tr>
        <tr>
            <td>Nuages</td>
            <td>SCT025 BKN040</td>
            <td>Ã‰pars 2500ft, FragmentÃ© 4000ft</td>
        </tr>
        <tr>
            <td>PhÃ©nomÃ¨nes</td>
            <td>-RA BR</td>
            <td>Pluie faible, brume</td>
        </tr>
    </tbody>
</table>

<h4>Suggestions AÃ©rodromes</h4>

<p>Le module inclut un systÃ¨me d'autocomplÃ©tion:</p>

<pre><code>// Recherche dans AIXM local
const airports = await aeroDataProvider.getAirfields({ country: 'FR' });

// Filtrage par ICAO ou nom
const filtered = airports
  .filter(apt =>
    apt.icao.toUpperCase().includes(searchTerm) ||
    apt.name.toUpperCase().includes(searchTerm)
  )
  .slice(0, 10); // Max 10 suggestions

// Affichage dropdown
<Suggestion>
  {apt.icao} - {apt.name} ({apt.type})
</Suggestion>
</code></pre>

<h4>Indicateur Rate Limit</h4>

<p>Le composant <code>WeatherRateLimitIndicator</code> affiche:</p>

<ul>
    <li><strong>RequÃªtes restantes:</strong> 100 - utilisÃ©es aujourd'hui</li>
    <li><strong>Barre de progression:</strong> Visuelle du quota</li>
    <li><strong>Couleur:</strong> Vert (>50), Orange (20-50), Rouge (<20)</li>
    <li><strong>Reset:</strong> Compteur remis Ã  zÃ©ro Ã  minuit UTC</li>
</ul>

<div class="warning-box">
    <strong>âš ï¸ Limitation API:</strong> Le plan gratuit AVWX limite Ã  100 requÃªtes/jour. Le cache intelligent permet de minimiser les appels en rÃ©utilisant les METARs rÃ©cents (<30 min).
</div>

<h3 id="module-vac">2.1.8 Module VAC (Visual Approach Charts)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/vac/</code><br>
    <strong>ğŸ¯ Fonction:</strong> TÃ©lÃ©chargement automatique des cartes VAC officielles SIA France avec enrichissement points VFR<br>
    <strong>ğŸ“¦ Store:</strong> <code>vacStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> IndexedDB (VAC PDFs + mÃ©tadonnÃ©es)
</div>

<h4>Composants Principaux</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Fichier</th>
            <th>RÃ´le</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Module Principal</td>
            <td><code>VACModule.jsx</code></td>
            <td>Interface liste VAC + viewer</td>
        </tr>
        <tr>
            <td>SIA Report Enhanced</td>
            <td><code>SIAReportEnhanced.jsx</code></td>
            <td>Rapport complet avec VAC enrichies</td>
        </tr>
        <tr>
            <td>VAC Enricher</td>
            <td><code>vacEnricher.js</code></td>
            <td>Ajout points VFR sur cartes</td>
        </tr>
        <tr>
            <td>VAC Service</td>
            <td><code>vacService.js</code></td>
            <td>TÃ©lÃ©chargement SIA + cache</td>
        </tr>
    </tbody>
</table>

<h4>Sources de DonnÃ©es VAC</h4>

<table>
    <thead>
        <tr>
            <th>Source</th>
            <th>Type</th>
            <th>Format</th>
            <th>Utilisation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>SIA France officiel</td>
            <td>Cartes VAC</td>
            <td>PDF multi-pages</td>
            <td>TÃ©lÃ©chargement automatique</td>
        </tr>
        <tr>
            <td>AIXM 4.5 XML</td>
            <td>Points VFR</td>
            <td>Coordinates + noms</td>
            <td>Enrichissement cartes</td>
        </tr>
        <tr>
            <td>Supabase Storage</td>
            <td>Photos points VFR</td>
            <td>JPEG/PNG</td>
            <td>Affichage communautaire</td>
        </tr>
    </tbody>
</table>

<h4>TÃ©lÃ©chargement Automatique VAC</h4>

<pre><code>// URL SIA France (officiel)
const SIA_BASE_URL = 'https://www.sia.aviation-civile.gouv.fr/';

// Pattern URL VAC
const vacUrl = `${SIA_BASE_URL}/dvd/eAIP_${cycle}/Atlas-VAC/PDF_AIPparSSection/VAC/AD/AD-2.${icao}.pdf`;

// TÃ©lÃ©chargement
const response = await fetch(vacUrl);
const pdfBlob = await response.blob();

// Stockage IndexedDB
await vacStore.saveVAC({
  icao,
  pdfData: await pdfBlob.arrayBuffer(),
  downloadDate: Date.now(),
  cycle: '2025-11-27' // AIRAC
});
</code></pre>

<h4>Enrichissement Points VFR</h4>

<p>Le service <code>vacEnricher</code> ajoute les points VFR sur les cartes:</p>

<pre><code>// 1. Charger PDF VAC
const pdf = await pdfjsLib.getDocument(pdfData).promise;

// 2. Pour chaque page
for (let i = 1; i <= pdf.numPages; i++) {
  const page = await pdf.getPage(i);
  const canvas = document.createElement('canvas');

  // 3. Rendre PDF sur canvas
  await page.render({ canvasContext, viewport }).promise;

  // 4. Trouver points VFR visibles
  const visiblePoints = vfrPoints.filter(pt =>
    isPointInView(pt.coordinates, pageViewport)
  );

  // 5. Dessiner markers
  visiblePoints.forEach(pt => {
    const { x, y } = latLonToPageCoords(pt.coordinates, viewport);

    // Marker rouge
    ctx.fillStyle = '#FF0000';
    ctx.beginPath();
    ctx.arc(x, y, 5, 0, 2 * Math.PI);
    ctx.fill();

    // Label
    ctx.fillText(pt.name, x + 10, y);
  });

  // 6. Convertir en blob enrichi
  const enrichedBlob = await canvas.toBlob();
}
</code></pre>

<h4>Rapport SIA Complet</h4>

<p>Le composant <code>SIAReportEnhanced</code> gÃ©nÃ¨re un rapport multi-aÃ©rodromes:</p>

<ul>
    <li><strong>SÃ©lection aÃ©rodromes:</strong> DÃ©part, arrivÃ©e, alternates</li>
    <li><strong>Pour chaque aÃ©rodrome:</strong>
        <ul>
            <li>Infos gÃ©nÃ©rales (ICAO, nom, Ã©lÃ©vation, coordonnÃ©es)</li>
            <li>Pistes (QFU, dimensions, surfaces)</li>
            <li>FrÃ©quences (TWR, APP, GND, ATIS)</li>
            <li>Points VFR Ã  proximitÃ© (<20 NM)</li>
            <li>Cartes VAC enrichies (toutes les pages)</li>
            <li>METAR/TAF actuels</li>
        </ul>
    </li>
    <li><strong>Export PDF:</strong> GÃ©nÃ©ration dossier complet imprimable</li>
</ul>

<h4>Gestion Cache VAC</h4>

<pre><code>// Stockage IndexedDB
vacStorage = {
  charts: {
    'LFST': {
      icao: 'LFST',
      name: 'Strasbourg Entzheim',
      pdfData: ArrayBuffer,
      downloadDate: 1732089600000,
      cycle: '2025-11-27',
      isEnriched: true,
      enrichedPages: [Blob, Blob, ...],
      vfrPoints: [
        { name: 'STS', lat: 48.5444, lon: 7.6280, photo: 'url' },
        ...
      ]
    }
  }
};

// VÃ©rification validitÃ©
const isValid = (chart) => {
  const age = Date.now() - chart.downloadDate;
  const MAX_AGE = 56 * 24 * 60 * 60 * 1000; // 56 jours (2 cycles AIRAC)
  return age < MAX_AGE;
};
</code></pre>

<h4>Points VFR Communautaires</h4>

<p>Le systÃ¨me supporte l'ajout de photos pour les points VFR:</p>

<pre><code>// Upload photo vers Supabase Storage
const uploadPhoto = async (file, pointId) => {
  const filePath = `vfr-points/${pointId}/${Date.now()}_${file.name}`;

  const { data, error } = await supabase.storage
    .from('vfr-points-photos')
    .upload(filePath, file);

  // RÃ©cupÃ©rer URL publique
  const { data: { publicUrl } } = supabase.storage
    .from('vfr-points-photos')
    .getPublicUrl(filePath);

  // Mettre Ã  jour base de donnÃ©es
  await supabase.from('vfr_points')
    .update({ photo_url: publicUrl })
    .eq('id', pointId);
};
</code></pre>

<div class="success-box">
    <strong>âœ¨ Point Fort:</strong> Les cartes VAC sont automatiquement tÃ©lÃ©chargÃ©es pour tous les aÃ©rodromes de la route et enrichies avec les points VFR officiels + photos communautaires. Le cache intelligent Ã©vite les retÃ©lÃ©chargements.
</div>

<h3 id="module-flight-wizard">2.1.9 Module Flight Wizard (Assistant PrÃ©paration Vol)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/flight-wizard/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Assistant complet de prÃ©paration de vol en 7 Ã©tapes avec gÃ©nÃ©ration PDF rÃ©glementaire<br>
    <strong>ğŸ“¦ Store:</strong> <code>flightPlanStore</code> + localStorage (draft)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (brouillon) + Supabase (plans validÃ©s)
</div>

<h4>Les 7 Ã‰tapes du Wizard</h4>

<table>
    <thead>
        <tr>
            <th>#</th>
            <th>Titre</th>
            <th>Composant</th>
            <th>DonnÃ©es CollectÃ©es</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>Informations GÃ©nÃ©rales</td>
            <td><code>Step1GeneralInfo.jsx</code></td>
            <td>SÃ©lection avion, callsign, date/heure, type vol</td>
        </tr>
        <tr>
            <td>2</td>
            <td>DÃ©finition Trajet</td>
            <td><code>Step3Route.jsx</code></td>
            <td>Route complÃ¨te, altitudes, TOD, alternates</td>
        </tr>
        <tr>
            <td>3</td>
            <td>AÃ©rodromes & MÃ©tÃ©o</td>
            <td><code>Step3VAC.jsx</code></td>
            <td>VAC enrichies, METAR/TAF, frÃ©quences</td>
        </tr>
        <tr>
            <td>4</td>
            <td>Bilan Carburant</td>
            <td><code>Step5Fuel.jsx</code></td>
            <td>FOB, 7 postes carburant, validation minimas</td>
        </tr>
        <tr>
            <td>5</td>
            <td>Masse et Centrage</td>
            <td><code>Step6WeightBalance.jsx</code></td>
            <td>Chargement, 3 scÃ©narios CG, enveloppe</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Performances</td>
            <td><code>Step5Performance.jsx</code></td>
            <td>TO/LDG distances, pistes recommandÃ©es</td>
        </tr>
        <tr>
            <td>7</td>
            <td>SynthÃ¨se</td>
            <td><code>Step7Summary.jsx</code></td>
            <td>RÃ©capitulatif complet + gÃ©nÃ©ration PDF</td>
        </tr>
    </tbody>
</table>

<h4>ModÃ¨le de DonnÃ©es FlightPlanData</h4>

<pre><code>class FlightPlanData {
  constructor() {
    this.generalInfo = {
      callsign: '',
      flightDate: null,
      departureTime: null,
      flightType: 'VFR',
      dayNight: 'day'
    };

    this.aircraft = null; // RÃ©fÃ©rence avion complet

    this.route = {
      waypoints: [],
      segmentAltitudes: {},
      plannedAltitude: 0,
      todCalculation: {}
    };

    this.alternates = {
      departure: null,
      arrival: null,
      selectedAlternates: []
    };

    this.weather = {
      departure: {},
      arrival: {},
      alternates: {}
    };

    this.fuel = {
      fob: { ltr: 0, gal: 0 },
      breakdown: {
        roulage: {},
        trip: {},
        contingency: {},
        alternate: {},
        finalReserve: {},
        additional: {},
        extra: {}
      },
      confirmed: false
    };

    this.weightBalance = {
      loads: {},
      scenarios: {},
      confirmed: false
    };

    this.performance = {
      takeoff: {},
      landing: {},
      confirmed: false
    };

    this.navigation = {
      results: null,
      legs: []
    };
  }

  // SÃ©rialisation JSON
  toJSON() { ... }
  static fromJSON(json) { ... }
}
</code></pre>

<h4>Persistance Brouillon</h4>

<p>Le wizard sauvegarde automatiquement la progression:</p>

<pre><code>// Sauvegarde automatique aprÃ¨s chaque step
useEffect(() => {
  const draftKey = 'flightPlanDraft';

  // Sauvegarder toutes les 2 secondes (debounced)
  const saveDraft = debounce(() => {
    const draft = {
      flightPlan: flightPlan.toJSON(),
      currentStep: activeStep,
      timestamp: Date.now()
    };

    localStorage.setItem(draftKey, JSON.stringify(draft));
  }, 2000);

  saveDraft();
}, [flightPlan, activeStep]);

// Restauration au chargement
useEffect(() => {
  const draft = localStorage.getItem('flightPlanDraft');

  if (draft) {
    const { flightPlan: savedData, currentStep } = JSON.parse(draft);

    // Restaurer Ã©tat
    setFlightPlan(FlightPlanData.fromJSON(savedData));
    setActiveStep(currentStep);

    // Restaurer contextes
    restoreAircraft(savedData.aircraft);
    restoreRoute(savedData.route);
    restoreFuel(savedData.fuel);
    // ...
  }
}, []);
</code></pre>

<h4>Validation Inter-Ã‰tapes</h4>

<p>Chaque Ã©tape valide les donnÃ©es avant de continuer:</p>

<table>
    <thead>
        <tr>
            <th>Ã‰tape</th>
            <th>Validations</th>
            <th>Blocage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1 - GÃ©nÃ©ral</td>
            <td>Avion sÃ©lectionnÃ©, callsign renseignÃ©</td>
            <td>âŒ Si manquants</td>
        </tr>
        <tr>
            <td>2 - Route</td>
            <td>Min 2 waypoints, dÃ©part â‰  arrivÃ©e</td>
            <td>âŒ Si invalide</td>
        </tr>
        <tr>
            <td>3 - VAC</td>
            <td>Aucune (optionnel)</td>
            <td>âœ… Passage libre</td>
        </tr>
        <tr>
            <td>4 - Fuel</td>
            <td>FOB >= required, final reserve >= 30 min</td>
            <td>âš ï¸ Warning mais passage</td>
        </tr>
        <tr>
            <td>5 - W&B</td>
            <td>CG dans enveloppe (3 scÃ©narios), masse < MTOW</td>
            <td>âŒ Si hors limites</td>
        </tr>
        <tr>
            <td>6 - Perf</td>
            <td>Piste suffisante TO/LDG, vent acceptable</td>
            <td>âš ï¸ Warning si critique</td>
        </tr>
        <tr>
            <td>7 - Summary</td>
            <td>Toutes Ã©tapes validÃ©es</td>
            <td>âœ… GÃ©nÃ©ration PDF</td>
        </tr>
    </tbody>
</table>

<h4>GÃ©nÃ©ration PDF Final</h4>

<p>L'Ã©tape 7 gÃ©nÃ¨re un PDF complet avec <code>html2pdf.js</code>:</p>

<pre><code>const generatePDF = async () => {
  // 1. CrÃ©er Ã©lÃ©ment HTML avec toutes les donnÃ©es
  const element = document.createElement('div');
  element.innerHTML = `
    <div style="font-family: Arial; padding: 20px;">
      <!-- En-tÃªte -->
      <h1>Plan de Vol - ${flightPlan.generalInfo.callsign}</h1>
      <p>${new Date(flightPlan.generalInfo.flightDate).toLocaleDateString('fr-FR')}</p>

      <!-- RÃ©capitulatif route -->
      <h2>Trajet</h2>
      <table>
        ${flightPlan.route.waypoints.map(wp => `
          <tr>
            <td>${wp.name}</td>
            <td>${wp.distance} NM</td>
            <td>${wp.time} min</td>
          </tr>
        `).join('')}
      </table>

      <!-- Carburant -->
      <h2>Carburant</h2>
      ...

      <!-- Masse et centrage -->
      <h2>Masse et Centrage</h2>
      ...

      <!-- Performances -->
      <h2>Performances</h2>
      ...

      <!-- VAC + METAR -->
      <h2>Cartes et MÃ©tÃ©o</h2>
      ...
    </div>
  `;

  // 2. GÃ©nÃ©rer PDF
  const pdfBlob = await html2pdf()
    .from(element)
    .set({
      margin: 10,
      filename: `${callsign}_${date}.pdf`,
      html2canvas: { scale: 2 },
      jsPDF: { orientation: 'portrait', unit: 'mm', format: 'a4' }
    })
    .outputPdf('blob');

  // 3. Upload vers Supabase Storage
  await validatedPdfService.uploadValidatedPdf(pdfBlob, {
    callsign,
    flightDate,
    departure: waypoints[0].icao,
    arrival: waypoints[waypoints.length-1].icao
  });

  // 4. Sauvegarder plan de vol dans DB
  await flightPlanSupabaseService.saveFlightPlan(flightPlan.toJSON());

  // 5. Nettoyer brouillon
  localStorage.removeItem('flightPlanDraft');
};
</code></pre>

<div class="success-box">
    <strong>âœ¨ Point Fort:</strong> Le Flight Wizard guide l'utilisateur Ã  travers toutes les Ã©tapes rÃ©glementaires et gÃ©nÃ¨re un dossier de vol complet, conforme, prÃªt Ã  imprimer. La sauvegarde automatique permet de reprendre Ã  tout moment.
</div>

<h2 id="modules-support">2.2 Modules de Support (Gestion et Suivi)</h2>

<p>Les modules de support d'ALFlight permettent au pilote de gÃ©rer l'ensemble de son activitÃ© aÃ©ronautique : profil personnel, licences, carnet de vol, checklists, documentation rÃ©glementaire, et suivi technique des avions. Ces modules sont conÃ§us pour une utilisation quotidienne et un archivage rÃ©glementaire.</p>

<h3 id="module-pilot">2.2.1 Module Pilot (Profil Pilote et Licences)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/pilot/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Gestion profil pilote avec licences, qualifications, expÃ©rience, et historique vols<br>
    <strong>ğŸ“¦ Store:</strong> <code>pilotStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> Supabase (pilot_profiles) + localStorage backup<br>
    <strong>ğŸ“„ Fichiers clÃ©s:</strong> <code>PilotModule.jsx</code> (800 lignes), <code>PilotInfo.jsx</code>, <code>LicenseManager.jsx</code>
</div>

<h4>Informations Personnelles</h4>

<table>
    <thead>
        <tr>
            <th>Champ</th>
            <th>Type</th>
            <th>Validation</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Nom / PrÃ©nom</td>
            <td>Text</td>
            <td>Required, 2-50 caractÃ¨res</td>
            <td>Identification, export PDF credentials</td>
        </tr>
        <tr>
            <td>Date de naissance</td>
            <td>Date</td>
            <td>Required, > 16 ans (LAPL), > 17 ans (PPL)</td>
            <td>Calcul Ã¢ge pour renouvellements mÃ©dicaux</td>
        </tr>
        <tr>
            <td>Adresse</td>
            <td>Text</td>
            <td>Optional</td>
            <td>Contact, assurance</td>
        </tr>
        <tr>
            <td>Email</td>
            <td>Email</td>
            <td>Required, format email valide</td>
            <td>Authentification Supabase, notifications</td>
        </tr>
        <tr>
            <td>TÃ©lÃ©phone</td>
            <td>Tel</td>
            <td>Optional, format international +33...</td>
            <td>Contact urgence, assurance</td>
        </tr>
        <tr>
            <td>Photo profil</td>
            <td>Image</td>
            <td>Optional, max 2 MB, jpg/png</td>
            <td>Supabase Storage bucket 'avatars'</td>
        </tr>
    </tbody>
</table>

<h4>Licences et Qualifications</h4>

<p><strong>Types de licences supportÃ©s :</strong></p>

<table>
    <thead>
        <tr>
            <th>Licence</th>
            <th>Acronyme</th>
            <th>Champs SpÃ©cifiques</th>
            <th>ValiditÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Light Aircraft Pilot Licence</td>
            <td>LAPL</td>
            <td>NumÃ©ro, date obtention, autoritÃ© (EASA)</td>
            <td>Permanente (sauf mÃ©dical)</td>
        </tr>
        <tr>
            <td>Private Pilot Licence</td>
            <td>PPL</td>
            <td>NumÃ©ro, date obtention, autoritÃ© (EASA/DGAC)</td>
            <td>Permanente (sauf mÃ©dical)</td>
        </tr>
        <tr>
            <td>Commercial Pilot Licence</td>
            <td>CPL</td>
            <td>NumÃ©ro, date obtention, autoritÃ©</td>
            <td>Permanente (sauf mÃ©dical + SEP revalidation)</td>
        </tr>
        <tr>
            <td>Instrument Rating</td>
            <td>IR</td>
            <td>NumÃ©ro, date obtention, type (SE/ME)</td>
            <td>Revalidation annuelle</td>
        </tr>
        <tr>
            <td>Airline Transport Pilot Licence</td>
            <td>ATPL</td>
            <td>NumÃ©ro, date obtention, type rating</td>
            <td>Permanente (revalidation 6 mois)</td>
        </tr>
    </tbody>
</table>

<p><strong>Qualifications de classe/type :</strong></p>

<table>
    <thead>
        <tr>
            <th>Qualification</th>
            <th>Description</th>
            <th>Revalidation</th>
            <th>Conditions</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>SEP (Single-Engine Piston)</td>
            <td>Avions monomoteurs Ã  pistons</td>
            <td>24 mois</td>
            <td>12h vol dont 6h PIC + 1h instruction + 12 TO/LDG</td>
        </tr>
        <tr>
            <td>MEP (Multi-Engine Piston)</td>
            <td>Avions multimoteurs Ã  pistons</td>
            <td>12 mois</td>
            <td>10h vol dont 6h PIC + contrÃ´le compÃ©tence</td>
        </tr>
        <tr>
            <td>Night Rating</td>
            <td>Vol de nuit</td>
            <td>Permanente</td>
            <td>Formation initiale 5h nuit + 5 atterrissages</td>
        </tr>
        <tr>
            <td>Aerobatics</td>
            <td>Voltige aÃ©rienne</td>
            <td>24 mois</td>
            <td>Formation + contrÃ´le compÃ©tence</td>
        </tr>
        <tr>
            <td>Mountain Rating</td>
            <td>Vol montagne</td>
            <td>24 mois</td>
            <td>Formation spÃ©cifique + 3 atterrissages montagne</td>
        </tr>
    </tbody>
</table>

<h4>Visite MÃ©dicale (Medical Certificate)</h4>

<table>
    <thead>
        <tr>
            <th>Classe</th>
            <th>Usage</th>
            <th>ValiditÃ© < 40 ans</th>
            <th>ValiditÃ© 40-50 ans</th>
            <th>ValiditÃ© > 50 ans</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Classe 1</td>
            <td>Pilote professionnel (CPL, ATPL)</td>
            <td>12 mois</td>
            <td>12 mois</td>
            <td>6 mois</td>
        </tr>
        <tr>
            <td>Classe 2</td>
            <td>Pilote privÃ© (PPL)</td>
            <td>60 mois (5 ans)</td>
            <td>24 mois (2 ans)</td>
            <td>12 mois (1 an)</td>
        </tr>
        <tr>
            <td>LAPL Medical</td>
            <td>LAPL uniquement</td>
            <td>60 mois</td>
            <td>24 mois</td>
            <td>12 mois</td>
        </tr>
    </tbody>
</table>

<h4>Alertes et Notifications Automatiques</h4>

<p>Le module envoie des alertes (email + notification in-app) pour :</p>

<pre><code>// Calcul expiration mÃ©dicale
function checkMedicalValidity(pilot) {
  const medicalClass = pilot.medicalClass; // 1, 2, LAPL
  const age = calculateAge(pilot.birthDate);
  const medicalIssueDate = pilot.medicalIssueDate;

  let validityMonths;
  if (medicalClass === 1) {
    validityMonths = age < 40 ? 12 : (age < 50 ? 12 : 6);
  } else if (medicalClass === 2) {
    validityMonths = age < 40 ? 60 : (age < 50 ? 24 : 12);
  } else { // LAPL
    validityMonths = age < 40 ? 60 : (age < 50 ? 24 : 12);
  }

  const expirationDate = addMonths(medicalIssueDate, validityMonths);
  const daysRemaining = differenceInDays(expirationDate, new Date());

  // Alertes
  if (daysRemaining <= 0) {
    return { status: 'EXPIRED', severity: 'critical', message: 'Certificat mÃ©dical expirÃ© !' };
  } else if (daysRemaining <= 30) {
    return { status: 'WARNING', severity: 'warning', message: `Renouveler avant ${daysRemaining} jours` };
  } else if (daysRemaining <= 60) {
    return { status: 'NOTICE', severity: 'info', message: `Penser Ã  renouveler (${daysRemaining} jours)` };
  }

  return { status: 'VALID', severity: 'success', message: `Valide jusqu'au ${format(expirationDate, 'dd/MM/yyyy')}` };
}

// Alertes SEP revalidation
function checkSEPValidity(pilot, logbook) {
  const lastRevalidation = pilot.sepRevalidationDate;
  const expirationDate = addMonths(lastRevalidation, 24);

  // VÃ©rifier activitÃ© rÃ©cente (12 derniers mois)
  const last12Months = subMonths(new Date(), 12);
  const recentFlights = logbook.filter(f => f.date >= last12Months && f.aircraftClass === 'SEP');

  const totalHours = sumBy(recentFlights, 'flightTime') / 60;
  const picHours = sumBy(recentFlights.filter(f => f.function === 'PIC'), 'flightTime') / 60;
  const totalLandings = sumBy(recentFlights, 'landings');

  const requirementsMet = totalHours >= 12 && picHours >= 6 && totalLandings >= 12;

  if (!requirementsMet) {
    return {
      status: 'REQUIREMENTS_NOT_MET',
      severity: 'warning',
      message: `ActivitÃ© insuffisante pour revalidation (${totalHours.toFixed(1)}h dont ${picHours.toFixed(1)}h PIC, ${totalLandings} atterrissages)`,
      needed: {
        hours: Math.max(0, 12 - totalHours),
        picHours: Math.max(0, 6 - picHours),
        landings: Math.max(0, 12 - totalLandings)
      }
    };
  }

  return { status: 'VALID', severity: 'success', message: 'SEP valide' };
}
</code></pre>

<h4>Export PDF Credentials</h4>

<p>FonctionnalitÃ© export PDF profil complet pilote :</p>

<ul>
    <li>Photo + infos personnelles</li>
    <li>Licences avec numÃ©ros et dates</li>
    <li>Qualifications avec validitÃ©s</li>
    <li>Certificat mÃ©dical (classe, expiration)</li>
    <li>Statistiques vol (heures totales, PIC, types avion)</li>
    <li>QR code vers profil Supabase (optionnel)</li>
</ul>

<h4>PrÃ©fÃ©rences d'UnitÃ©s (Unit Preferences)</h4>

<p>Le module Pilot intÃ¨gre un systÃ¨me complet de prÃ©fÃ©rences d'unitÃ©s permettant au pilote de personnaliser l'affichage selon ses habitudes (systÃ¨me mÃ©trique EASA, impÃ©rial FAA, ou mixte). Ces prÃ©fÃ©rences sont appliquÃ©es <strong>globalement</strong> Ã  travers toute l'application (navigation, performance, mÃ©tÃ©o, carnet de vol).</p>

<div class="info-box">
    <strong>ğŸ“¦ Store:</strong> <code>pilotStore.preferences.units</code><br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage + Supabase sync<br>
    <strong>ğŸ”„ Application:</strong> Temps rÃ©el via Zustand (tous composants abonnÃ©s)<br>
    <strong>ğŸ“„ Fichier:</strong> <code>src/features/pilot/UnitPreferences.jsx</code> (400 lignes)
</div>

<h5>SystÃ¨me d'UnitÃ©s SupportÃ©</h5>

<table>
    <thead>
        <tr>
            <th>CatÃ©gorie</th>
            <th>Options Disponibles</th>
            <th>Usage dans l'App</th>
            <th>Valeur par DÃ©faut</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Distances</strong></td>
            <td>
                â€¢ <code>km</code> (KilomÃ¨tres)<br>
                â€¢ <code>nm</code> (Nautical Miles)<br>
                â€¢ <code>mi</code> (Statute Miles)
            </td>
            <td>Navigation, route planning, cartes, distances aÃ©rodromes</td>
            <td><code>nm</code> (EASA standard)</td>
        </tr>
        <tr>
            <td><strong>Altitudes</strong></td>
            <td>
                â€¢ <code>ft</code> (Feet)<br>
                â€¢ <code>m</code> (MÃ¨tres)
            </td>
            <td>Plan de vol, altitudes croisiÃ¨re, Ã©lÃ©vations terrains, METAR</td>
            <td><code>ft</code> (Aviation standard)</td>
        </tr>
        <tr>
            <td><strong>Vitesses</strong></td>
            <td>
                â€¢ <code>kt</code> (Knots)<br>
                â€¢ <code>km/h</code> (KilomÃ¨tres/heure)<br>
                â€¢ <code>mph</code> (Miles/heure)
            </td>
            <td>Vitesses sol/air, vents, vitesses avion (Vne, Vs0, Vx, Vy), METAR</td>
            <td><code>kt</code> (Aviation standard)</td>
        </tr>
        <tr>
            <td><strong>TempÃ©ratures</strong></td>
            <td>
                â€¢ <code>Â°C</code> (Celsius)<br>
                â€¢ <code>Â°F</code> (Fahrenheit)
            </td>
            <td>METAR, TAF, performances (ISA deviation), OAT cockpit</td>
            <td><code>Â°C</code> (EASA standard)</td>
        </tr>
        <tr>
            <td><strong>Carburant</strong></td>
            <td>
                â€¢ <code>L</code> (Litres)<br>
                â€¢ <code>gal</code> (US Gallons)<br>
                â€¢ <code>imp_gal</code> (Imperial Gallons)<br>
                â€¢ <code>kg</code> (Kilogrammes)
            </td>
            <td>RÃ©servoirs, consommation, endurance, calculs carburant, W&B</td>
            <td><code>L</code> (EASA)</td>
        </tr>
        <tr>
            <td><strong>Masses</strong></td>
            <td>
                â€¢ <code>kg</code> (Kilogrammes)<br>
                â€¢ <code>lb</code> (Pounds)
            </td>
            <td>Weight & Balance, masse avion, charge utile, passagers, bagages</td>
            <td><code>kg</code> (EASA standard)</td>
        </tr>
        <tr>
            <td><strong>Pressions</strong></td>
            <td>
                â€¢ <code>hPa</code> (Hectopascals)<br>
                â€¢ <code>inHg</code> (Inches Mercury)<br>
                â€¢ <code>mb</code> (Millibars)
            </td>
            <td>QNH METAR, calage altimÃ©trique, pression atmosphÃ©rique ISA</td>
            <td><code>hPa</code> (EASA standard)</td>
        </tr>
        <tr>
            <td><strong>VisibilitÃ©</strong></td>
            <td>
                â€¢ <code>m</code> (MÃ¨tres)<br>
                â€¢ <code>km</code> (KilomÃ¨tres)<br>
                â€¢ <code>mi</code> (Statute Miles)
            </td>
            <td>METAR/TAF visibilitÃ© horizontale, RVR piste</td>
            <td><code>m</code> ou <code>km</code> (EASA)</td>
        </tr>
        <tr>
            <td><strong>Vertical Speeds</strong></td>
            <td>
                â€¢ <code>ft/min</code> (Feet/minute)<br>
                â€¢ <code>m/s</code> (MÃ¨tres/seconde)
            </td>
            <td>Taux de montÃ©e/descente avion (Vx, Vy), variomÃ¨tre</td>
            <td><code>ft/min</code> (Aviation standard)</td>
        </tr>
    </tbody>
</table>

<h5>Presets Rapides</h5>

<p>L'interface propose 3 presets prÃ©-configurÃ©s pour faciliter la configuration initiale :</p>

<div class="info-box">
    <strong>ğŸ‡ªğŸ‡º EASA Standard (Europe)</strong><br>
    â€¢ Distances: <code>nm</code>, Altitudes: <code>ft</code>, Vitesses: <code>kt</code><br>
    â€¢ TempÃ©ratures: <code>Â°C</code>, Pressions: <code>hPa</code>, Carburant: <code>L</code>, Masses: <code>kg</code><br>
    <em>âœ RecommandÃ© pour pilotes basÃ©s en Europe (France, Allemagne, Espagne...)</em>
</div>

<div class="info-box">
    <strong>ğŸ‡ºğŸ‡¸ FAA Standard (USA)</strong><br>
    â€¢ Distances: <code>nm</code>, Altitudes: <code>ft</code>, Vitesses: <code>kt</code><br>
    â€¢ TempÃ©ratures: <code>Â°F</code>, Pressions: <code>inHg</code>, Carburant: <code>gal</code>, Masses: <code>lb</code><br>
    <em>âœ RecommandÃ© pour pilotes basÃ©s aux Ã‰tats-Unis</em>
</div>

<div class="info-box">
    <strong>ğŸŒ MÃ©trique Pur (Non-standard)</strong><br>
    â€¢ Distances: <code>km</code>, Altitudes: <code>m</code>, Vitesses: <code>km/h</code><br>
    â€¢ TempÃ©ratures: <code>Â°C</code>, Pressions: <code>hPa</code>, Carburant: <code>L</code>, Masses: <code>kg</code><br>
    <em>âœ Option pour pilotes prÃ©fÃ©rant le systÃ¨me mÃ©trique complet (rare en aviation)</em>
</div>

<h5>Conversions Automatiques et Affichage</h5>

<p>Toutes les conversions sont gÃ©rÃ©es via le module <code>src/utils/unitConversions.js</code> (300 lignes) avec des fonctions pures testÃ©es unitairement :</p>

<pre><code>// Exemple conversion distance
function convertDistance(value, fromUnit, toUnit) {
  // Toutes conversions passent par NM (unitÃ© pivot)
  const nmValue = toNauticalMiles(value, fromUnit);
  return fromNauticalMiles(nmValue, toUnit);
}

// Conversions disponibles
const conversions = {
  distance: { km: 1.852, nm: 1, mi: 1.15078 },
  altitude: { ft: 1, m: 0.3048 },
  speed: { kt: 1, kmh: 1.852, mph: 1.15078 },
  temperature: { celsius: (f) => (f - 32) * 5/9, fahrenheit: (c) => c * 9/5 + 32 },
  fuel: { L: 1, gal: 3.78541, imp_gal: 4.54609, kg: (avgas) => 0.72 },
  mass: { kg: 1, lb: 0.453592 },
  pressure: { hPa: 1, inHg: 33.8639, mb: 1 }
};

// Hook React pour rÃ©cupÃ©rer prÃ©fÃ©rences utilisateur
function useUnitPreferences() {
  const preferences = usePilotStore(state => state.preferences.units);

  const format = (value, category) => {
    const targetUnit = preferences[category];
    const converted = convertValue(value, category, targetUnit);
    return `${converted.toFixed(precision[category])} ${targetUnit}`;
  };

  return { preferences, format };
}
</code></pre>

<p><strong>Affichage dynamique dans l'UI :</strong></p>

<ul>
    <li>Tous les champs numÃ©riques s'adaptent automatiquement aux prÃ©fÃ©rences utilisateur</li>
    <li>Labels dynamiques affichant l'unitÃ© courante (ex: "Distance (nm)" ou "Distance (km)")</li>
    <li>Tooltips affichant valeur alternative (ex: "150 nm (278 km)" au survol)</li>
    <li>Saisie manuelle accepte plusieurs unitÃ©s avec conversion automatique (ex: "100km" â†’ converti en nm si prÃ©fÃ©rence = nm)</li>
</ul>

<h4>Historique de Vols et Statistiques</h4>

<p>Le module Pilot intÃ¨gre un systÃ¨me de <strong>statistiques avancÃ©es</strong> basÃ© sur le carnet de vol (Module Logbook), calculÃ©es automatiquement et mises Ã  jour en temps rÃ©el Ã  chaque ajout/modification d'entrÃ©e.</p>

<div class="info-box">
    <strong>ğŸ“¦ Source DonnÃ©es:</strong> <code>logbookStore.entries</code> (synchronisÃ© depuis Supabase)<br>
    <strong>ğŸ§® Calculs:</strong> <code>src/features/pilot/FlightStatistics.jsx</code> (500 lignes)<br>
    <strong>âš¡ Performance:</strong> Calculs mÃ©morisÃ©s via <code>useMemo</code> (recalcul uniquement si logbook modifiÃ©)<br>
    <strong>ğŸ“Š Affichage:</strong> Onglet "Statistiques" dans PilotModule + dashboard cards
</div>

<h5>Totalisations Automatiques</h5>

<table>
    <thead>
        <tr>
            <th>Statistique</th>
            <th>Description</th>
            <th>Calcul</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Heures Totales</strong></td>
            <td>Total temps de vol toutes fonctions</td>
            <td><code>SUM(logbook.flightTime)</code></td>
            <td>ExpÃ©rience globale, CV pilote, assurance</td>
        </tr>
        <tr>
            <td><strong>Heures PIC</strong></td>
            <td>Pilote Commandant de Bord</td>
            <td><code>SUM(flightTime WHERE function='PIC')</code></td>
            <td>Revalidation licences, assurance, expÃ©rience CDB</td>
        </tr>
        <tr>
            <td><strong>Heures DUAL</strong></td>
            <td>Double commande (instruction)</td>
            <td><code>SUM(flightTime WHERE function='DUAL')</code></td>
            <td>Formation initiale/continue, progression Ã©lÃ¨ve</td>
        </tr>
        <tr>
            <td><strong>Heures SOLO</strong></td>
            <td>Vol solo Ã©lÃ¨ve-pilote</td>
            <td><code>SUM(flightTime WHERE function='SOLO')</code></td>
            <td>Progression formation PPL/LAPL</td>
        </tr>
        <tr>
            <td><strong>Heures Nuit</strong></td>
            <td>Vol de nuit</td>
            <td><code>SUM(flightTime WHERE nightTime > 0)</code></td>
            <td>Qualification Night Rating, expÃ©rience nuit</td>
        </tr>
        <tr>
            <td><strong>Heures IFR</strong></td>
            <td>Vol aux instruments (IMC rÃ©el + simulated)</td>
            <td><code>SUM(ifrTime)</code></td>
            <td>Revalidation IR, expÃ©rience IFR</td>
        </tr>
        <tr>
            <td><strong>Heures SEP</strong></td>
            <td>Single-Engine Piston</td>
            <td><code>SUM(flightTime WHERE aircraftClass='SEP')</code></td>
            <td>Revalidation SEP (12h/24 mois requis)</td>
        </tr>
        <tr>
            <td><strong>Heures MEP</strong></td>
            <td>Multi-Engine Piston</td>
            <td><code>SUM(flightTime WHERE aircraftClass='MEP')</code></td>
            <td>Revalidation MEP (10h/12 mois requis)</td>
        </tr>
        <tr>
            <td><strong>Atterrissages Totaux</strong></td>
            <td>Total atterrissages jour + nuit</td>
            <td><code>SUM(landings)</code></td>
            <td>ExpÃ©rience, revalidation (12 TO/LDG SEP)</td>
        </tr>
        <tr>
            <td><strong>Atterrissages Jour</strong></td>
            <td>Atterrissages diurnes</td>
            <td><code>SUM(landings WHERE dayNight='DAY')</code></td>
            <td>Statistiques</td>
        </tr>
        <tr>
            <td><strong>Atterrissages Nuit</strong></td>
            <td>Atterrissages nocturnes</td>
            <td><code>SUM(landings WHERE dayNight='NIGHT')</code></td>
            <td>Night Rating (5 requis), currency nuit</td>
        </tr>
        <tr>
            <td><strong>AÃ©rodromes VisitÃ©s</strong></td>
            <td>Nombre d'aÃ©rodromes uniques</td>
            <td><code>COUNT(DISTINCT departure + arrival)</code></td>
            <td>ExpÃ©rience variÃ©tÃ© terrains</td>
        </tr>
        <tr>
            <td><strong>Avions PilotÃ©s</strong></td>
            <td>Types avion diffÃ©rents</td>
            <td><code>COUNT(DISTINCT aircraftModel)</code></td>
            <td>ExpÃ©rience diversitÃ© machines</td>
        </tr>
        <tr>
            <td><strong>Pays VisitÃ©s</strong></td>
            <td>Pays diffÃ©rents via codes ICAO</td>
            <td><code>COUNT(DISTINCT country FROM icao[0:2])</code></td>
            <td>ExpÃ©rience internationale</td>
        </tr>
    </tbody>
</table>

<h5>Statistiques PÃ©riode RÃ©cente (Derniers 12 Mois)</h5>

<p>Calculs spÃ©cifiques pour <strong>activitÃ© rÃ©cente</strong> (utilisÃ©s pour vÃ©rifications revalidations licences) :</p>

<pre><code>// Calcul activitÃ© 12 derniers mois
function calculateRecentActivity(logbook) {
  const last12Months = subMonths(new Date(), 12);
  const recentFlights = logbook.filter(f => parseISO(f.date) >= last12Months);

  return {
    // Heures par classe
    sepHours: sumFlightTime(recentFlights, { aircraftClass: 'SEP' }),
    mepHours: sumFlightTime(recentFlights, { aircraftClass: 'MEP' }),

    // Heures par fonction
    picHours: sumFlightTime(recentFlights, { function: 'PIC' }),
    dualHours: sumFlightTime(recentFlights, { function: 'DUAL' }),

    // Atterrissages
    totalLandings: sumBy(recentFlights, 'landings'),

    // VÃ©rification conditions revalidation SEP
    sepRevalidationOK: checkSEPRevalidation(recentFlights),

    // VÃ©rification conditions revalidation MEP
    mepRevalidationOK: checkMEPRevalidation(recentFlights)
  };
}

// VÃ©rification revalidation SEP Part-FCL
function checkSEPRevalidation(recentFlights) {
  const sepFlights = recentFlights.filter(f => f.aircraftClass === 'SEP');

  const totalHours = sumFlightTime(sepFlights);
  const picHours = sumFlightTime(sepFlights, { function: 'PIC' });
  const landings = sumBy(sepFlights, 'landings');

  const requirements = {
    totalHours: { needed: 12, actual: totalHours, met: totalHours >= 12 },
    picHours: { needed: 6, actual: picHours, met: picHours >= 6 },
    landings: { needed: 12, actual: landings, met: landings >= 12 }
  };

  const allMet = Object.values(requirements).every(r => r.met);

  return {
    valid: allMet,
    requirements,
    message: allMet
      ? 'Conditions revalidation SEP remplies'
      : 'ActivitÃ© insuffisante pour revalidation SEP'
  };
}
</code></pre>

<h5>Graphiques et Visualisations</h5>

<p>Le module affiche les statistiques sous forme de graphiques interactifs (librairie <strong>Recharts</strong>) :</p>

<ul>
    <li><strong>Ã‰volution heures de vol par mois</strong> (Line Chart) : tendance activitÃ© sur 12/24 mois</li>
    <li><strong>RÃ©partition par type avion</strong> (Pie Chart) : % heures par modÃ¨le (DA40, C172, PA28...)</li>
    <li><strong>RÃ©partition par fonction</strong> (Bar Chart) : PIC vs DUAL vs SOLO</li>
    <li><strong>RÃ©partition jour/nuit</strong> (Donut Chart) : % vols diurnes vs nocturnes</li>
    <li><strong>Top 10 aÃ©rodromes</strong> (Bar Chart horizontal) : aÃ©rodromes les plus frÃ©quentÃ©s</li>
    <li><strong>Carte interactive des vols</strong> (Leaflet) : traces GPS des routes effectuÃ©es (si disponibles)</li>
</ul>

<div class="warning-box">
    <strong>âš ï¸ Note RÃ©glementaire :</strong> Les statistiques calculÃ©es automatiquement sont indicatives. Le pilote reste responsable de la vÃ©rification manuelle de ses heures et qualifications pour toute dÃ©marche rÃ©glementaire (revalidation, assurance, candidature emploi). En cas de doute, se rÃ©fÃ©rer au carnet de vol papier officiel ou aux donnÃ©es Supabase brutes.
</div>

<h5>Export et Partage</h5>

<p>Les statistiques peuvent Ãªtre exportÃ©es :</p>

<ul>
    <li><strong>PDF RÃ©sumÃ© Statistiques</strong> : document 2 pages avec tous totaux + graphiques (pour CV, assurance)</li>
    <li><strong>CSV DonnÃ©es Brutes</strong> : export Excel-compatible pour analyses personnalisÃ©es</li>
    <li><strong>Partage Public (Optionnel)</strong> : lien public Supabase vers profil pilote read-only (pour recruteurs, aÃ©ro-clubs)</li>
</ul>

<h3 id="module-logbook">2.2.2 Module Logbook (Carnet de Vol Ã‰lectronique)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/logbook/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Carnet de vol Ã©lectronique rÃ©glementaire avec totalisations automatiques<br>
    <strong>ğŸ“¦ Store:</strong> <code>logbookStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> Supabase (logbook_entries) + export CSV/PDF<br>
    <strong>ğŸ“„ Fichiers clÃ©s:</strong> <code>LogbookModule.jsx</code> (600 lignes), <code>PilotLogbook.jsx</code> (1900 lignes)
</div>

<h4>DonnÃ©es EnregistrÃ©es par Vol</h4>

<table>
    <thead>
        <tr>
            <th>Champ</th>
            <th>Source</th>
            <th>Type</th>
            <th>Validation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Date</td>
            <td><code>flightPlan.generalInfo.flightDate</code> (auto) ou saisie manuelle</td>
            <td>Date</td>
            <td>Required, format DD/MM/YYYY</td>
        </tr>
        <tr>
            <td>DÃ©part (ICAO)</td>
            <td><code>route.waypoints[0].icao</code> (auto) ou saisie</td>
            <td>Text 4 chars</td>
            <td>Required, format ICAO (LFST, LFPO...)</td>
        </tr>
        <tr>
            <td>ArrivÃ©e (ICAO)</td>
            <td><code>route.waypoints[last].icao</code> (auto) ou saisie</td>
            <td>Text 4 chars</td>
            <td>Required, format ICAO</td>
        </tr>
        <tr>
            <td>Immatriculation</td>
            <td><code>aircraft.registration</code> (auto) ou saisie</td>
            <td>Text</td>
            <td>Required, format F-ABCD ou Ã©quivalent</td>
        </tr>
        <tr>
            <td>Type avion</td>
            <td><code>aircraft.model</code> (auto) ou saisie</td>
            <td>Text</td>
            <td>Optional (DA40, C172, PA28...)</td>
        </tr>
        <tr>
            <td>Temps de vol (Total)</td>
            <td><code>navigationResults.totalTime</code> (auto) ou saisie</td>
            <td>DurÃ©e HH:MM</td>
            <td>Required, format 01:30 (1h30)</td>
        </tr>
        <tr>
            <td>Temps PIC</td>
            <td>Saisie manuelle ou = Total si solo</td>
            <td>DurÃ©e HH:MM</td>
            <td>â‰¤ Temps Total</td>
        </tr>
        <tr>
            <td>Temps DUAL</td>
            <td>Saisie manuelle (instruction)</td>
            <td>DurÃ©e HH:MM</td>
            <td>â‰¤ Temps Total, exclusif avec PIC</td>
        </tr>
        <tr>
            <td>Atterrissages</td>
            <td>Comptage waypoints ICAO (auto) ou saisie</td>
            <td>Number</td>
            <td>â‰¥ 1</td>
        </tr>
        <tr>
            <td>Jour / Nuit</td>
            <td><code>flightPlan.generalInfo.dayNight</code> (auto) ou saisie</td>
            <td>Enum</td>
            <td>DAY, NIGHT, MIXED</td>
        </tr>
        <tr>
            <td>VFR / IFR</td>
            <td><code>flightPlan.generalInfo.flightType</code> (auto) ou saisie</td>
            <td>Enum</td>
            <td>VFR, IFR</td>
        </tr>
        <tr>
            <td>SEP / MEP</td>
            <td><code>aircraft.engineCount</code> (auto) ou saisie</td>
            <td>Enum</td>
            <td>SEP (single), MEP (multi)</td>
        </tr>
        <tr>
            <td>Remarques</td>
            <td>Saisie manuelle</td>
            <td>Text area</td>
            <td>Optional, max 500 caractÃ¨res</td>
        </tr>
    </tbody>
</table>

<h4>Totalisations Automatiques</h4>

<p>Le module calcule automatiquement les totaux suivants (mise Ã  jour temps rÃ©el) :</p>

<pre><code>// Calcul totalisations depuis logbook
function calculateTotals(logbookEntries, filters) {
  const filtered = applyFilters(logbookEntries, filters);

  const totals = {
    // Temps total
    totalTime: sumDurations(filtered, 'flightTime'),

    // Temps par fonction
    picTime: sumDurations(filtered.filter(e => e.function === 'PIC'), 'flightTime'),
    dualTime: sumDurations(filtered.filter(e => e.function === 'DUAL'), 'flightTime'),
    soloTime: sumDurations(filtered.filter(e => e.function === 'SOLO'), 'flightTime'),

    // Temps par classe avion
    sepTime: sumDurations(filtered.filter(e => e.aircraftClass === 'SEP'), 'flightTime'),
    mepTime: sumDurations(filtered.filter(e => e.aircraftClass === 'MEP'), 'flightTime'),

    // Temps jour/nuit
    dayTime: sumDurations(filtered.filter(e => e.dayNight === 'DAY'), 'flightTime'),
    nightTime: sumDurations(filtered.filter(e => e.dayNight === 'NIGHT'), 'flightTime'),

    // Temps VFR/IFR
    vfrTime: sumDurations(filtered.filter(e => e.flightType === 'VFR'), 'flightTime'),
    ifrTime: sumDurations(filtered.filter(e => e.flightType === 'IFR'), 'flightTime'),

    // Atterrissages
    totalLandings: sumBy(filtered, 'landings'),
    dayLandings: sumBy(filtered.filter(e => e.dayNight === 'DAY'), 'landings'),
    nightLandings: sumBy(filtered.filter(e => e.dayNight === 'NIGHT'), 'landings'),

    // AÃ©rodromes visitÃ©s
    uniqueAerodromes: new Set([
      ...filtered.map(e => e.departure),
      ...filtered.map(e => e.arrival)
    ]).size,

    // Temps par type avion
    byAircraftType: groupBy(filtered, 'aircraftModel')
      .map(group => ({
        type: group[0].aircraftModel,
        time: sumDurations(group, 'flightTime'),
        flights: group.length
      })),

    // Temps par immatriculation
    byRegistration: groupBy(filtered, 'aircraftRegistration')
      .map(group => ({
        registration: group[0].aircraftRegistration,
        time: sumDurations(group, 'flightTime'),
        flights: group.length
      })),

    // Statistiques pÃ©riode
    last30Days: calculatePeriodStats(filtered, 30),
    last90Days: calculatePeriodStats(filtered, 90),
    last12Months: calculatePeriodStats(filtered, 365),
    currentYear: calculateYearStats(filtered, new Date().getFullYear())
  };

  return totals;
}

// Affichage formÃ©
function formatDuration(minutes) {
  const hours = Math.floor(minutes / 60);
  const mins = Math.round(minutes % 60);
  return `${hours}h${String(mins).padStart(2, '0')}`;
}

// Exemple output:
// Temps total: 145h32
// Temps PIC: 98h15
// Temps DUAL: 47h17
// SEP: 132h45
// Atterrissages: 287 (dont 23 nuit)
// AÃ©rodromes visitÃ©s: 42
</code></pre>

<h4>Filtres et Recherche</h4>

<p>Filtres disponibles sur le tableau logbook :</p>

<table>
    <thead>
        <tr>
            <th>Filtre</th>
            <th>Type</th>
            <th>Options</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>PÃ©riode</td>
            <td>Date range</td>
            <td>Dernier mois, 3 mois, 6 mois, annÃ©e, personnalisÃ©</td>
        </tr>
        <tr>
            <td>Immatriculation</td>
            <td>Select</td>
            <td>Liste unique registrations logbook</td>
        </tr>
        <tr>
            <td>Type avion</td>
            <td>Select</td>
            <td>Liste unique models logbook</td>
        </tr>
        <tr>
            <td>Classe</td>
            <td>Checkbox</td>
            <td>SEP, MEP</td>
        </tr>
        <tr>
            <td>Fonction</td>
            <td>Checkbox</td>
            <td>PIC, DUAL, SOLO</td>
        </tr>
        <tr>
            <td>Jour/Nuit</td>
            <td>Checkbox</td>
            <td>DAY, NIGHT</td>
        </tr>
        <tr>
            <td>VFR/IFR</td>
            <td>Checkbox</td>
            <td>VFR, IFR</td>
        </tr>
        <tr>
            <td>AÃ©rodrome</td>
            <td>Text search</td>
            <td>Recherche dÃ©part ou arrivÃ©e (ICAO ou nom)</td>
        </tr>
    </tbody>
</table>

<h4>Export et Compliance RÃ©glementaire</h4>

<p><strong>Export CSV :</strong> Toutes colonnes logbook au format standardisÃ© pour import Excel/LibreOffice</p>
<p><strong>Export PDF :</strong> Carnet de vol formatÃ© rÃ©glementaire avec :</p>

<ul>
    <li>En-tÃªte : Nom pilote, numÃ©ro licence, pÃ©riode</li>
    <li>Tableau : Date, DÃ©part, ArrivÃ©e, Immat, Type, Temps (Total, PIC, DUAL), Atterrissages, Jour/Nuit, VFR/IFR, Remarques</li>
    <li>Totaux par page + totaux cumulÃ©s</li>
    <li>Signature pilote + certification "Je certifie l'exactitude des informations ci-dessus"</li>
</ul>

<p><strong>Synchronisation Supabase :</strong> Multi-devices (PC, tablette, smartphone) avec conflict resolution timestamp-based</p>

<h3 id="module-checklist">2.2.3 Module Checklist (Check-lists Interactives)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/checklist/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Check-lists personnalisables par avion et phase de vol<br>
    <strong>ğŸ“¦ Store:</strong> <code>checklistStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (progression) + Supabase (templates)<br>
    <strong>ğŸ“„ Fichiers clÃ©s:</strong> <code>ChecklistModule.jsx</code> (500 lignes), <code>ChecklistEditor.jsx</code>
</div>

<h4>Phases de Vol et Templates</h4>

<table>
    <thead>
        <tr>
            <th>Phase</th>
            <th>IcÃ´ne</th>
            <th>Timing</th>
            <th>Items Typiques</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Before Start</td>
            <td>ğŸ“‹</td>
            <td>Avant dÃ©marrage moteur</td>
            <td>Documents (licences, CdN, assurance, MANEX), VÃ©rif extÃ©rieure (carburant, huile, gouvernes), Cabine (ceintures, portes, master OFF)</td>
        </tr>
        <tr>
            <td>Engine Start</td>
            <td>ğŸ”§</td>
            <td>DÃ©marrage moteur</td>
            <td>Mixture RICH, Carb Heat COLD, Throttle 1cm, Master ON, Fuel Pump ON, Start, Oil Pressure check</td>
        </tr>
        <tr>
            <td>Before Takeoff</td>
            <td>ğŸ›«</td>
            <td>Holding point piste</td>
            <td>ContrÃ´les vol (AILERONS-PROFONDEUR-DIRECTION), Trim NEUTRAL, Flaps TO, Instruments (T&P verts), Carb Heat HOT puis COLD, Magnetos L/R/BOTH, Brief dÃ©collage</td>
        </tr>
        <tr>
            <td>After Takeoff</td>
            <td>âœˆï¸</td>
            <td>AprÃ¨s dÃ©collage (400 ft AGL)</td>
            <td>Flaps UP, Fuel Pump OFF, Climb power (25"/2500 RPM), AltimÃ¨tre QNH, After TO checks</td>
        </tr>
        <tr>
            <td>Cruise</td>
            <td>ğŸŒ¤ï¸</td>
            <td>Altitude croisiÃ¨re</td>
            <td>Cruise power (23"/2300 RPM), Mixture LEAN, Fuel check (quantitÃ©, sÃ©lecteur), AltimÃ¨tre QNH update</td>
        </tr>
        <tr>
            <td>Descent</td>
            <td>ğŸ›¬</td>
            <td>Top of Descent</td>
            <td>Briefing arrivÃ©e (piste, QFU, vent), AltimÃ¨tre QNH destination, Carb Heat HOT, Mixture progressivement RICH</td>
        </tr>
        <tr>
            <td>Before Landing</td>
            <td>ğŸ</td>
            <td>Downwind / Base</td>
            <td>BUMPH check (Brakes, Undercarriage fixed, Mixture RICH, Propeller FULL, Harness), Flaps progressif, Fuel Pump ON</td>
        </tr>
        <tr>
            <td>After Landing</td>
            <td>ğŸš¶</td>
            <td>AprÃ¨s vacating piste</td>
            <td>Flaps UP, Carb Heat COLD, Fuel Pump OFF, Lights OFF, Transponder STANDBY</td>
        </tr>
        <tr>
            <td>Shutdown</td>
            <td>ğŸ”’</td>
            <td>Parking</td>
            <td>Parking brake ON, Throttle IDLE 30s, Mixture CUT-OFF, Magnetos OFF, Master OFF, Hobbs time, Calage avion</td>
        </tr>
    </tbody>
</table>

<h4>FonctionnalitÃ©s Checklist</h4>

<ul>
    <li><strong>Templates par avion :</strong> Chaque avion possÃ¨de sa propre checklist personnalisÃ©e (DA40, C172, PA28...)</li>
    <li><strong>Ã‰diteur drag & drop :</strong> RÃ©organiser items, ajouter/supprimer, modifier texte</li>
    <li><strong>Progression sauvegardÃ©e :</strong> Ã‰tat cochÃ©/dÃ©cochÃ© persiste entre sessions (localStorage)</li>
    <li><strong>Mode vol :</strong> Affichage plein Ã©cran checklist, grandes checkboxes tactiles (tablette cockpit)</li>
    <li><strong>Audio confirm :</strong> Son "ding" Ã  chaque item cochÃ© (optionnel)</li>
    <li><strong>Reset automatique :</strong> AprÃ¨s vol complet (shutdown), rÃ©initialisation pour prochain vol</li>
    <li><strong>Partage community :</strong> Import/export JSON checklist, upload Supabase pour partage</li>
    <li><strong>Multi-langue :</strong> Checklist FR/EN (termes aÃ©ronautiques standards)</li>
</ul>

<h4>Format JSON Checklist</h4>

<pre><code>{
  "aircraftModel": "DA40 NG",
  "registration": "F-HSTR",
  "checklists": [
    {
      "phase": "before_start",
      "phaseName": "Before Start",
      "items": [
        {
          "id": "bs-001",
          "text": "Documents bord (Licence, MÃ©dical, CdN, Assurance, MANEX)",
          "checked": false,
          "critical": true
        },
        {
          "id": "bs-002",
          "text": "Visite prÃ©vol extÃ©rieure effectuÃ©e",
          "checked": false,
          "critical": true
        },
        {
          "id": "bs-003",
          "text": "QuantitÃ© carburant vÃ©rifiÃ©e (bouchons, drains)",
          "checked": false,
          "critical": true
        },
        {
          "id": "bs-004",
          "text": "Niveau huile MIN 6 qts",
          "checked": false,
          "critical": true
        },
        {
          "id": "bs-005",
          "text": "Cabine : Ceintures attachÃ©es, Portes fermÃ©es",
          "checked": false,
          "critical": false
        },
        {
          "id": "bs-006",
          "text": "Master OFF, Magnetos OFF",
          "checked": false,
          "critical": true
        }
      ]
    },
    {
      "phase": "before_takeoff",
      "phaseName": "Before Takeoff",
      "items": [
        {
          "id": "bt-001",
          "text": "ContrÃ´les vol LIBRES et CORRECTS (Ailerons, Profondeur, Direction)",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-002",
          "text": "Trim NEUTRAL ou selon CG",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-003",
          "text": "Flaps position DÃ‰COLLAGE (0Â° ou 15Â° selon config)",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-004",
          "text": "Instruments moteur T&P VERTS",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-005",
          "text": "Carb Heat : HOT test puis COLD",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-006",
          "text": "Magnetos : L/R/BOTH (drop < 150 RPM, diff < 50 RPM)",
          "checked": false,
          "critical": true
        },
        {
          "id": "bt-007",
          "text": "Briefing dÃ©collage : Panne avant Vr â†’ STOP, aprÃ¨s Vr < 400ft â†’ atterrir droit devant, > 400ft â†’ circuit",
          "checked": false,
          "critical": true
        }
      ]
    }
  ]
}
</code></pre>

<h3 id="module-regulations">2.2.4 Module Regulations (RÃ©fÃ©rences RÃ©glementaires)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/regulations/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Base de donnÃ©es rÃ¨glements aÃ©ronautiques avec recherche full-text<br>
    <strong>ğŸ“¦ Store:</strong> <code>regulationsStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> localStorage (favoris) + liens externes EASA/DGAC<br>
    <strong>ğŸ“„ Fichiers clÃ©s:</strong> <code>RegulationsModule.jsx</code> (400 lignes), <code>regulationsData.js</code>
</div>

<h4>CatÃ©gories de RÃ¨glements</h4>

<table>
    <thead>
        <tr>
            <th>CatÃ©gorie</th>
            <th>RÃ¨glements</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>FCL (Flight Crew Licensing)</td>
            <td>Part-FCL EASA, FCL.010, FCL.030, FCL.040, FCL.055, FCL.065, FCL.135, FCL.140, FCL.205, FCL.215, FCL.740, FCL.805</td>
            <td>Licences pilotes (PPL, LAPL, CPL), qualifications (SEP, MEP, IR, night), revalidations, expÃ©rience rÃ©cente, instructeurs</td>
        </tr>
        <tr>
            <td>OPS (Operations)</td>
            <td>Part-NCO, Part-SPO, Part-CAT, Annexe 2 OACI</td>
            <td>RÃ¨gles vol VFR/IFR, minimums mÃ©tÃ©o, plans de vol, carburant, altimÃ©trie, espaces aÃ©riens, rÃ¨gles prioritÃ©</td>
        </tr>
        <tr>
            <td>AIR (Airworthiness)</td>
            <td>Part-21, Part-M, Part-ML, Part-CAMO</td>
            <td>NavigabilitÃ© avions, maintenance, CdN (Certificat de NavigabilitÃ©), inspections annuelles, AD (Airworthiness Directives)</td>
        </tr>
        <tr>
            <td>SERA (Standardised European Rules of the Air)</td>
            <td>SERA.3101, SERA.3105, SERA.3210, SERA.5001, SERA.5005, SERA.6001</td>
            <td>RÃ¨gles air, altitudes minimales, plans de vol, signaux, feux, transpondeur, altimÃ©trie (QNH/QFE/FL)</td>
        </tr>
        <tr>
            <td>MED (Medical)</td>
            <td>Part-MED, ARA.MED.150, ARA.MED.200, ARA.MED.300</td>
            <td>Certificats mÃ©dicaux classe 1/2/LAPL, validitÃ© selon Ã¢ge, restrictions, AME (Aero Medical Examiners)</td>
        </tr>
        <tr>
            <td>ATM (Air Traffic Management)</td>
            <td>RAC (RÃ¨gles Air Circulation France), RCA (RÃ¨gles Circulation AÃ©rienne)</td>
            <td>Espaces aÃ©riens (A/B/C/D/E/F/G), TMA, CTR, zones D/P/R, procÃ©dures VFR spÃ©ciales, autorisations</td>
        </tr>
    </tbody>
</table>

<h4>FonctionnalitÃ©s Module</h4>

<ul>
    <li><strong>Recherche full-text :</strong> Index Fuse.js sur titres + contenus rÃ¨glements (fuzzy search, typo tolerance)</li>
    <li><strong>Filtres catÃ©gories :</strong> FCL, OPS, AIR, SERA, MED, ATM</li>
    <li><strong>Liens externes :</strong> PDF officiels EASA, DGAC, OACI, JORF (Journal Officiel)</li>
    <li><strong>Favoris :</strong> Sauvegarde rÃ¨glements frÃ©quemment consultÃ©s (localStorage)</li>
    <li><strong>Historique :</strong> 20 derniers rÃ¨glements consultÃ©s</li>
    <li><strong>Mises Ã  jour :</strong> Notification quand rÃ¨glement amendÃ© (fetch JSON distant)</li>
</ul>

<h3 id="module-technical-log">2.2.5 Module Technical Log (Carnet Technique Avion)</h3>

<div class="info-box">
    <strong>ğŸ“‚ Emplacement:</strong> <code>src/features/technical-log/</code><br>
    <strong>ğŸ¯ Fonction:</strong> Suivi maintenance et navigabilitÃ© avions<br>
    <strong>ğŸ“¦ Store:</strong> <code>technicalLogStore</code> (Zustand)<br>
    <strong>ğŸ’¾ Persistance:</strong> Supabase (technical_logs) + IndexedDB (docs PDF)<br>
    <strong>ğŸ“„ Fichiers clÃ©s:</strong> <code>TechnicalLogModule.jsx</code> (128 lignes initialement, Ã  Ã©toffer)
</div>

<h4>Suivi Heures et Potentiels</h4>

<table>
    <thead>
        <tr>
            <th>Compteur</th>
            <th>UnitÃ©</th>
            <th>UtilitÃ©</th>
            <th>Seuils Alertes</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Heures cellule (Airframe)</td>
            <td>Heures de vol</td>
            <td>Suivi potentiel total avion</td>
            <td>Inspection 50h, 100h, annuelle</td>
        </tr>
        <tr>
            <td>Heures moteur (Engine)</td>
            <td>Heures de vol</td>
            <td>Suivi potentiel moteur (TBO = Time Between Overhaul)</td>
            <td>TBO typique 2000h (Lycoming/Continental)</td>
        </tr>
        <tr>
            <td>Heures hÃ©lice (Propeller)</td>
            <td>Heures de vol</td>
            <td>Suivi potentiel hÃ©lice</td>
            <td>Inspection 500h, rÃ©vision 2000h</td>
        </tr>
        <tr>
            <td>Cycles moteur</td>
            <td>DÃ©marrages</td>
            <td>Usure moteur (cycles thermiques)</td>
            <td>Alerte si ratio cycles/heures > 2</td>
        </tr>
        <tr>
            <td>Atterrissages</td>
            <td>Count</td>
            <td>Usure train, pneus, freins</td>
            <td>Inspection train 500 atterrissages</td>
        </tr>
    </tbody>
</table>

<h4>MEL/CDL (Minimum Equipment List / Configuration Deviation List)</h4>

<p>Gestion pannes acceptables pour vol :</p>

<table>
    <thead>
        <tr>
            <th>CatÃ©gorie</th>
            <th>Description</th>
            <th>Action Requise</th>
            <th>Limitation Vol</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>A (Critical)</td>
            <td>Ã‰quipement critique sÃ©curitÃ©</td>
            <td>RÃ©paration AVANT vol</td>
            <td>âŒ Vol interdit</td>
        </tr>
        <tr>
            <td>B (Essential)</td>
            <td>Ã‰quipement essentiel</td>
            <td>RÃ©paration dans 3 jours</td>
            <td>âš ï¸ Vol autorisÃ© avec limitations</td>
        </tr>
        <tr>
            <td>C (Important)</td>
            <td>Ã‰quipement important</td>
            <td>RÃ©paration dans 10 jours</td>
            <td>âœ… Vol autorisÃ© conditions normales</td>
        </tr>
        <tr>
            <td>D (Minor)</td>
            <td>Ã‰quipement mineur</td>
            <td>RÃ©paration prochaine maintenance</td>
            <td>âœ… Aucune limitation</td>
        </tr>
    </tbody>
</table>

<h4>AD (Airworthiness Directives) et SB (Service Bulletins)</h4>

<ul>
    <li><strong>AD Compliance :</strong> Suivi directives navigabilitÃ© obligatoires (EASA, FAA, constructeur)</li>
    <li><strong>SB Tracking :</strong> Bulletins service recommandÃ©s (non obligatoires mais conseillÃ©s)</li>
    <li><strong>Alertes Ã©chÃ©ances :</strong> AD rÃ©pÃ©titives (ex: inspection tous les 100h ou 12 mois)</li>
    <li><strong>Statut :</strong> N/A (Non Applicable), Compliant (Conforme), Overdue (En retard)</li>
</ul>

<h4>Inspections ProgrammÃ©es</h4>

<table>
    <thead>
        <tr>
            <th>Inspection</th>
            <th>FrÃ©quence</th>
            <th>Contenu</th>
            <th>CoÃ»t EstimÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>50 heures</td>
            <td>50h vol ou 6 mois</td>
            <td>Vidange huile, filtres, bougies, niveaux, freins, pneus</td>
            <td>300-500 â‚¬</td>
        </tr>
        <tr>
            <td>100 heures</td>
            <td>100h vol ou 12 mois</td>
            <td>Inspection moteur, contrÃ´les vol, train, propulsion, systÃ¨mes</td>
            <td>800-1200 â‚¬</td>
        </tr>
        <tr>
            <td>Annuelle (Annual)</td>
            <td>12 mois</td>
            <td>Inspection complÃ¨te navigabilitÃ©, renouvellement CdN</td>
            <td>1500-2500 â‚¬</td>
        </tr>
        <tr>
            <td>Progressive (Phase)</td>
            <td>4 phases/an</td>
            <td>Alternative annuelle : inspection divisÃ©e en 4 phases trimestrielles</td>
            <td>400-600 â‚¬ / phase</td>
        </tr>
    </tbody>
</table>

<h4>Export PDF Carnet Technique</h4>

<p>GÃ©nÃ©ration PDF complet :</p>

<ul>
    <li>Page 1 : Avion (immat, modÃ¨le, N/S, propriÃ©taire)</li>
    <li>Page 2 : Compteurs actuels (cellule, moteur, hÃ©lice, cycles)</li>
    <li>Page 3 : Historique maintenance (interventions avec dates, heures, description, mÃ©canicien)</li>
    <li>Page 4 : AD Compliance status</li>
    <li>Page 5 : Inspections programmÃ©es (prochaines Ã©chÃ©ances)</li>
    <li>Page 6 : MEL items actifs</li>
</ul>

<div class="page-break"></div>

<!-- SECTION 3: ASSISTANTS DÃ‰TAILLÃ‰S -->
<h1 id="assistants">3. Les Deux Assistants IntÃ©grÃ©s (Analyse Approfondie)</h1>

<p>ALFlight intÃ¨gre deux assistants majeurs qui guident l'utilisateur Ã  travers des processus complexes. Cette section dÃ©taille <strong>chaque Ã©tape</strong> avec les composants, les donnÃ©es collectÃ©es, les validations, et les flux de donnÃ©es.</p>

<h2 id="assistant-aircraft">3.1 Assistant de CrÃ©ation d'Avion (8 Ã‰tapes)</h2>

<div class="info-box">
    <strong>ğŸ“‚ Fichier principal:</strong> <code>src/features/aircraft/components/AircraftCreationWizard.jsx</code> (1420 lignes)<br>
    <strong>ğŸ¯ Objectif:</strong> CrÃ©er une configuration avion complÃ¨te avec masse, centrage, vitesses, performances, et Ã©quipements<br>
    <strong>ğŸ’¾ Persistance:</strong> Brouillon localStorage + Final IndexedDB + Optionnel Supabase (communautÃ©)
</div>

<h3 id="aircraft-step0">3.1.0 Step 0 - Community Check (VÃ©rification Base Communautaire)</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step0CommunityCheck.jsx</code><br>
    <strong>Objectif:</strong> Rechercher si une configuration avion existe dÃ©jÃ  dans la base communautaire Supabase<br>
    <strong>Actions possibles:</strong> Importer config existante OU CrÃ©er nouvelle configuration
</div>

<h4>Fonctionnement</h4>

<pre><code>// Chargement des presets communautaires
const loadCommunityAircraft = async () => {
  const presets = await communityService.getAllPresets();

  // Transformer au format UI
  const formattedAircraft = presets.map(preset => ({
    id: preset.id,
    registration: preset.registration,
    model: preset.model,
    manufacturer: preset.manufacturer,
    isVerified: preset.verified,
    votes: preset.votes_up - preset.votes_down,
    downloads: preset.downloads_count,
    hasManex: !!preset.manex_file_id,
    uploaded_by: preset.uploaded_by,
    created_at: preset.created_at
  }));

  setCommunityAircraft(formattedAircraft);
};

// Import d'une configuration existante
const handleImportAircraft = async (aircraft) => {
  setIsImporting(true);

  // TÃ©lÃ©charger donnÃ©es complÃ¨tes depuis Supabase
  const fullData = await communityService.getPresetById(aircraft.id);

  // TÃ©lÃ©charger MANEX PDF si disponible
  if (fullData.manex_file_id) {
    const manexBlob = await communityService.downloadManex(fullData.manex_file_id);
    fullData.manex = {
      fileName: manexBlob.name,
      file: await blobToBase64(manexBlob)
    };
  }

  // IncrÃ©menter compteur tÃ©lÃ©chargements
  await communityService.incrementDownloads(aircraft.id);

  // Remplir wizard avec donnÃ©es importÃ©es
  updateDataBulk(fullData.aircraft_data);

  // Passer directement Ã  Step 7 (Review)
  onComplete();
};
</code></pre>

<h4>Interface Utilisateur</h4>

<ul>
    <li><strong>Barre de recherche:</strong> Autocomplete sur registration/model/manufacturer</li>
    <li><strong>Liste rÃ©sultats:</strong> Cards avec:
        <ul>
            <li>Badge "âœ… VÃ©rifiÃ©" si <code>verified = true</code></li>
            <li>Votes communautÃ© (ğŸ‘/ğŸ‘)</li>
            <li>Nombre de tÃ©lÃ©chargements</li>
            <li>IcÃ´ne "ğŸ“– MANEX" si manuel disponible</li>
        </ul>
    </li>
    <li><strong>Actions:</strong>
        <ul>
            <li>Bouton "Importer" â†’ Charge config complÃ¨te</li>
            <li>Bouton "CrÃ©er nouveau" â†’ Skip vers Step 1</li>
        </ul>
    </li>
</ul>

<h3 id="aircraft-step1">3.1.1 Step 1 - Basic Info (Informations GÃ©nÃ©rales)</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step1BasicInfo.jsx</code> (400+ lignes)<br>
    <strong>Objectif:</strong> Saisir identification avion, capacitÃ©s, et upload MANEX PDF<br>
    <strong>DonnÃ©es collectÃ©es:</strong> 12 champs obligatoires + 1 PDF optionnel
</div>

<h4>Champs du Formulaire</h4>

<table>
    <thead>
        <tr>
            <th>Champ</th>
            <th>Type</th>
            <th>Validation</th>
            <th>Exemple</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Registration</td>
            <td>Text</td>
            <td>Required, unique, format F-XXXX</td>
            <td>F-HSTR</td>
        </tr>
        <tr>
            <td>Model</td>
            <td>Text</td>
            <td>Required</td>
            <td>DA40 NG</td>
        </tr>
        <tr>
            <td>Manufacturer</td>
            <td>Text</td>
            <td>Required</td>
            <td>Diamond Aircraft</td>
        </tr>
        <tr>
            <td>Category</td>
            <td>Select</td>
            <td>Enum: SEP/MEP/HÃ©lico/ULM</td>
            <td>SEP</td>
        </tr>
        <tr>
            <td>Engine Type</td>
            <td>Select</td>
            <td>Enum: Piston/Turboprop/Jet</td>
            <td>Piston</td>
        </tr>
        <tr>
            <td>Number of Engines</td>
            <td>Number</td>
            <td>Min: 1, Max: 4</td>
            <td>1</td>
        </tr>
        <tr>
            <td>Number of Seats</td>
            <td>Number</td>
            <td>Min: 1, Max: 19</td>
            <td>4</td>
        </tr>
        <tr>
            <td>Fuel Type</td>
            <td>Select</td>
            <td>Enum: AVGAS100LL/JetA1/Diesel</td>
            <td>AVGAS 100LL</td>
        </tr>
        <tr>
            <td>Fuel Capacity</td>
            <td>Number</td>
            <td>Required, > 0</td>
            <td>114 L</td>
        </tr>
        <tr>
            <td>Usable Fuel</td>
            <td>Number</td>
            <td>Required, < capacity</td>
            <td>110 L</td>
        </tr>
        <tr>
            <td>Fuel Consumption</td>
            <td>Number</td>
            <td>Required, > 0</td>
            <td>24 L/h</td>
        </tr>
        <tr>
            <td>Cruise Speed</td>
            <td>Number</td>
            <td>Required, > 0</td>
            <td>125 kt</td>
        </tr>
    </tbody>
</table>

<h4>Upload MANEX (Manuel de Vol)</h4>

<pre><code>// Gestion upload PDF
const handleManexUpload = async (e) => {
  const file = e.target.files[0];

  // Validation
  if (!file.type === 'application/pdf') {
    alert('Format PDF uniquement');
    return;
  }

  if (file.size > 50 * 1024 * 1024) {
    alert('Fichier trop volumineux (max 50MB)');
    return;
  }

  // Conversion base64 pour localStorage
  const reader = new FileReader();
  reader.onloadend = () => {
    const manexData = {
      fileName: file.name,
      fileSize: `${(file.size / 1024 / 1024).toFixed(2)} MB`,
      uploadDate: new Date().toISOString(),
      file: reader.result // Base64
    };

    updateData('manex', manexData);
  };
  reader.readAsDataURL(file);
};

// Upload vers Supabase Storage (optionnel)
const handleUploadToSupabase = async () => {
  // Convertir base64 â†’ Blob
  const base64 = aircraftData.manex.file.split(',')[1];
  const blob = await fetch(`data:application/pdf;base64,${base64}`).then(r => r.blob());

  // Upload via service
  const { filePath, publicUrl } = await communityService.uploadManex(
    blob,
    aircraftData.registration
  );

  // Stocker rÃ©fÃ©rence
  updateData('manex.remoteUrl', publicUrl);
  updateData('manex.filePath', filePath);
};
</code></pre>

<h3 id="aircraft-step2">3.1.2 Step 2 - Speeds (Vitesses CaractÃ©ristiques)</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step2Speeds.jsx</code> (600+ lignes)<br>
    <strong>Objectif:</strong> Configurer toutes les V-speeds et limitations de vent<br>
    <strong>DonnÃ©es collectÃ©es:</strong> 15+ vitesses + limitations vent dynamiques
</div>

<h4>CatÃ©gories de Vitesses</h4>

<table>
    <thead>
        <tr>
            <th>CatÃ©gorie</th>
            <th>Vitesses</th>
            <th>Obligatoire</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Flaps Out (Volets sortis)</strong></td>
            <td>Vso, Vs1, Vfe</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td><strong>Clean Config (Lisse)</strong></td>
            <td>Vs, Vy, Vx, Vr, V2</td>
            <td>âœ… Vs, âš ï¸ autres optionnels</td>
        </tr>
        <tr>
            <td><strong>Vne/Vno (Ne Exceed)</strong></td>
            <td>Vne, Vno</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td><strong>Vo (Operating Range)</strong></td>
            <td>Plages par masse</td>
            <td>âš ï¸ Optionnel</td>
        </tr>
        <tr>
            <td><strong>Optional Speeds</strong></td>
            <td>Va, Vg, Vmc, etc.</td>
            <td>âŒ Non</td>
        </tr>
    </tbody>
</table>

<h4>Plages Vo Dynamiques (Par Masse)</h4>

<pre><code>// Structure plages Vo
const voRanges = [
  {
    minWeight: 840,  // kg
    maxWeight: 1150, // kg
    speed: 111,      // kt
    saved: true
  },
  // Peut ajouter plusieurs plages
];

// Gestion plages multiples
const addVoRange = () => {
  setVoRanges([...voRanges, {
    minWeight: '',
    maxWeight: '',
    speed: '',
    saved: false
  }]);
};

const saveVoRange = (index) => {
  const range = voTempRanges[index];

  // Validation
  if (!range.minWeight || !range.maxWeight || !range.speed) {
    alert('Tous les champs requis');
    return;
  }

  if (parseFloat(range.minWeight) >= parseFloat(range.maxWeight)) {
    alert('Min doit Ãªtre < Max');
    return;
  }

  // Sauvegarder
  const newRanges = [...voRanges];
  newRanges[index] = { ...range, saved: true };
  setVoRanges(newRanges);
  updateData('speeds.voRanges', newRanges);
};
</code></pre>

<h4>Limitations de Vent Dynamiques</h4>

<p>Le step permet de configurer plusieurs types de limitations:</p>

<ul>
    <li><strong>Vent de travers max (maxCrosswind):</strong> Composante perpendiculaire piste</li>
    <li><strong>Vent arriÃ¨re max (maxTailwind):</strong> Composante arriÃ¨re</li>
    <li><strong>Vent travers piste mouillÃ©e (maxCrosswindWet):</strong> Condition dÃ©gradÃ©e</li>
    <li><strong>Vent travers piste contaminÃ©e (maxCrosswindIce):</strong> Neige/verglas</li>
    <li><strong>DiffÃ©rentiel de rafale max (maxGustDifferential):</strong> Ã‰cart vent moyen - rafales</li>
    <li><strong>Vent de travers dÃ©montrÃ© (maxDemonstrated):</strong> Limitation certification</li>
</ul>

<h3 id="aircraft-step3">3.1.3 Step 3 - Weight & Balance (Masse et Centrage)</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step3WeightBalance.jsx</code> (800+ lignes)<br>
    <strong>Objectif:</strong> Configurer masse Ã  vide, bras de levier, limites CG, et enveloppe graphique<br>
    <strong>DonnÃ©es collectÃ©es:</strong> Masses (4), bras (10+), enveloppe CG (points multiple)
</div>

<h4>Masses Ã  Configurer</h4>

<table>
    <thead>
        <tr>
            <th>Masse</th>
            <th>AbrÃ©viation</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Empty Weight</td>
            <td>BEW</td>
            <td>Masse Ã  vide Ã©quipÃ©e (avec huile)</td>
        </tr>
        <tr>
            <td>Max Takeoff Weight</td>
            <td>MTOW</td>
            <td>Masse maximale au dÃ©collage</td>
        </tr>
        <tr>
            <td>Max Landing Weight</td>
            <td>MLW</td>
            <td>Masse maximale Ã  l'atterrissage</td>
        </tr>
        <tr>
            <td>Max Zero Fuel Weight</td>
            <td>MZFW</td>
            <td>Masse max sans carburant</td>
        </tr>
    </tbody>
</table>

<h4>Bras de Levier (Arms)</h4>

<pre><code>// Bras de levier depuis datum (en mÃ¨tres)
arms = {
  empty: 2.18,           // Bras avion vide
  frontSeats: 2.00,      // SiÃ¨ges avant
  rearSeats: 2.90,       // SiÃ¨ges arriÃ¨re
  fuel: 2.18,            // RÃ©servoir carburant
  baggage: [             // Compartiments bagages dynamiques
    { id: 'main', arm: 3.50, maxWeight: 40 },
    { id: 'aux', arm: 3.70, maxWeight: 20 }
  ]
};

// Ajout compartiment bagages
const addBaggageCompartment = () => {
  const newCompartment = {
    id: `baggage_${Date.now()}`,
    name: 'Nouveau compartiment',
    arm: '',
    maxWeight: '',
    saved: false
  };

  setBaggageCompartments([...baggageCompartments, newCompartment]);
};
</code></pre>

<h4>Enveloppe CG (Points Multiples)</h4>

<p>L'enveloppe CG est dÃ©finie par des points (masse, CG) pour les limites avant et arriÃ¨re:</p>

<pre><code>// Enveloppe Forward (limite avant)
forwardPoints = [
  { weight: 840, cg: 2.00 },  // Masse min
  { weight: 1000, cg: 2.05 }, // Point intermÃ©diaire
  { weight: 1150, cg: 2.10 }  // Masse max
];

// Enveloppe Aft (limite arriÃ¨re)
aftPoints = [
  { weight: 840, cg: 2.45 },
  { weight: 1150, cg: 2.45 }
];

// GÃ©nÃ©ration polygone enveloppe
const generateEnvelopePolygon = () => {
  const forwardLine = forwardPoints.sort((a,b) => a.weight - b.weight);
  const aftLine = aftPoints.sort((a,b) => b.weight - a.weight); // Reverse

  return [...forwardLine, ...aftLine];
};
</code></pre>

<h4>Graphique CG Enveloppe</h4>

<p>Le composant <code>CGEnvelopeChart</code> affiche:</p>
<ul>
    <li><strong>Axe X:</strong> Position CG (m depuis datum)</li>
    <li><strong>Axe Y:</strong> Masse totale (kg)</li>
    <li><strong>Polygone vert:</strong> Enveloppe autorisÃ©e</li>
    <li><strong>Points Ã©ditables:</strong> Drag & drop pour ajuster limites</li>
    <li><strong>Lignes MTOW/MZFW:</strong> Limites horizontales rouges</li>
</ul>

<h3 id="aircraft-step4">3.1.4 Step 4 - Performance (Abaques Interactifs)</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step4Performance.jsx</code> (600+ lignes)<br>
    <strong>Objectif:</strong> Digitaliser abaques performances via IA (OpenAI Vision) ou saisie manuelle<br>
    <strong>Sous-composants:</strong> AdvancedPerformanceAnalyzer, AbacBuilderWrapper, PerformanceWizard
</div>

<h4>Workflow de Digitalisation</h4>

<pre><code>// Ã‰tape 1: Upload pages MANEX
const handleManexPagesUpload = async (files) => {
  const pages = [];

  for (let file of files) {
    const reader = new FileReader();
    reader.onloadend = () => {
      pages.push({
        fileName: file.name,
        image: reader.result, // Base64
        pageNumber: pages.length + 1
      });
    };
    reader.readAsDataURL(file);
  }

  setManexPages(pages);
};

// Ã‰tape 2: Extraction IA via OpenAI Vision
const extractPerformanceTable = async (pageImage) => {
  const response = await openaiService.analyzePerformanceTable({
    image: pageImage,
    prompt: `Extract performance table data.
    Identify:
    - Table title
    - Column headers
    - Row headers
    - All numeric values
    - Units
    Return as structured JSON.`
  });

  const parsedData = JSON.parse(response.content);

  return {
    title: parsedData.title,
    type: detectTableType(parsedData), // takeoff/landing/climb/cruise
    inputVariables: parsedData.columnHeaders,
    outputVariable: parsedData.rowHeaders[0],
    data: parsedData.values
  };
};

// Ã‰tape 3: CrÃ©ation abaque interactif
const createAbaque = (tableData) => {
  return {
    id: uuidv4(),
    type: 'abaque', // vs 'table'
    category: tableData.type,
    name: tableData.title,
    inputAxes: tableData.inputVariables.map(v => ({
      name: v,
      unit: extractUnit(v),
      min: Math.min(...tableData.data.map(r => r[v])),
      max: Math.max(...tableData.data.map(r => r[v]))
    })),
    outputAxis: {
      name: tableData.outputVariable,
      unit: extractUnit(tableData.outputVariable)
    },
    dataPoints: tableData.data
  };
};
</code></pre>

<h4>Types d'Abaques SupportÃ©s</h4>

<table>
    <thead>
        <tr>
            <th>Type</th>
            <th>Variables EntrÃ©e</th>
            <th>Variable Sortie</th>
            <th>Exemple</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Takeoff Distance</td>
            <td>Masse, TempÃ©rature, Altitude PA</td>
            <td>Distance (m)</td>
            <td>TO ground roll vs weight</td>
        </tr>
        <tr>
            <td>Landing Distance</td>
            <td>Masse, Vent, Altitude PA</td>
            <td>Distance (m)</td>
            <td>LDG distance vs weight</td>
        </tr>
        <tr>
            <td>Climb Performance</td>
            <td>Masse, Altitude PA</td>
            <td>Rate of climb (ft/min)</td>
            <td>Climb rate vs altitude</td>
        </tr>
        <tr>
            <td>Cruise Performance</td>
            <td>Altitude, RPM/Power</td>
            <td>TAS (kt), Fuel flow (L/h)</td>
            <td>Cruise chart</td>
        </tr>
        <tr>
            <td>V-speeds vs Weight</td>
            <td>Masse</td>
            <td>Vr, V2, Vref (kt)</td>
            <td>Vspeeds by weight</td>
        </tr>
    </tbody>
</table>

<h4>Interpolation 2D/3D</h4>

<p>Les abaques sont utilisÃ©s pour interpoler les performances en conditions rÃ©elles:</p>

<pre><code>// Interpolation linÃ©aire 1D
const interpolate1D = (x, points) => {
  const sorted = points.sort((a,b) => a.x - b.x);

  for (let i = 0; i < sorted.length - 1; i++) {
    if (x >= sorted[i].x && x <= sorted[i+1].x) {
      const ratio = (x - sorted[i].x) / (sorted[i+1].x - sorted[i].x);
      return sorted[i].y + ratio * (sorted[i+1].y - sorted[i].y);
    }
  }
};

// Interpolation bilinÃ©aire 2D (masse + tempÃ©rature)
const interpolate2D = (weight, temp, grid) => {
  // Trouver carrÃ© englobant
  const w1 = findLower(weight, grid.weights);
  const w2 = findUpper(weight, grid.weights);
  const t1 = findLower(temp, grid.temps);
  const t2 = findUpper(temp, grid.temps);

  // Interpoler les 4 coins
  const v11 = grid.get(w1, t1);
  const v12 = grid.get(w1, t2);
  const v21 = grid.get(w2, t1);
  const v22 = grid.get(w2, t2);

  // Interpolation X
  const vt1 = v11 + (weight - w1) / (w2 - w1) * (v21 - v11);
  const vt2 = v12 + (weight - w1) / (w2 - w1) * (v22 - v12);

  // Interpolation Y
  return vt1 + (temp - t1) / (t2 - t1) * (vt2 - vt1);
};
</code></pre>

<h3>RÃ©sumÃ© des 4 Ã©tapes restantes (Steps 5-7)</h3>

<p>Par souci de concision, voici un rÃ©sumÃ© des Ã©tapes suivantes:</p>

<table>
    <thead>
        <tr>
            <th>#</th>
            <th>Ã‰tape</th>
            <th>Composant</th>
            <th>DonnÃ©es Principales</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>5</td>
            <td>Equipment (Ã‰quipements)</td>
            <td><code>Step5Equipment.jsx</code></td>
            <td>COM (VHF1/2, 8.33kHz), NAV (VOR, DME, GNSS, ADF), Instruments, Autopilot</td>
        </tr>
        <tr>
            <td>6</td>
            <td>Operations (OpÃ©rations)</td>
            <td><code>Step6Operations.jsx</code></td>
            <td>Type opÃ©rations (PPL/CPL), IFR capable, Special approvals (RVSM, ETOPS)</td>
        </tr>
        <tr>
            <td>7</td>
            <td>Remarks (Remarques)</td>
            <td><code>Step7Remarks.jsx</code></td>
            <td>Textarea libre pour notes pilote, particularitÃ©s avion</td>
        </tr>
        <tr>
            <td>8</td>
            <td>Review (VÃ©rification)</td>
            <td><code>Step5Review.jsx</code></td>
            <td>RÃ©capitulatif complet, validation, sauvegarde IndexedDB + upload Supabase optionnel</td>
        </tr>
    </tbody>
</table>

<div class="page-break"></div>

<h2 id="assistant-flight">3.2 Assistant de PrÃ©paration de Vol (7 Ã‰tapes)</h2>

<div class="info-box">
    <strong>ğŸ“‚ Fichier principal:</strong> <code>src/features/flight-wizard/FlightPlanWizard.jsx</code> (950 lignes)<br>
    <strong>ğŸ¯ Objectif:</strong> Guider la prÃ©paration complÃ¨te d'un vol avec route, mÃ©tÃ©o, carburant, masse, performances<br>
    <strong>ğŸ’¾ Persistance:</strong> Brouillon localStorage + Final Supabase + PDF Storage
</div>

<h3 id="flight-step1">3.2.1 Step 1 - Informations GÃ©nÃ©rales</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step1GeneralInfo.jsx</code><br>
    <strong>Objectif:</strong> SÃ©lection avion, callsign, date/heure vol, type de vol<br>
    <strong>DonnÃ©es collectÃ©es:</strong> Aircraft, callsign, date, heure dÃ©part, type vol (VFR/IFR), jour/nuit
</div>

<h4>SÃ©lection Avion</h4>

<pre><code>// Chargement avions disponibles
const loadAircraft = async () => {
  // 1. Charger depuis IndexedDB (avions locaux)
  const localAircraft = await dataBackupManager.getAllAircraft();

  // 2. Charger depuis Supabase (avions partagÃ©s)
  const communityAircraft = await communityService.getAllPresets();

  // 3. Fusionner et dÃ©dupliquer
  const merged = [...localAircraft, ...communityAircraft];
  const unique = merged.filter((v, i, a) =>
    a.findIndex(t => t.registration === v.registration) === i
  );

  setAvailableAircraft(unique);
};

// SÃ©lection avion â†’ Chargement complet
const handleAircraftSelect = async (registration) => {
  const fullAircraft = await dataBackupManager.getAircraftData(registration);

  // Mettre Ã  jour contexte global
  setSelectedAircraft(fullAircraft);

  // PrÃ©-remplir donnÃ©es vol
  flightPlan.aircraft = fullAircraft;
  flightPlan.generalInfo.fuelCapacity = fullAircraft.fuelCapacity;
};
</code></pre>

<h4>Validation Date/Heure</h4>

<ul>
    <li><strong>Date vol:</strong> Ne peut pas Ãªtre dans le passÃ© (> aujourd'hui)</li>
    <li><strong>Heure dÃ©part:</strong> Format HH:MM (Zulu ou Local selon prÃ©fÃ©rence)</li>
    <li><strong>Type vol:</strong> VFR (Visual) ou IFR (Instrument)</li>
    <li><strong>Jour/Nuit:</strong> Auto-calculÃ© selon heure + position soleil (SunCalc)</li>
</ul>

<h3 id="flight-step2">3.2.2 Step 2 - DÃ©finition Trajet et DÃ©routements</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step3Route.jsx</code> (800+ lignes)<br>
    <strong>Objectif:</strong> Construire route complÃ¨te avec waypoints, altitudes, TOD, et sÃ©lectionner alternates<br>
    <strong>Sous-modules:</strong> NavigationModule, AlternatesModule (mode wizard)
</div>

<h4>Construction Route</h4>

<pre><code>// Ajout waypoint
const addWaypoint = (waypoint) => {
  const newWaypoints = [...flightPlan.route.waypoints, waypoint];

  // Recalculer navigation automatiquement
  const results = calculateNavigationResults(newWaypoints, aircraft);

  flightPlan.route.waypoints = newWaypoints;
  flightPlan.navigation.results = results;
  flightPlan.navigation.legs = results.legs;
};

// Calcul TOD (Top of Descent)
const calculateTOD = () => {
  const destination = waypoints[waypoints.length - 1];
  const cruiseAlt = flightPlan.route.plannedAltitude;
  const targetAlt = destination.elevation + 1000; // Pattern altitude

  const altToDescent = cruiseAlt - targetAlt;
  const descentRate = 500; // ft/min standard
  const groundSpeed = aircraft.cruiseSpeed;

  const descentTime = altToDescent / descentRate; // minutes
  const distanceToTOD = (descentTime / 60) * groundSpeed; // NM

  return {
    altitudeToDescent: altToDescent,
    descentTime: descentTime,
    distanceToTOD: distanceToTOD.toFixed(1),
    descentAngle: Math.atan((altToDescent/6076.12) / distanceToTOD) * 180 / Math.PI
  };
};
</code></pre>

<h4>SÃ©lection Alternates</h4>

<p>Le composant <code>AlternatesModule</code> est intÃ©grÃ© en mode wizard:</p>

<ul>
    <li><strong>Rayon de recherche:</strong> CalculÃ© automatiquement selon carburant disponible</li>
    <li><strong>Suggestions:</strong> AÃ©rodromes triÃ©s par score (distance, piste, Ã©quipements, mÃ©tÃ©o)</li>
    <li><strong>Carte interactive:</strong> Cercle de recherche + markers alternates</li>
    <li><strong>Validation:</strong> Au moins 1 alternate recommandÃ© (VFR) ou 2 (IFR)</li>
</ul>

<h3 id="flight-step3">3.2.3 Step 3 - AÃ©rodromes et MÃ©tÃ©o</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step3VAC.jsx</code><br>
    <strong>Objectif:</strong> TÃ©lÃ©charger VAC, consulter mÃ©tÃ©o, vÃ©rifier frÃ©quences<br>
    <strong>Sous-modules:</strong> VACModule, WeatherModule (mode wizard)
</div>

<h4>TÃ©lÃ©chargement VAC Automatique</h4>

<pre><code>// Auto-tÃ©lÃ©chargement pour tous les aÃ©rodromes de la route
useEffect(() => {
  const icaos = [
    ...waypoints.map(w => w.icao).filter(Boolean),
    ...selectedAlternates.map(a => a.icao)
  ];

  icaos.forEach(async (icao) => {
    // VÃ©rifier si dÃ©jÃ  en cache
    const cached = await vacStore.getVAC(icao);

    if (!cached || !isValid(cached)) {
      // TÃ©lÃ©charger depuis SIA
      await vacService.downloadVAC(icao);
    }
  });
}, [waypoints, selectedAlternates]);
</code></pre>

<h4>RÃ©cupÃ©ration MÃ©tÃ©o</h4>

<p>Le module Weather est intÃ©grÃ© et charge automatiquement:</p>

<ul>
    <li><strong>METAR/TAF dÃ©part:</strong> Conditions actuelles + prÃ©visions</li>
    <li><strong>METAR/TAF arrivÃ©e:</strong> Conditions destination</li>
    <li><strong>METAR alternates:</strong> MÃ©tÃ©o dÃ©routements</li>
    <li><strong>Cache 30 min:</strong> Ã‰vite appels API redondants</li>
</ul>

<h3 id="flight-step4">3.2.4 Step 4 - Bilan Carburant</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step5Fuel.jsx</code><br>
    <strong>Objectif:</strong> Calculer carburant requis et dÃ©finir FOB (Fuel On Board)<br>
    <strong>Sous-module:</strong> FuelModule (mode wizard)
</div>

<h4>Calcul Automatique des 7 Postes</h4>

<p>Le module Fuel calcule automatiquement:</p>

<table>
    <thead>
        <tr>
            <th>Poste</th>
            <th>Calcul Automatique</th>
            <th>Ã‰ditable</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Roulage</td>
            <td>5L par dÃ©faut</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td>Trip</td>
            <td><code>navigationResults.fuelRequired</code></td>
            <td>ğŸ”’ Non (auto)</td>
        </tr>
        <tr>
            <td>Contingency</td>
            <td><code>trip Ã— 0.05</code> (5% rÃ©glementaire)</td>
            <td>âœ… Oui (min 5%)</td>
        </tr>
        <tr>
            <td>Alternate</td>
            <td><code>maxDistanceAlternate / GS Ã— flow</code></td>
            <td>ğŸ”’ Non (auto)</td>
        </tr>
        <tr>
            <td>Final Reserve</td>
            <td><code>(30/60) Ã— fuelConsumption</code></td>
            <td>âœ… Oui (min 30min)</td>
        </tr>
        <tr>
            <td>Additional</td>
            <td>0L par dÃ©faut</td>
            <td>âœ… Oui</td>
        </tr>
        <tr>
            <td>Extra</td>
            <td>0L par dÃ©faut</td>
            <td>âœ… Oui</td>
        </tr>
    </tbody>
</table>

<h4>Validation FOB</h4>

<pre><code>// Calcul FOB requis
const calculateRequiredFOB = () => {
  return fuelData.roulage.ltr +
         fuelData.trip.ltr +
         fuelData.contingency.ltr +
         fuelData.alternate.ltr +
         fuelData.finalReserve.ltr +
         fuelData.additional.ltr;
};

// VÃ©rification suffisance
const isFobSufficient = () => {
  const required = calculateRequiredFOB();
  const available = fobFuel.ltr;

  if (available < required) {
    return {
      status: 'insufficient',
      message: `Manque ${(required - available).toFixed(1)} L`,
      color: 'red'
    };
  }

  if (available < required * 1.1) {
    return {
      status: 'minimal',
      message: 'RÃ©serves minimales',
      color: 'orange'
    };
  }

  return {
    status: 'sufficient',
    message: `Marge: ${(available - required).toFixed(1)} L`,
    color: 'green'
  };
};
</code></pre>

<h3 id="flight-step5">3.2.5 Step 5 - Masse et Centrage</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step6WeightBalance.jsx</code><br>
    <strong>Objectif:</strong> DÃ©finir chargement et vÃ©rifier CG dans enveloppe (3 scÃ©narios)<br>
    <strong>Sous-module:</strong> WeightBalanceModule (mode wizard)
</div>

<h4>Synchronisation Carburant</h4>

<p>Le module Ã©coute automatiquement le FOB dÃ©fini Ã  l'Ã©tape prÃ©cÃ©dente:</p>

<pre><code>// Auto-sync FOB â†’ calculs masse et centrage
useEffect(() => {
  if (flightPlan.fuel.fob) {
    // Mettre Ã  jour carburant dans calculs
    setFobFuel(flightPlan.fuel.fob);

    // Recalculer les 3 scÃ©narios
    const scenarios = calculateScenarios(
      aircraft,
      loads,
      flightPlan.fuel.fob,
      flightPlan.fuel.breakdown
    );

    flightPlan.weightBalance.scenarios = scenarios;
  }
}, [flightPlan.fuel.fob]);
</code></pre>

<h4>Validation 3 ScÃ©narios</h4>

<p>Le wizard bloque si un des 3 scÃ©narios est hors enveloppe:</p>

<ul>
    <li>âŒ <strong>Ramp hors enveloppe:</strong> "CG trop avant/arriÃ¨re au parking"</li>
    <li>âŒ <strong>Takeoff hors enveloppe:</strong> "CG trop avant/arriÃ¨re au dÃ©collage"</li>
    <li>âŒ <strong>Landing hors enveloppe:</strong> "CG trop avant/arriÃ¨re Ã  l'atterrissage (critique!)"</li>
    <li>âŒ <strong>MTOW dÃ©passÃ©e:</strong> "Masse supÃ©rieure Ã  MTOW"</li>
</ul>

<h3 id="flight-step6">3.2.6 Step 6 - Performances DÃ©collage/Atterrissage</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step5Performance.jsx</code><br>
    <strong>Objectif:</strong> Calculer distances TO/LDG et vÃ©rifier compatibilitÃ© pistes<br>
    <strong>Sous-module:</strong> PerformanceModule (mode wizard)
</div>

<h4>Calculs Automatiques</h4>

<p>Le module utilise:</p>

<ul>
    <li><strong>Masse totale:</strong> Depuis Step 5 (Weight & Balance)</li>
    <li><strong>QNH + TempÃ©rature:</strong> Depuis Step 3 (MÃ©tÃ©o)</li>
    <li><strong>Vent:</strong> Depuis METAR pour calculer composantes</li>
    <li><strong>Abaques avion:</strong> Depuis aircraft.performanceTables</li>
</ul>

<h4>Suggestion Piste Optimale</h4>

<pre><code>// Analyse toutes les pistes et recommande la meilleure
const analyzeBestRunway = (airport, wind, requiredDistance) => {
  return airport.runways.map(rwy => {
    // Composantes vent
    const headwind = calculateHeadwind(wind, rwy.qfu);
    const crosswind = calculateCrosswind(wind, rwy.qfu);

    // Score
    let score = 0;
    score += headwind; // +1 par kt headwind
    score -= tailwind * 2; // -2 par kt tailwind (pÃ©nalitÃ©)
    score += (rwy.length > requiredDistance) ? 10 : -50;

    return {
      ...rwy,
      headwind,
      crosswind,
      tailwind,
      score,
      recommendation: score > 0 ? 'good' : 'poor'
    };
  }).sort((a, b) => b.score - a.score);
};
</code></pre>

<h3 id="flight-step7">3.2.7 Step 7 - SynthÃ¨se et Validation</h3>

<div class="info-box">
    <strong>Fichier:</strong> <code>Step7Summary.jsx</code> (1200+ lignes)<br>
    <strong>Objectif:</strong> RÃ©capitulatif complet, validation finale, gÃ©nÃ©ration PDF<br>
    <strong>Actions:</strong> Sauvegarde Supabase, Upload PDF, Archivage localStorage
</div>

<h4>Sections du RÃ©capitulatif</h4>

<ol>
    <li><strong>RÃ©sumÃ© prÃ©paration:</strong> Callsign, date, avion, route (FROM-TO)</li>
    <li><strong>Navigation:</strong> Tableau legs avec distance, cap, temps, carburant par segment</li>
    <li><strong>MÃ©tÃ©o (METAR):</strong> DÃ©part, arrivÃ©e, alternates avec dÃ©codage</li>
    <li><strong>Top of Descent:</strong> Position TOD, distance, angle descente</li>
    <li><strong>Performances TO/LDG:</strong> Distances calculÃ©es, pistes recommandÃ©es</li>
    <li><strong>Bilan Carburant:</strong> Tableau 7 postes + FOB + validation</li>
    <li><strong>Masse et Centrage:</strong> 3 scÃ©narios avec validation enveloppe</li>
    <li><strong>Informations AÃ©rodromes (VAC):</strong> Pistes, frÃ©quences, points VFR</li>
</ol>

<h4>GÃ©nÃ©ration PDF</h4>

<pre><code>const generateFlightPlanPDF = async () => {
  // 1. CrÃ©er HTML complet
  const pdfContent = document.getElementById('summary-content');

  // 2. GÃ©nÃ©rer PDF avec html2pdf
  const pdfBlob = await html2pdf()
    .from(pdfContent)
    .set({
      margin: [10, 10, 10, 10],
      filename: `${callsign}_${date}.pdf`,
      html2canvas: { scale: 2, useCORS: true },
      jsPDF: {
        orientation: 'portrait',
        unit: 'mm',
        format: 'a4',
        compress: true
      }
    })
    .outputPdf('blob');

  // 3. Upload vers Supabase Storage
  const metadata = {
    callsign: flightPlan.generalInfo.callsign,
    flight_date: flightPlan.generalInfo.flightDate,
    pilot_name: user.email,
    departure_icao: waypoints[0].icao,
    arrival_icao: waypoints[waypoints.length-1].icao,
    aircraft_registration: aircraft.registration
  };

  await validatedPdfService.uploadValidatedPdf(pdfBlob, metadata);

  // 4. Sauvegarder plan de vol JSON dans DB
  await flightPlanSupabaseService.saveFlightPlan({
    ...flightPlan.toJSON(),
    user_id: user.id,
    status: 'validated'
  });

  // 5. Archiver localement
  const completedPlans = JSON.parse(localStorage.getItem('completedFlightPlans') || '[]');
  completedPlans.push({
    ...flightPlan.toJSON(),
    completedAt: Date.now()
  });
  localStorage.setItem('completedFlightPlans', JSON.stringify(completedPlans));

  // 6. Nettoyer brouillon
  localStorage.removeItem('flightPlanDraft');

  // 7. Ajouter au logbook automatiquement
  await logbookService.addEntry({
    date: flightPlan.generalInfo.flightDate,
    departure: waypoints[0].icao,
    arrival: waypoints[waypoints.length-1].icao,
    aircraft: aircraft.registration,
    flightTime: navigationResults.totalTime,
    landings: waypoints.filter(w => w.icao).length - 1,
    dayNight: flightPlan.generalInfo.dayNight,
    flightType: flightPlan.generalInfo.flightType
  });
};
</code></pre>

<div class="success-box">
    <strong>âœ¨ RÃ©sultat:</strong> Ã€ la fin du wizard, l'utilisateur dispose de:
    <ul>
        <li>âœ… Plan de vol validÃ© et conforme rÃ©glementairement</li>
        <li>âœ… PDF imprimable sauvegardÃ© dans Supabase Storage</li>
        <li>âœ… DonnÃ©es JSON complÃ¨tes dans base de donnÃ©es</li>
        <li>âœ… Archivage local pour accÃ¨s hors-ligne</li>
        <li>âœ… EntrÃ©e automatique dans le carnet de vol (logbook)</li>
    </ul>
</div>

<div class="page-break"></div>

<h1 id="project-structure">4. Structure du Projet et Fichiers ClÃ©s</h1>

<p>Cette section prÃ©sente l'ensemble des fichiers et dossiers du projet ALFlight avec leur utilitÃ© spÃ©cifique. Chaque fichier est dÃ©crit briÃ¨vement (2-3 lignes) pour faciliter la comprÃ©hension de l'architecture globale.</p>

<h2 id="project-root-files">4.1 Fichiers Racine (Configuration et Build)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>Type</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>package.json</code></td>
            <td>Config</td>
            <td>Manifeste npm avec dÃ©pendances (React 18.2, Vite 7.0.6, MUI 7.3.1, Zustand 4.5.7, Supabase, Leaflet, PDF.js, etc.). DÃ©finit les scripts de build, dev, preview. Liste 60+ packages pour un bundle final ~2.5MB gzip.</td>
        </tr>
        <tr>
            <td><code>vite.config.js</code></td>
            <td>Config</td>
            <td>Configuration Vite : alias @/, plugins PWA (VitePWA), optimizations (chunks vendor/leaflet/pdfjs), proxy API /openaip vers localhost:4001. Build output dans <code>dist/</code>.</td>
        </tr>
        <tr>
            <td><code>index.html</code></td>
            <td>HTML</td>
            <td>Point d'entrÃ©e SPA. Charge <code>src/main.jsx</code>, dÃ©finit viewport, meta tags SEO, Apple Touch Icons pour PWA, Google Fonts (Space Grotesk, Inter, JetBrains Mono).</td>
        </tr>
        <tr>
            <td><code>manifest.json</code></td>
            <td>PWA</td>
            <td>Manifeste PWA : nom, icÃ´nes (192x192, 512x512, Apple Touch 180x180), couleurs thÃ¨me (#93163C bordeaux), display standalone, orientation portrait, scope /. Permet installation home screen.</td>
        </tr>
        <tr>
            <td><code>service-worker.js</code></td>
            <td>PWA</td>
            <td>Service Worker pour fonctionnement offline. Cache assets statiques, API responses (METAR/TAF, AIXM, VAC). StratÃ©gies: CacheFirst (assets), NetworkFirst (API). Workbox Background Sync pour requÃªtes hors-ligne.</td>
        </tr>
        <tr>
            <td><code>.env</code></td>
            <td>Config</td>
            <td>Variables d'environnement : VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY, VITE_CHECKWX_API_KEY, VITE_OPENAI_API_KEY. Non commitÃ© (gitignored).</td>
        </tr>
        <tr>
            <td><code>.env.example</code></td>
            <td>Template</td>
            <td>Template des variables d'environnement avec instructions pour obtenir clÃ©s API CheckWX, Supabase, OpenAI.</td>
        </tr>
        <tr>
            <td><code>eslint.config.js</code></td>
            <td>Config</td>
            <td>Configuration ESLint : rÃ¨gles React (hooks, props), recommandations ES6+, exclusions (node_modules, dist). Lint avant commit via husky.</td>
        </tr>
        <tr>
            <td><code>jsconfig.json</code></td>
            <td>Config</td>
            <td>Configuration VS Code : alias @/ vers src/, target ES2020, jsx preserve. AutocomplÃ©tion imports absolus (@/features/..., @/utils/...).</td>
        </tr>
        <tr>
            <td><code>README.md</code></td>
            <td>Doc</td>
            <td>Documentation principale : prÃ©sentation projet, stack tech (React/Vite/MUI), installation (npm install), dÃ©marrage (npm run dev), build (npm run build), architecture 11 modules.</td>
        </tr>
        <tr>
            <td><code>SPECIFICATION_TECHNIQUE_ALFLIGHT.html</code></td>
            <td>Doc</td>
            <td>SpÃ©cification technique complÃ¨te (ce document). HTML standalone ~4200+ lignes avec analyse exhaustive architecture, modules, code, Ã©quations performances, roadmap. Convertible en .docx.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-src">4.2 Dossier src/ (Code Source Principal)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier/Dossier</th>
            <th>Type</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>src/main.jsx</code></td>
            <td>Entry</td>
            <td>Point d'entrÃ©e React : initialise ReactDOM.createRoot(), wrappe App avec ThemeProvider (MUI), Supabase session check, error boundaries. Charge fonts Google, CSS global, tokens design system.</td>
        </tr>
        <tr>
            <td><code>src/App.jsx</code></td>
            <td>Root</td>
            <td>Composant racine : routing (React Router), layout global (AppLayout avec Navbar, Sidebar, Footer), authentification Supabase (LoginPage/Dashboard), gestion states globaux (Zustand stores). ~400 lignes.</td>
        </tr>
        <tr>
            <td><code>src/index.css</code></td>
            <td>Styles</td>
            <td>Styles globaux CSS : reset, variables CSS (--color-primary, --spacing-md), animations (@keyframes fadeIn, slideIn), utilitaires (.text-center, .mt-4), print styles (@media print).</td>
        </tr>
    </tbody>
</table>

<h2 id="project-features">4.3 Dossier src/features/ (Modules Fonctionnels)</h2>

<p>Chaque module suit architecture : <code>components/</code> (UI), <code>hooks/</code> (logique mÃ©tier), <code>services/</code> (API), <code>stores/</code> (Zustand state), <code>utils/</code> (helpers), <code>index.js</code> (exports).</p>

<table>
    <thead>
        <tr>
            <th>Module</th>
            <th>Fichiers ClÃ©s</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>aircraft/</strong></td>
            <td>
                <code>AircraftModule.jsx</code> (800 lignes)<br>
                <code>AircraftWizard.jsx</code> (8 steps)<br>
                <code>performanceCharts.js</code>
            </td>
            <td>Gestion complÃ¨te avions : CRUD, wizard crÃ©ation 8 Ã©tapes (infos gÃ©nÃ©rales, limites, masses/CG, performances MANEX, configs, checklist, Ã©quipements, synthÃ¨se). Upload PDF MANEX, extraction abaques (IA GPT-4 Vision), stockage IndexedDB. ~3500 lignes total.</td>
        </tr>
        <tr>
            <td><strong>navigation/</strong></td>
            <td>
                <code>NavigationModule.jsx</code> (1200 lignes)<br>
                <code>RouteMapView.jsx</code> (Leaflet)<br>
                <code>WaypointSelector.jsx</code>
            </td>
            <td>Planification route VFR : sÃ©lection waypoints (aÃ©rodromes ICAO, points VFR AIXM, coordonnÃ©es GPS), calculs heading/distance/time par segment, dÃ©tection zones dangereuses (D/P/R), affichage carte interactive Leaflet avec layers (OSM, OpenTopoMap, ESRI Satellite), export GPX/KML.</td>
        </tr>
        <tr>
            <td><strong>weather/</strong></td>
            <td>
                <code>WeatherModule.jsx</code> (750 lignes)<br>
                <code>MetarDisplay.jsx</code><br>
                <code>weatherService.js</code>
            </td>
            <td>MÃ©tÃ©o temps rÃ©el : API CheckWX pour METAR/TAF, recherche aÃ©rodromes auto-complÃ¨te (493 AD France), dÃ©codage mÃ©tÃ©o (tempÃ©rature, QNH, vent, visibilitÃ©, nuages, phÃ©nomÃ¨nes), alerts visuels (vent travers > 15kt, visi < 5km, plafond < 1500ft), cache 15 min.</td>
        </tr>
        <tr>
            <td><strong>fuel/</strong></td>
            <td>
                <code>FuelModule.jsx</code> (600 lignes)<br>
                <code>fuelStore.js</code> (Zustand)<br>
                <code>useFuelSync.js</code>
            </td>
            <td>Calculs carburant 7 positions : Roulage (5 min), Trip (navigation auto-sync), Contingency (5% trip), Alternate (auto-sync), Final Reserve (30 min), Additional (user), Extra (user). Validation FOB â‰¥ Required, alerts visuels rouge/orange/vert, export PDF fuel log.</td>
        </tr>
        <tr>
            <td><strong>performance/</strong></td>
            <td>
                <code>PerformanceModule.jsx</code> (600 lignes)<br>
                <code>PerformanceTableCalculator.jsx</code> (800)<br>
                <code>usePerformanceCalculations.js</code>
            </td>
            <td>Calculs dÃ©collage/atterrissage : interpolation abaques 2D/3D (tempÃ©rature, altitude pression, masse), facteurs correctifs (vent, pente, surface, Ã©tat piste), calculs PA = Elev + (1013-QNH)Ã—27, DA = PA + 120Ã—ISA_dev, marges sÃ©curitÃ© 33%, suggestion piste optimale (scoring vent), verdict SAFE/UNSAFE.</td>
        </tr>
        <tr>
            <td><strong>alternates/</strong></td>
            <td>
                <code>AlternatesModule.jsx</code> (500 lignes)<br>
                <code>alternatesService.js</code><br>
                <code>useAlternatesData.js</code>
            </td>
            <td>SÃ©lection terrains de dÃ©gagement : scoring intelligent (distance < 50 NM, piste > 800m, services carburant, mÃ©tÃ©o, ouverture PPR/H24), calculs fuel alternate auto, tri par pertinence, affichage carte avec rayon 50 NM, sync avec FuelModule, validation rÃ©glementaire (min 1 alternate si dest IFR).</td>
        </tr>
        <tr>
            <td><strong>weight-balance/</strong></td>
            <td>
                <code>WeightBalanceModule.jsx</code> (700 lignes)<br>
                <code>weightBalanceStore.js</code><br>
                <code>CgEnvelopeChart.jsx</code>
            </td>
            <td>Masse et centrage : saisie charges (pilote, passagers, bagages, carburant), calculs moments (masse Ã— bras de levier), 3 scÃ©narios (takeoff, landing, zero-fuel), vÃ©rification enveloppe CG graphique (React Recharts), limites MTOW/MLW/MZFW, export PDF W&B sheet, validation rÃ©glementaire.</td>
        </tr>
        <tr>
            <td><strong>vac/</strong></td>
            <td>
                <code>VACModule.jsx</code> (500 lignes)<br>
                <code>vacService.js</code><br>
                <code>VACPdfExtractor.jsx</code>
            </td>
            <td>Cartes VAC (Visual Approach Charts) : tÃ©lÃ©chargement PDF depuis SIA France (catalogue JSON 493 AD), stockage Supabase Storage + IndexedDB, visualisation PDF.js avec zoom/annotations, extraction infos piste (QFU, longueur, Ã©lÃ©vation, frÃ©quences), enrichissement navigation avec donnÃ©es VAC, proxy CORS (port 4001).</td>
        </tr>
        <tr>
            <td><strong>logbook/</strong></td>
            <td>
                <code>LogbookModule.jsx</code> (600 lignes)<br>
                <code>PilotLogbook.jsx</code><br>
                <code>logbookStore.js</code>
            </td>
            <td>Carnet de vol Ã©lectronique : saisie vols (date, dÃ©part, arrivÃ©e, immat, type vol, temps vol, atterrissages, jour/nuit, IFR/VFR), totalisations automatiques (heures totales, par type avion, par fonction PIC/DUAL/SOLO), export CSV/PDF, synchronisation Supabase (multi-devices), filtres date/avion/type, statistiques annuelles.</td>
        </tr>
        <tr>
            <td><strong>checklist/</strong></td>
            <td>
                <code>ChecklistModule.jsx</code> (500 lignes)<br>
                <code>ChecklistEditor.jsx</code><br>
                <code>checklistStore.js</code>
            </td>
            <td>Checklists personnalisables : templates par avion (Before Start, After Start, Before TO, Climb, Cruise, Descent, Before Landing, After Landing, Shutdown), Ã©diteur drag&drop items, cochage progressif en vol, sauvegarde Ã©tat, reset, export PDF checklist complÃ¨te, partage community checklists (Supabase).</td>
        </tr>
        <tr>
            <td><strong>pilot/</strong></td>
            <td>
                <code>PilotModule.jsx</code> (800 lignes)<br>
                <code>PilotInfo.jsx</code><br>
                <code>LicenseManager.jsx</code>
            </td>
            <td>Profil pilote : infos personnelles (nom, prÃ©nom, date naissance, adresse, email, tÃ©lÃ©phone), licences (PPL, LAPL, IR, CPL, ATPL) avec validitÃ©, qualifications (SEP, MEP, night, aerobatics), visite mÃ©dicale (classe 1/2, expiration), alerts renouvellement 30 jours avant expiration, export PDF pilot credentials.</td>
        </tr>
        <tr>
            <td><strong>technical-log/</strong></td>
            <td>
                <code>TechnicalLogModule.jsx</code> (128 lignes)<br>
                <code>technicalLogStore.js</code>
            </td>
            <td>Carnet technique avion : suivi maintenance (heures moteur, cellule, hÃ©lice), MEL/CDL (Minimum Equipment List), pannes reportÃ©es, interventions maintenance, AD (Airworthiness Directives) compliance, SB (Service Bulletins), alertes inspections (50h, 100h, annual), export PDF tech log.</td>
        </tr>
        <tr>
            <td><strong>regulations/</strong></td>
            <td>
                <code>RegulationsModule.jsx</code> (400 lignes)<br>
                <code>regulationsData.js</code>
            </td>
            <td>RÃ©fÃ©rences rÃ©glementaires : base de donnÃ©es rÃ¨glements aÃ©ronautiques (FCL, OPS, AIR, SERA), recherche full-text, catÃ©gories (licences, opÃ©rations, navigabilitÃ©, espace aÃ©rien), liens externes (EASA, DGAC), favoris, historique consultation.</td>
        </tr>
        <tr>
            <td><strong>flight-wizard/</strong></td>
            <td>
                <code>FlightWizard.jsx</code> (7 steps)<br>
                <code>Step1GeneralInfo.jsx</code><br>
                <code>Step7Summary.jsx</code> (1200 lignes)
            </td>
            <td>Assistant prÃ©paration vol : 7 Ã©tapes sÃ©quentielles (Infos gÃ©nÃ©rales, Route, MÃ©tÃ©o, Carburant, Performances, Masse/Centrage, SynthÃ¨se), validation rÃ©glementaire chaque Ã©tape, sauvegarde brouillon localStorage, gÃ©nÃ©ration PDF plan de vol complet, archivage Supabase, ajout automatique logbook. ~3000 lignes total.</td>
        </tr>
        <tr>
            <td><strong>account/</strong></td>
            <td>
                <code>AccountModule.jsx</code><br>
                <code>BillingModule.jsx</code><br>
                <code>SubscriptionManager.jsx</code>
            </td>
            <td>Gestion compte utilisateur : abonnement premium (10â‚¬/mois ou 100â‚¬/an), billing Stripe, prÃ©fÃ©rences (unitÃ©s m/ft, Â°C/Â°F, kg/lbs, format date), synchronisation Supabase multi-devices, export donnÃ©es personnelles (RGPD), suppression compte.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-core">4.4 Dossier src/core/ (Architecture Centrale)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>core/stores/index.js</code></td>
            <td>Index centralisÃ© des 15 stores Zustand : aircraftStore, navigationStore, weatherStore, fuelStore, performanceStore, alternatesStore, weightBalanceStore, vacStore, logbookStore, checklistStore, pilotStore, technicalLogStore, regulationsStore, flightWizardStore, accountStore. Chaque store avec persist() middleware (localStorage).</td>
        </tr>
        <tr>
            <td><code>core/contexts/AuthContext.jsx</code></td>
            <td>Context React pour authentification Supabase : session user, login/logout, password reset, email verification, role-based access (admin/premium/free), session persistence, auto-refresh token.</td>
        </tr>
        <tr>
            <td><code>core/contexts/ThemeContext.jsx</code></td>
            <td>Context React pour thÃ¨me : mode clair/sombre (detectÃ© via prefers-color-scheme), couleurs personnalisables, bordeau #93163C comme primary, persistance prÃ©fÃ©rence localStorage, switch theme dynamique.</td>
        </tr>
        <tr>
            <td><code>core/data/AeroDataProvider.js</code></td>
            <td>Provider centralisÃ© donnÃ©es aÃ©ronautiques : AIXM parsing (aÃ©rodromes, points VFR, zones aÃ©riennes), cache IndexedDB, extraction XML avec fast-xml-parser, indexation recherche rapide (Fuse.js), mise Ã  jour cycle AIRAC (tous les 28 jours).</td>
        </tr>
        <tr>
            <td><code>core/flags.js</code></td>
            <td>Feature flags : activation/dÃ©sactivation fonctionnalitÃ©s (ENABLE_VAC_UPLOAD, ENABLE_AI_MANEX, ENABLE_BILLING, ENABLE_COMMUNITY_POINTS), contrÃ´le rollout progressif, A/B testing, maintenance mode.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-utils">4.5 Dossier src/utils/ (Utilitaires et Helpers)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>utils/calculations.js</code></td>
            <td>Fonctions calculs aÃ©ronautiques : heading (cap vrai avec dÃ©clinaison magnÃ©tique), distance haversine (Great Circle), temps vol (distance/vitesse), interpolation linÃ©aire/bilinÃ©aire, conversions trigonomÃ©triques, wind components (headwind/crosswind), fuel burn rate.</td>
        </tr>
        <tr>
            <td><code>utils/conversions.js</code></td>
            <td>Conversions unitÃ©s : m â†” ft, km â†” NM, kg â†” lbs, Â°C â†” Â°F, kt â†” km/h, L â†” US gal, hPa â†” inHg, m/s â†” fpm. Fonctions rÃ©versibles avec prÃ©cision 2 dÃ©cimales.</td>
        </tr>
        <tr>
            <td><code>utils/geographicZones.js</code></td>
            <td>DÃ©tection zones gÃ©ographiques : point-in-polygon (ray casting algorithm), zones dangereuses (D/P/R), TMA/CTR, espaces aÃ©riens (A/B/C/D/E/F/G), alertes franchissement altitude transition, coordonnÃ©es DMS â†” DD.</td>
        </tr>
        <tr>
            <td><code>utils/pdfExtractors.js</code></td>
            <td>Extraction donnÃ©es PDF : PDF.js pour parsing MANEX/VAC, extraction texte avec positions, reconnaissance patterns (distances TO/LDG, V-speeds, limites), extraction images abaques, OCR lÃ©ger (Tesseract.js optionnel).</td>
        </tr>
        <tr>
            <td><code>utils/unitsConversion.js</code></td>
            <td>SystÃ¨me conversion unitÃ©s global : dÃ©tection prÃ©fÃ©rence user (m/ft), formatage affichage avec symboles (1234 ft, 376 m), parsing input utilisateur (accepte "1500 ft" ou "1500"), validation ranges.</td>
        </tr>
        <tr>
            <td><code>utils/googleSheetsLogger.js</code></td>
            <td>Logger actions Claude dans Google Sheets : tracking modifications code, commits git, build status, tests pass/fail, exports CSV automatiques pour suivi dÃ©veloppement. UtilisÃ© par scripts PowerShell.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-services">4.6 Dossier src/services/ (Services Backend)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>services/supabaseClient.js</code></td>
            <td>Client Supabase initialisÃ© : createClient(SUPABASE_URL, ANON_KEY), connexion PostgreSQL database, Storage (MANEX PDFs, VAC PDFs, avatars), Auth (email/password, OAuth Google), Realtime subscriptions (collaborative features futures).</td>
        </tr>
        <tr>
            <td><code>services/weatherService.js</code></td>
            <td>Service mÃ©tÃ©o : API CheckWX (X-API-Key header), endpoints /metar/:icao et /taf/:icao, cache 15 min (Map), retry logic (3 tentatives), fallback NOAA si CheckWX down, parsing METAR/TAF avec metar-parser-js.</td>
        </tr>
        <tr>
            <td><code>services/vacService.js</code></td>
            <td>Service VAC : tÃ©lÃ©chargement PDF SIA France via proxy CORS (port 4001), stockage Supabase Storage bucket 'vac-charts', enrichissement mÃ©tadonnÃ©es (ICAO, nom AD, date cycle AIRAC), synchronisation catalogue JSON, cleanup old cycles.</td>
        </tr>
        <tr>
            <td><code>services/dataBackupManager.js</code></td>
            <td>Gestionnaire backup donnÃ©es : export IndexedDB â†’ JSON, import/restore, synchronisation Supabase bi-directionnelle, conflict resolution (timestamp + hash), compression gzip, chiffrement AES-256 (optionnel), export RGPD compliant.</td>
        </tr>
        <tr>
            <td><code>services/updateLoggerService.js</code></td>
            <td>Service logging mises Ã  jour : tracking modifications user (aircraft, flight plans, logbook), audit trail Supabase table 'audit_logs', filtres par user/date/module, export compliance rÃ©glementaire.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-styles">4.7 Dossier src/styles/ (SystÃ¨me de Design)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>styles/tokens.js</code></td>
            <td>Design tokens centralisÃ©s : colors (primary bordeaux #93163C, secondary, success, warning, error, info), spacing (xs/sm/md/lg/xl), shadows (sm/md/lg/button/modal), borderRadius, typography (fontFamily Space Grotesk, fontSize, fontWeight), gradients, transitions, zIndex, breakpoints, animations. ~330 lignes.</td>
        </tr>
        <tr>
            <td><code>styles/muiTheme.js</code></td>
            <td>ThÃ¨me Material-UI : palette (primary #93163C, mode light/dark auto-detect), typography (h1-h6 uppercase 700, button 600), shape (borderRadius 8px), breakpoints custom (xs:0, sm:640, md:768, lg:1024, xl:1400), components overrides (Button gradient, TextField shrink labels, Select 56px height). ~220 lignes.</td>
        </tr>
        <tr>
            <td><code>styles/theme.js</code></td>
            <td>ThÃ¨me global application : variables CSS exportÃ©es depuis tokens.js, mode sombre avec couleurs inversÃ©es, animations fadeIn/slideIn, classes utilitaires (.btn-primary, .card, .badge), media queries responsive.</td>
        </tr>
        <tr>
            <td><code>styles/unifiedDesignSystem.js</code></td>
            <td>SystÃ¨me design unifiÃ© : composants stylÃ©s rÃ©utilisables (StyledCard, StyledButton, StyledInput, StyledBadge), styled-components avec theming, variants (primary/secondary/success/warning/error), states (hover/active/disabled), accessibilitÃ© ARIA.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-server">4.8 Dossier server/ (Serveurs Node.js Backend)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>server/openaip-airspaces-proxy.js</code></td>
            <td>Proxy CORS Node.js Express port 4001 : proxifie requÃªtes vers api.openaip.net (espaces aÃ©riens), www.sia.aviation-civile.gouv.fr (VAC PDFs), ajout headers CORS, cache responses 1h, logging requests, error handling, dÃ©marrage via start-vac-proxy.bat.</td>
        </tr>
        <tr>
            <td><code>server/logging-server.js</code></td>
            <td>Serveur logging Node.js port 3002 : reÃ§oit logs frontend (POST /api/log), Ã©crit fichiers logs/app-YYYY-MM-DD.log, rotation quotidienne, filtres niveau (info/warn/error), export Sentry/LogRocket (optionnel).</td>
        </tr>
    </tbody>
</table>

<h2 id="project-scripts">4.9 Dossier scripts/ (Scripts PowerShell et Batch)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>scripts/claude-log-action.ps1</code></td>
            <td>Script PowerShell logging actions Claude dans Google Sheets : prend paramÃ¨tres -Summary, -Details, -Files, -Component, gÃ©nÃ¨re timestamp, push vers Google Sheets API, tracking dÃ©veloppement complet. AppelÃ© systÃ©matiquement aprÃ¨s chaque tÃ¢che complÃ©tÃ©e.</td>
        </tr>
        <tr>
            <td><code>scripts/create-alflight-presentation.ps1</code></td>
            <td>GÃ©nÃ©ration automatique PowerPoint : crÃ©e prÃ©sentation 12 slides ALFlight (titre, problÃ©matique, solution, modules, architecture, business model, roadmap, UI/UX, conclusion), styles bordeaux #93163C, export ALFlight_Presentation.pptx. ~545 lignes PowerShell COM automation.</td>
        </tr>
        <tr>
            <td><code>scripts/create-flight-plans-table.bat</code></td>
            <td>Script Batch crÃ©ation table Supabase : execute SQL creation table flight_plans (id, user_id, departure_icao, arrival_icao, waypoints JSONB, fuel_data JSONB, performance_data JSONB, created_at, updated_at), indexes, RLS policies.</td>
        </tr>
        <tr>
            <td><code>start-all.bat</code></td>
            <td>Lanceur global : dÃ©marre 3 serveurs en parallÃ¨le (npm run dev port 3001, openaip-proxy port 4001, logging-server port 3002), ouvre navigateur http://localhost:3001, logs consolidÃ©s, arrÃªt propre Ctrl+C.</td>
        </tr>
        <tr>
            <td><code>start-vac-proxy.bat</code></td>
            <td>Lance uniquement proxy VAC/CORS port 4001 : node server/openaip-airspaces-proxy.js, logs dans console, arrÃªt Ctrl+C.</td>
        </tr>
        <tr>
            <td><code>clean-and-start.bat</code></td>
            <td>Nettoyage et dÃ©marrage : supprime node_modules/.vite/dist, npm install, npm run dev. Utile aprÃ¨s changements package.json ou corruption cache Vite.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-public">4.10 Dossier public/ (Assets Statiques)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier/Dossier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>public/icons/</code></td>
            <td>IcÃ´nes PWA : icon-192x192.png, icon-512x512.png (logo ALFlight bordeaux), apple-touch-icon-180x180.png (iOS), favicon.ico 32x32, maskable_icon.png (adaptive Android). Format PNG optimisÃ©, compression ImageOptim.</td>
        </tr>
        <tr>
            <td><code>public/data/geojson/</code></td>
            <td>Fichiers GeoJSON espaces aÃ©riens France : french_airspaces.geojson (TMA/CTR/D/P/R), vfr_points.geojson (points VFR AIXM), danger_zones.geojson (zones dangereuses). Source : SIA France + OpenAIP. ~15 MB total.</td>
        </tr>
        <tr>
            <td><code>public/data/airports/</code></td>
            <td>Base de donnÃ©es aÃ©rodromes : french_airports.json (493 AD France avec ICAO, nom, lat/lon, Ã©lÃ©vation, pistes, frÃ©quences), european_airports.json (2500+ AD Europe), runway_data.json (QFU, longueur, surface, pente). ~3 MB JSON.</td>
        </tr>
        <tr>
            <td><code>public/data/aixm/</code></td>
            <td>DonnÃ©es AIXM SIA : AIXM4.5_all_FR_OM_2025-10-02.xml (42 MB), XML_SIA_2025-10-02.xml (27 MB), cycle AIRAC 10/2025. Contient aÃ©rodromes, points VFR, zones, obstacles, procÃ©dures. Parser fast-xml-parser cÃ´tÃ© client.</td>
        </tr>
        <tr>
            <td><code>public/aircraft-presets/</code></td>
            <td>Presets avions communautaires : da40ng-f-hstr-example.json (Diamond DA40 NG complet avec performances), c172sp-example.json (Cessna 172SP), pa28-example.json (Piper PA-28). Chargement wizard via "Importer preset".</td>
        </tr>
    </tbody>
</table>

<h2 id="project-data">4.11 Dossier src/data/ (DonnÃ©es Statiques EmbarquÃ©es)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>data/frenchAirspaces.js</code></td>
            <td>Export JavaScript espaces aÃ©riens France : array objets {id, name, type, class, floor, ceiling, geometry}, ~500 zones (TMA, CTR, D, P, R), utilisÃ© dÃ©tection conflits route navigation.</td>
        </tr>
        <tr>
            <td><code>data/frenchAirspacesManual.js</code></td>
            <td>Espaces aÃ©riens saisis manuellement (non AIXM) : zones spÃ©ciales (volcans volcanique, parachutisme, planeurs, ULM, manifestations aÃ©riennes), alertes temporaires, NOTAM permanents.</td>
        </tr>
        <tr>
            <td><code>data/airportNames.js</code></td>
            <td>Mapping ICAO â†’ noms complets : {'LFST': 'Strasbourg Entzheim', 'LFPO': 'Paris Orly', ...}. ~493 entrÃ©es France. UtilisÃ© autocomplete, affichage lisible.</td>
        </tr>
        <tr>
            <td><code>data/aixm.config.js</code></td>
            <td>Configuration AIXM : chemins fichiers XML, version format (4.5/5.1), date cycle AIRAC (2025-10-02), date expiration (2025-10-30), URL tÃ©lÃ©chargement SIA, validation schema XSD.</td>
        </tr>
    </tbody>
</table>

<h2 id="project-docs">4.12 Dossier docs/ (Documentation Technique)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>docs/VAC_MODULE_GUIDE.md</code></td>
            <td>Guide complet module VAC : architecture, API endpoints, stockage Supabase, proxy CORS, troubleshooting erreurs courantes (404, CORS, timeout), exemples code, schÃ©mas UML. ~200 lignes markdown.</td>
        </tr>
        <tr>
            <td><code>docs/VAC_API_GUIDE.md</code></td>
            <td>Documentation API VAC : endpoints GET /api/vac/:icao, POST /api/vac/upload, DELETE /api/vac/:id, paramÃ¨tres, responses JSON, codes erreur HTTP, rate limiting, authentification bearer token.</td>
        </tr>
        <tr>
            <td><code>ICONES_PWA_GUIDE.md</code></td>
            <td>Guide crÃ©ation icÃ´nes PWA : tailles requises (192, 512, 180 Apple), formats PNG/SVG, outils recommandÃ©s (Figma, Inkscape, ImageOptim), manifest.json configuration, test iOS/Android.</td>
        </tr>
        <tr>
            <td><code>CLAUDE_LOGGING_GUIDE.md</code></td>
            <td>Guide logging systÃ©matique : rÃ¨gle obligatoire appel claude-log-action.ps1 aprÃ¨s chaque tÃ¢che, format rÃ©sumÃ©/dÃ©tails, paramÃ¨tres requis, exemples concrets, troubleshooting Google Sheets API.</td>
        </tr>
        <tr>
            <td><code>SECTION_PERFORMANCE_ENRICHIE.md</code></td>
            <td>Documentation exhaustive module Performance : diffÃ©rence abaques/tableaux, Ã©quations (PA, interpolations, corrections), mÃ©thode A-Z crÃ©ation abaques, exemples DA40 NG, tests unitaires. ~875 lignes markdown (23 KB).</td>
        </tr>
    </tbody>
</table>

<h2 id="project-supabase">4.13 Fichiers SQL Supabase (Database Schema)</h2>

<table>
    <thead>
        <tr>
            <th>Fichier</th>
            <th>UtilitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><code>supabase-community-vfr-points.sql</code></td>
            <td>Table points VFR communautaires : CREATE TABLE community_vfr_points (id UUID, name TEXT, lat FLOAT, lon FLOAT, type TEXT, description TEXT, photos TEXT[], user_id UUID, aerodrome_icao TEXT, created_at TIMESTAMP). Index gÃ©ospatial PostGIS, RLS policies user-specific.</td>
        </tr>
        <tr>
            <td><code>supabase-flight-plans.sql</code></td>
            <td>Table plans de vol : CREATE TABLE flight_plans (id UUID, user_id UUID, departure_icao TEXT, arrival_icao TEXT, waypoints JSONB, fuel_data JSONB, performance_data JSONB, pdf_url TEXT, status TEXT, created_at, updated_at). Indexes ICAO, RLS.</td>
        </tr>
        <tr>
            <td><code>supabase-aircraft.sql</code></td>
            <td>Table avions : CREATE TABLE aircraft (id UUID, user_id UUID, registration TEXT UNIQUE, model TEXT, manex_pdf_url TEXT, performance_tables JSONB, limits JSONB, weights JSONB, cg_envelope JSONB, created_at, updated_at). RLS owner access only.</td>
        </tr>
        <tr>
            <td><code>supabase-logbook.sql</code></td>
            <td>Table carnet de vol : CREATE TABLE logbook_entries (id UUID, user_id UUID, date DATE, departure_icao TEXT, arrival_icao TEXT, aircraft_registration TEXT, flight_time INTERVAL, landings INT, day_night TEXT, ifr_vfr TEXT, pic_dual_solo TEXT). Indexes date, aircraft.</td>
        </tr>
        <tr>
            <td><code>supabase-storage-buckets.sql</code></td>
            <td>Buckets Supabase Storage : manex-pdfs (50 MB limit, private), vac-charts (10 MB limit, public read), avatars (2 MB limit, public), flight-plan-pdfs (5 MB limit, private). Policies RLS upload owner only.</td>
        </tr>
    </tbody>
</table>

<div class="success-box">
    <strong>ğŸ“Š Statistiques Projet ALFlight :</strong>
    <ul>
        <li><strong>Total fichiers sources :</strong> ~450 fichiers (.js/.jsx/.json/.css/.html/.sql/.md/.ps1/.bat)</li>
        <li><strong>Lignes de code :</strong> ~85,000 lignes (dont ~60,000 src/, ~15,000 docs/, ~10,000 config/scripts)</li>
        <li><strong>Modules fonctionnels :</strong> 14 features (aircraft, navigation, weather, fuel, performance, alternates, weight-balance, vac, logbook, checklist, pilot, technical-log, regulations, flight-wizard)</li>
        <li><strong>Stores Zustand :</strong> 15 stores avec persistence localStorage</li>
        <li><strong>Services backend :</strong> 2 serveurs Node.js (proxy CORS port 4001, logging port 3002)</li>
        <li><strong>Base de donnÃ©es :</strong> PostgreSQL Supabase (12 tables + 3 Storage buckets)</li>
        <li><strong>Bundle production :</strong> ~2.5 MB gzip (chunks vendor 1.2MB, leaflet 400KB, pdfjs 350KB, app 550KB)</li>
        <li><strong>DÃ©pendances npm :</strong> 60+ packages (React, MUI, Vite, Zustand, Supabase, Leaflet, PDF.js, etc.)</li>
        <li><strong>Formats supportÃ©s :</strong> PDF (MANEX, VAC), JSON (presets, data), XML (AIXM), GeoJSON (zones), GPX/KML (export routes)</li>
    </ul>
</div>

<div class="page-break"></div>

<h1 id="features-futures">10. Features Restant Ã  ImplÃ©menter</h1>

<p>Bien qu'ALFlight soit dÃ©jÃ  fonctionnel avec un ensemble complet de fonctionnalitÃ©s, plusieurs amÃ©liorations et nouveaux modules sont prÃ©vus pour enrichir l'expÃ©rience utilisateur.</p>

<h2 id="futures-priority-high">10.1 PrioritÃ© Haute (Court Terme - 1-3 mois)</h2>

<h3>ğŸ”¹ NOTAM Integration</h3>

<div class="info-box">
    <strong>Objectif:</strong> IntÃ©grer les NOTAM (Notices to Airmen) automatiquement dans la prÃ©paration de vol<br>
    <strong>Source donnÃ©es:</strong> API EUROCONTROL ou SIA France<br>
    <strong>Affichage:</strong> Par aÃ©rodrome (dÃ©part, arrivÃ©e, alternates) + FIR en route
</div>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Auto-fetch NOTAM pour tous les ICAOs de la route</li>
    <li>Filtrage par catÃ©gorie (piste, navigation, espace aÃ©rien, mÃ©tÃ©o)</li>
    <li>Highlighting NOTAM critiques (fermeture piste, espace aÃ©rien interdit)</li>
    <li>IntÃ©gration dans PDF final du plan de vol</li>
</ul>

<h3>ğŸ”¹ Espaces AÃ©riens en Route</h3>

<div class="info-box">
    <strong>Objectif:</strong> DÃ©tecter automatiquement les espaces aÃ©riens traversÃ©s et alerter des conflits<br>
    <strong>Source donnÃ©es:</strong> OpenAIP Airspaces (dÃ©jÃ  intÃ©grÃ© partiellement)<br>
    <strong>Algorithme:</strong> Intersection 3D (route + altitude) avec gÃ©omÃ©tries airspaces
</div>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Liste espaces traversÃ©s avec classe (A, B, C, D, E, G)</li>
    <li>Alertes conflits (TMA/CTR sans clairance, zones interdites)</li>
    <li>Suggestion altitudes pour Ã©viter espaces contrÃ´lÃ©s</li>
    <li>Affichage sur carte avec gÃ©omÃ©tries colorÃ©es</li>
</ul>

<h3>ğŸ”¹ Briefing Pilote Automatique</h3>

<div class="info-box">
    <strong>Objectif:</strong> GÃ©nÃ©rer un briefing pilote structurÃ© avec tous les Ã©lÃ©ments de sÃ©curitÃ©<br>
    <strong>Format:</strong> Checklist interactive + export PDF
</div>

<p><strong>Sections du briefing:</strong></p>
<ol>
    <li><strong>SAFETY:</strong> Urgences, procÃ©dures anormales, Ã©quipement survie</li>
    <li><strong>ROUTE:</strong> Waypoints, altitudes, caps magnÃ©tiques</li>
    <li><strong>WEATHER:</strong> METAR/TAF dÃ©codÃ©s, SIGMET, AIRMET</li>
    <li><strong>NOTAM:</strong> RÃ©sumÃ© NOTAM critiques</li>
    <li><strong>ALTERNATES:</strong> DÃ©routements avec distances et carburant</li>
    <li><strong>FUEL:</strong> Minimas rÃ©glementaires, autonomie</li>
    <li><strong>PERFORMANCE:</strong> Distances TO/LDG, marges pistes</li>
    <li><strong>WEIGHT & BALANCE:</strong> Validation CG, limites masse</li>
</ol>

<h3>ğŸ”¹ Mode Tablette/Mobile OptimisÃ©</h3>

<div class="info-box">
    <strong>Objectif:</strong> Interface adaptÃ©e pour utilisation en cockpit sur tablette/smartphone<br>
    <strong>Technologies:</strong> Capacitor (dÃ©jÃ  intÃ©grÃ©), PWA manifest, responsive design
</div>

<p><strong>AmÃ©liorations:</strong></p>
<ul>
    <li>Boutons plus larges (touch-friendly)</li>
    <li>Mode "In-Flight" avec infos essentielles agrandies</li>
    <li>Orientation paysage pour affichage carte plein Ã©cran</li>
    <li>DonnÃ©es hors-ligne complÃ¨tes (AIXM, VAC, plans validÃ©s)</li>
    <li>GPS intÃ©grÃ© pour suivi position en temps rÃ©el</li>
</ul>

<h2 id="futures-priority-medium">10.2 PrioritÃ© Moyenne (Moyen Terme - 3-6 mois)</h2>

<h3>ğŸ”¹ Partage de Vol (Social)</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Partager plan de vol avec d'autres utilisateurs (instructeur, co-pilote)</li>
    <li>Mode collaboration temps rÃ©el (planning groupe)</li>
    <li>Timeline vols complÃ©tÃ©s avec photos/notes</li>
    <li>Classement pilotes (heures de vol, destinations visitÃ©es)</li>
</ul>

<h3>ğŸ”¹ Module Costs & Budget</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Calcul coÃ»t vol (carburant + location avion + taxes)</li>
    <li>Suivi dÃ©penses par vol avec catÃ©gorisation</li>
    <li>Statistiques mensuelles/annuelles</li>
    <li>Export comptable (CSV, Excel)</li>
</ul>

<h3>ğŸ”¹ IntÃ©gration Webcams AÃ©rodromes</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Affichage webcams live des aÃ©rodromes (si disponibles)</li>
    <li>Base de donnÃ©es URLs webcams France</li>
    <li>IntÃ©gration dans module Weather</li>
</ul>

<h3>ğŸ”¹ Planning Multi-Vols</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Calendrier vols planifiÃ©s</li>
    <li>RÃ©servation avion intÃ©grÃ©e (si aÃ©ro-club compatible)</li>
    <li>Rappels automatiques (briefing mÃ©tÃ©o J-1, check avion H-2)</li>
</ul>

<h2 id="futures-priority-low">10.3 PrioritÃ© Basse (Long Terme - 6+ mois)</h2>

<h3>ğŸ”¹ Mode IFR Complet</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Planification route IFR (SID, STAR, airways)</li>
    <li>Cartes approche IFR (IAC)</li>
    <li>Calculs minimums IFR (DA, MDA)</li>
    <li>IntÃ©gration procÃ©dures d'approche</li>
</ul>

<h3>ğŸ”¹ Extension Internationale</h3>

<p><strong>Pays supportÃ©s:</strong></p>
<ul>
    <li>Europe: Allemagne, Espagne, Italie, Belgique, Suisse</li>
    <li>AIXM Europe (EUROCONTROL)</li>
    <li>Traduction multi-langues (EN, DE, ES, IT)</li>
</ul>

<h3>ğŸ”¹ Simulation Vol 3D</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Vue 3D de la route sur terrain (Three.js + DEM data)</li>
    <li>Simulation visuelle du vol avec timeline</li>
    <li>Points remarquables gÃ©ographiques en route</li>
</ul>

<h3>ğŸ”¹ IA Assistant Pilote</h3>

<p><strong>FonctionnalitÃ©s:</strong></p>
<ul>
    <li>Chatbot IA pour questions pilote (rÃ©glementation, mÃ©tÃ©o, navigation)</li>
    <li>Analyse automatique conditions vol (GO/NO-GO decision)</li>
    <li>Suggestions routes optimales (carburant, temps, coÃ»t)</li>
    <li>DÃ©tection anomalies plan de vol (CG limite, carburant juste, vent fort)</li>
</ul>

<h3>ğŸ”¹ Analyse PoussÃ©e des Cartes OACI</h3>

<h4>Vue d'ensemble</h4>

<p>Analyse intelligente et contextuelle des donnÃ©es OACI pour fournir des alertes et recommandations basÃ©es sur l'altitude de vol planifiÃ©e, la trajectoire et les rÃ©glementations spÃ©cifiques.</p>

<h4>FonctionnalitÃ©s principales</h4>

<p><strong>1. Restrictions de Survol des Villes selon Altitude</strong></p>

<ul>
    <li><strong>Base de donnÃ©es urbaines:</strong> Cartographie des agglomÃ©rations franÃ§aises avec populations</li>
    <li><strong>RÃ¨gles rÃ©glementaires:</strong> Application automatique de la rÃ©glementation franÃ§aise
        <ul>
            <li>Survol agglomÃ©ration interdit < 1000 ft AGL (sauf nÃ©cessitÃ© dÃ©collage/atterrissage)</li>
            <li>Survol rassemblement de personnes interdit < 1000 ft AGL</li>
            <li>Survol zones sensibles (centrales nuclÃ©aires, sites militaires) avec restrictions spÃ©cifiques</li>
        </ul>
    </li>
    <li><strong>Alertes contextuelles:</strong>
        <ul>
            <li>Si altitude planifiÃ©e < 1000 ft AGL â†’ alerte "Survol agglomÃ©ration interdit Ã  cette altitude"</li>
            <li>Proposition altitude minimale sÃ©curitaire (1000 ft AGL + marge)</li>
            <li>Affichage zones urbaines sur carte avec code couleur selon conformitÃ©</li>
        </ul>
    </li>
</ul>

<p><strong>2. Zones de Restriction Dynamiques</strong></p>

<ul>
    <li><strong>Espaces aÃ©riens conditionnels:</strong> Analyse des zones actives selon horaires
        <ul>
            <li>Zones militaires (activation selon NOTAM)</li>
            <li>Zones de parachutage (actives selon horaires publiÃ©s)</li>
            <li>Zones de vol Ã  voile (actives selon saison/mÃ©tÃ©o)</li>
        </ul>
    </li>
    <li><strong>Calcul intersection route/zones:</strong> DÃ©tection automatique des conflits potentiels</li>
    <li><strong>Suggestions Ã©vitement:</strong> Routes alternatives avec impact minimal (distance, carburant)</li>
</ul>

<p><strong>3. Analyse RÃ©glementaire AvancÃ©e</strong></p>

<ul>
    <li><strong>Minimas de sÃ©paration:</strong> VÃ©rification distances obstacles, terrain</li>
    <li><strong>ConformitÃ© VFR:</strong> Validation visibilitÃ© minimale, distance nuages selon classe espace aÃ©rien</li>
    <li><strong>Restrictions nocturnes:</strong> Alerte si vol de nuit sur aÃ©rodrome non Ã©quipÃ© Ã©clairage</li>
    <li><strong>Carburant rÃ©glementaire:</strong> Calcul automatique minimas selon destination (aÃ©rodrome contrÃ´lÃ©, montagne, survol maritime)</li>
</ul>

<h4>Exemple d'implÃ©mentation</h4>

<pre><code>// Analyse automatique survol agglomÃ©ration
function analyzeUrbanOverflight(flightPlan) {
  const alerts = [];

  // RÃ©cupÃ¨re toutes les agglomÃ©rations > 5000 habitants
  const urbanAreas = getUrbanAreas({ minPopulation: 5000 });

  for (const segment of flightPlan.segments) {
    // Calcul altitude AGL pour chaque point du segment
    const aglAltitude = segment.altitude - getTerrainElevation(segment.coordinates);

    // VÃ©rifie si segment traverse zone urbaine
    const intersectedCities = urbanAreas.filter(city =>
      isSegmentIntersectingPolygon(segment, city.boundary)
    );

    for (const city of intersectedCities) {
      if (aglAltitude < 1000) {
        alerts.push({
          type: 'regulatory_violation',
          severity: 'critical',
          title: `Survol ${city.name} interdit Ã  ${aglAltitude} ft AGL`,
          regulation: 'Article D131-1 du Code de l\'Aviation Civile',
          recommendation: `Altitude minimale requise: ${city.elevation + 1000} ft AMSL`,
          action: 'increase_altitude',
          suggestedAltitude: Math.ceil((city.elevation + 1000 + 500) / 100) * 100 // Arrondi au 100 ft sup
        });
      } else if (aglAltitude < 1500) {
        // Alerte warning si marge faible
        alerts.push({
          type: 'regulatory_warning',
          severity: 'warning',
          title: `Survol ${city.name} avec marge rÃ©duite (${aglAltitude} ft AGL)`,
          recommendation: `Marge conseillÃ©e: 1500 ft AGL minimum pour sÃ©curitÃ©`
        });
      }
    }
  }

  return alerts;
}
</code></pre>

<h4>IntÃ©gration Interface</h4>

<ul>
    <li><strong>Carte interactive:</strong> Overlay zones urbaines avec code couleur
        <ul>
            <li>ğŸŸ¢ Vert : Survol autorisÃ© Ã  l'altitude planifiÃ©e</li>
            <li>ğŸŸ¡ Orange : Marge rÃ©duite, vigilance requise</li>
            <li>ğŸ”´ Rouge : Survol interdit, changement altitude/route nÃ©cessaire</li>
        </ul>
    </li>
    <li><strong>Panel alertes:</strong> Liste violations rÃ©glementaires avec actions correctives</li>
    <li><strong>Mode "Compliance Check":</strong> Validation complÃ¨te conformitÃ© rÃ©glementaire avant vol</li>
</ul>

<h3>ğŸ”¹ Points Tournants Manuels pour Ã‰vitement</h3>

<h4>Vue d'ensemble</h4>

<p>Permettre au pilote d'ajouter manuellement des waypoints intermÃ©diaires (points tournants) non-significatifs dans le plan de vol pour effectuer des corrections de trajectoire et Ã©viter des zones spÃ©cifiques.</p>

<h4>Cas d'usage</h4>

<ul>
    <li><strong>Ã‰vitement mÃ©tÃ©o:</strong> Contourner un orage identifiÃ© sur la route directe</li>
    <li><strong>Ã‰vitement zones rÃ©glementÃ©es:</strong> Contourner une TMA, CTR ou zone militaire active</li>
    <li><strong>Ã‰vitement tactique:</strong> DÃ©vier pour raisons de confort (turbulences montagne, zones de vol Ã  voile actives)</li>
    <li><strong>Points de report visuels:</strong> Ajouter points de repÃ¨re visuels pour navigation VFR</li>
    <li><strong>Optimisation route:</strong> Ajuster trajectoire pour profiter de vent favorable ou Ã©viter vent contraire</li>
</ul>

<h4>FonctionnalitÃ©s</h4>

<p><strong>1. Ajout Manuel de Waypoints</strong></p>

<ul>
    <li><strong>Clic sur carte:</strong> Clic-droit sur carte â†’ "Ajouter point tournant"</li>
    <li><strong>Insertion entre waypoints:</strong> Insertion automatique entre deux waypoints existants</li>
    <li><strong>Type de waypoint:</strong>
        <ul>
            <li>ğŸ”µ <strong>Waypoint standard:</strong> AÃ©rodrome, VOR, point publiÃ©</li>
            <li>ğŸŸ£ <strong>Point tournant manuel:</strong> CoordonnÃ©es GPS arbitraires</li>
            <li>ğŸŸ¡ <strong>Point de report:</strong> RepÃ¨re visuel (chÃ¢teau d'eau, lac, route)</li>
        </ul>
    </li>
    <li><strong>Nommage automatique:</strong> "PT01", "PT02" ou nom personnalisÃ© ("Ã‰vitement Orage", "Contournement TMA Paris")</li>
</ul>

<p><strong>2. Edition Interactive</strong></p>

<ul>
    <li><strong>Drag & Drop:</strong> DÃ©placement point tournant sur carte en temps rÃ©el</li>
    <li><strong>Recalcul automatique:</strong> Mise Ã  jour distances, caps, temps de vol instantanÃ©e</li>
    <li><strong>Suppression rapide:</strong> Clic-droit â†’ "Supprimer point tournant"</li>
    <li><strong>Optimisation route:</strong> Bouton "Optimiser" pour suggÃ©rer route la plus directe possible</li>
</ul>

<p><strong>3. Annotations et Notes</strong></p>

<ul>
    <li><strong>Note par waypoint:</strong> Raison de l'Ã©vitement ("Ã‰viter TMA actif jusqu'Ã  16h", "Orage prÃ©vu Ã  14h")</li>
    <li><strong>Altitude recommandÃ©e:</strong> SpÃ©cifier altitude optimale pour ce segment</li>
    <li><strong>Heure de passage estimÃ©e:</strong> Calcul automatique ETO (Estimated Time Over)</li>
    <li><strong>FrÃ©quences radio:</strong> Attacher frÃ©quences utiles au waypoint (Info, Approche)</li>
</ul>

<h4>Exemple d'implÃ©mentation</h4>

<pre><code>// Structure waypoint manuel
interface ManualTurningPoint {
  id: string;
  type: 'manual_turning_point' | 'visual_reference';
  name: string;
  coordinates: {
    lat: number;
    lon: number;
  };
  elevation?: number;  // ft AMSL
  insertedBetween: {
    from: string;  // ID waypoint prÃ©cÃ©dent
    to: string;    // ID waypoint suivant
  };
  annotations: {
    reason?: string;  // "Ã‰vitement TMA Paris"
    suggestedAltitude?: number;  // ft
    radioFrequencies?: string[];  // ["118.25", "125.80"]
    notes?: string;
  };
  createdAt: Date;
  createdBy: 'user' | 'auto_suggestion';
}

// Fonction d'ajout de point tournant
function addManualTurningPoint(clickedCoords, insertAfterIndex) {
  const newWaypoint: ManualTurningPoint = {
    id: generateId(),
    type: 'manual_turning_point',
    name: `PT${getNextTurningPointNumber()}`,
    coordinates: clickedCoords,
    elevation: getTerrainElevation(clickedCoords),
    insertedBetween: {
      from: flightPlan.waypoints[insertAfterIndex].id,
      to: flightPlan.waypoints[insertAfterIndex + 1].id
    },
    annotations: {},
    createdAt: new Date(),
    createdBy: 'user'
  };

  // Insertion dans plan de vol
  flightPlan.waypoints.splice(insertAfterIndex + 1, 0, newWaypoint);

  // Recalcul navigation
  recalculateNavigation(flightPlan);

  // Mise Ã  jour carte
  updateMapRoute(flightPlan);

  // Afficher popup Ã©dition
  showWaypointEditPopup(newWaypoint);
}
</code></pre>

<h4>Interface Utilisateur</h4>

<p><strong>1. Carte Interactive</strong></p>

<ul>
    <li><strong>Mode Ã©dition route:</strong> Activer/dÃ©sactiver mode Ã©dition</li>
    <li><strong>Visualisation waypoints:</strong>
        <ul>
            <li>â­ Waypoints standard (aÃ©rodromes) : IcÃ´ne standard bleu</li>
            <li>âšª Points tournants manuels : Cercle violet avec numÃ©ro</li>
            <li>ğŸ“ Points de report : Marqueur jaune avec icÃ´ne Å“il</li>
        </ul>
    </li>
    <li><strong>Ligne de route:</strong>
        <ul>
            <li>Segment standard : Ligne continue bleue</li>
            <li>Segment avec point manuel : Ligne pointillÃ©e violette</li>
        </ul>
    </li>
</ul>

<p><strong>2. Panel LatÃ©ral - Liste Waypoints</strong></p>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ ROUTE DETAILS                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. â­ LFST (Strasbourg)         0 NM    â”‚
â”‚    â””â”€ 15 NM â†’ 093Â° â†’ 12 min            â”‚
â”‚ 2. âšª PT01 (Ã‰vitement TMA)     15 NM    â”‚
â”‚    ğŸ“ "Contourner TMA Paris actif"      â”‚
â”‚    âœˆï¸  Altitude recommandÃ©e: 3500 ft    â”‚
â”‚    â””â”€ 22 NM â†’ 105Â° â†’ 17 min            â”‚
â”‚ 3. ğŸ“ ChÃ¢teau d'Andlau         37 NM    â”‚
â”‚    ğŸ‘ï¸  Point de report visuel           â”‚
â”‚    â””â”€ 8 NM â†’ 118Â° â†’ 6 min              â”‚
â”‚ 4. â­ LFPO (Paris-Orly)        45 NM    â”‚
â”‚                                         â”‚
â”‚ Total: 45 NM - 35 min                   â”‚
â”‚                                         â”‚
â”‚ [+ Ajouter Point Tournant]              â”‚
â”‚ [âš™ï¸ Optimiser Route]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<p><strong>3. Popup Ã‰dition Waypoint</strong></p>

<ul>
    <li><strong>Nom:</strong> Champ texte personnalisable</li>
    <li><strong>Type:</strong> Radio buttons (Point tournant / Point de report)</li>
    <li><strong>Raison:</strong> Textarea pour notes</li>
    <li><strong>Altitude suggÃ©rÃ©e:</strong> Input numÃ©rique (ft)</li>
    <li><strong>FrÃ©quences:</strong> Liste frÃ©quences radio utiles</li>
    <li><strong>Actions:</strong> Boutons "Sauvegarder", "Supprimer", "Annuler"</li>
</ul>

<h4>Suggestions Automatiques</h4>

<p>ALFlight peut suggÃ©rer automatiquement des points tournants dans certains cas :</p>

<ul>
    <li><strong>DÃ©tection conflit espace aÃ©rien:</strong> Si route directe traverse TMA â†’ suggestion point contournement</li>
    <li><strong>Optimisation vent:</strong> Ajout waypoint pour profiter composante vent favorable</li>
    <li><strong>Ã‰vitement obstacles:</strong> Suggestion dÃ©viation si terrain Ã©levÃ© sur route (montagne)</li>
    <li><strong>Points de report VFR:</strong> Suggestions waypoints visuels Ã©vidents (lacs, villes, autoroutes)</li>
</ul>

<pre><code>// Exemple suggestion automatique
if (routeIntersectsTMA(flightPlan.route, 'LFPG_TMA')) {
  const bypassPoint = calculateOptimalBypass(flightPlan.route, 'LFPG_TMA');

  showSuggestion({
    type: 'auto_turning_point',
    title: 'Conflit TMA Paris dÃ©tectÃ©',
    message: 'Votre route traverse la TMA de Paris (Classe A). Un point de contournement est recommandÃ©.',
    suggestedWaypoint: {
      name: 'Contournement TMA Paris',
      coordinates: bypassPoint,
      reason: 'Ã‰vitement TMA Paris (Classe A - Clairance IFR requise)'
    },
    actions: [
      { label: 'Ajouter point', action: () => addWaypoint(bypassPoint) },
      { label: 'Ignorer', action: () => dismissSuggestion() },
      { label: 'Modifier altitude', action: () => showAltitudeEditor() }
    ]
  });
}
</code></pre>

<h4>Export et IntÃ©gration</h4>

<ul>
    <li><strong>Plan de vol OACI:</strong> Points tournants manuels inclus dans champ 15 (route)</li>
    <li><strong>Format GPS:</strong> Export GPX/KML avec tous waypoints (standard + manuels)</li>
    <li><strong>Log de vol:</strong> Historique modifications route avec horodatage</li>
    <li><strong>Briefing PDF:</strong> Carte avec route complÃ¨te incluant points tournants annotÃ©s</li>
</ul>

<h3>ğŸ”¹ IntÃ©gration AeroWeb et Analyse MÃ©tÃ©o AvancÃ©e</h3>

<h4>Vue d'ensemble</h4>

<p>TÃ©lÃ©chargement automatique et analyse intelligente du dossier AeroWeb (MÃ©tÃ©o France) pour fournir une planification mÃ©tÃ©orologique complÃ¨te avec calculs de temps de vol ajustÃ©s au vent et alertes mÃ©tÃ©o significatives.</p>

<h4>Sources de DonnÃ©es AeroWeb</h4>

<table>
    <thead>
        <tr>
            <th>Document</th>
            <th>Description</th>
            <th>Format</th>
            <th>FrÃ©quence Mise Ã  Jour</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>WINTEM (Wind/Temp)</strong></td>
            <td>Carte des vents et tempÃ©ratures en altitude (FL050, FL100, FL180, FL240)</td>
            <td>PDF/Image</td>
            <td>4 fois/jour (00h, 06h, 12h, 18h UTC)</td>
        </tr>
        <tr>
            <td><strong>TEMSI</strong></td>
            <td>Carte Temps Significatif France (phÃ©nomÃ¨nes mÃ©tÃ©o, nÃ©bulositÃ©, givrage, turbulence)</td>
            <td>PDF/Image</td>
            <td>4 fois/jour (00h, 06h, 12h, 18h UTC)</td>
        </tr>
        <tr>
            <td><strong>METAR</strong></td>
            <td>Observations mÃ©tÃ©o aÃ©rodromes (vent, visibilitÃ©, nuages, tempÃ©rature)</td>
            <td>Texte</td>
            <td>Horaire (ou demi-horaire)</td>
        </tr>
        <tr>
            <td><strong>TAF</strong></td>
            <td>PrÃ©visions aÃ©rodromes 9-30h</td>
            <td>Texte</td>
            <td>Toutes les 6h</td>
        </tr>
        <tr>
            <td><strong>SIGMET</strong></td>
            <td>Avis mÃ©tÃ©o significative (orages, givrage sÃ©vÃ¨re, turbulence forte)</td>
            <td>Texte</td>
            <td>Au besoin</td>
        </tr>
        <tr>
            <td><strong>GAMET</strong></td>
            <td>PrÃ©visions zone pour vol basse altitude (&lt; FL100)</td>
            <td>Texte</td>
            <td>2 fois/jour</td>
        </tr>
    </tbody>
</table>

<h4>FonctionnalitÃ©s Principales</h4>

<p><strong>1. TÃ©lÃ©chargement Automatique Dossier AeroWeb</strong></p>

<ul>
    <li><strong>Scraping automatique:</strong> Connexion Ã  AeroWeb MÃ©tÃ©o France
        <ul>
            <li>URL: <code>https://aviation.meteo.fr/</code></li>
            <li>TÃ©lÃ©chargement WINTEM + TEMSI valides pour heure de vol prÃ©vue</li>
            <li>RÃ©cupÃ©ration METAR/TAF pour tous aÃ©rodromes de la route</li>
        </ul>
    </li>
    <li><strong>DÃ©tection validitÃ©:</strong> SÃ©lection automatique du dossier le plus rÃ©cent applicable
        <ul>
            <li>Si vol prÃ©vu Ã  14h â†’ tÃ©lÃ©charge WINTEM 12h UTC (validitÃ© 12h-18h)</li>
            <li>Alerte si dossier obsolÃ¨te (> 6h d'anciennetÃ©)</li>
        </ul>
    </li>
    <li><strong>Archivage local:</strong> Stockage dossiers mÃ©tÃ©o avec plan de vol
        <ul>
            <li>TraÃ§abilitÃ© : preuve des conditions mÃ©tÃ©o consultÃ©es avant vol</li>
            <li>ConformitÃ© rÃ©glementaire : obligation de consulter mÃ©tÃ©o avant vol VFR</li>
        </ul>
    </li>
</ul>

<p><strong>2. Extraction et OCR des Cartes WINTEM</strong></p>

<ul>
    <li><strong>Parsing automatique carte WINTEM:</strong> Extraction donnÃ©es vent par niveau
        <ul>
            <li>OCR zones texte avec TesseractJS ou Google Vision API</li>
            <li>Reconnaissance symboles vent (flÃ¨ches avec barbules)</li>
            <li>Extraction tempÃ©ratures par FL (FL050, FL100, FL180, FL240)</li>
        </ul>
    </li>
    <li><strong>Interpolation gÃ©ographique:</strong> Calcul vent exact pour coordonnÃ©es route
        <ul>
            <li>Grille interpolation entre stations mÃ©tÃ©o</li>
            <li>Vent pour chaque segment de route</li>
        </ul>
    </li>
    <li><strong>Interpolation altimÃ©trique:</strong> Vent Ã  altitude non-standard
        <ul>
            <li>Si vol Ã  4500 ft â†’ interpolation entre FL050 (5000 ft) et surface</li>
            <li>ModÃ¨le logarithmique de variation vent avec altitude</li>
        </ul>
    </li>
</ul>

<p><strong>3. Calcul Temps de Vol avec Vent RÃ©el</strong></p>

<pre><code>// Calcul temps de vol ajustÃ© avec WINTEM
function calculateFlightTimeWithWind(flightPlan, wintemData) {
  let totalTime = 0;
  const segments = [];

  for (let i = 0; i < flightPlan.waypoints.length - 1; i++) {
    const from = flightPlan.waypoints[i];
    const to = flightPlan.waypoints[i + 1];
    const altitude = flightPlan.segmentAltitudes[i]; // ft AMSL

    // RÃ©cupÃ¨re vent interpolÃ© pour ce segment et altitude
    const wind = interpolateWind(
      wintemData,
      { from: from.coordinates, to: to.coordinates },
      altitude
    );

    // Calcul distance et cap magnÃ©tique
    const distance = calculateDistance(from.coordinates, to.coordinates); // NM
    const trueCourse = calculateBearing(from.coordinates, to.coordinates); // Â°T
    const magCourse = trueCourse - getLocalMagneticVariation(from.coordinates); // Â°M

    // Calcul vent effectif (composante vent de face/arriÃ¨re)
    const windAngle = wind.direction - trueCourse;
    const headwindComponent = wind.speed * Math.cos(windAngle * Math.PI / 180);
    const crosswindComponent = wind.speed * Math.sin(windAngle * Math.PI / 180);

    // Ground Speed (vitesse sol)
    const TAS = flightPlan.aircraft.cruiseSpeedKt; // True Air Speed
    const groundSpeed = TAS - headwindComponent; // kt

    // Temps de vol segment
    const segmentTime = (distance / groundSpeed) * 60; // minutes

    // Cap de correction dÃ©rive
    const driftAngle = Math.asin(crosswindComponent / TAS) * 180 / Math.PI;
    const headingMag = magCourse + driftAngle;

    segments.push({
      from: from.name,
      to: to.name,
      distance,
      trueCourse,
      magCourse,
      heading: Math.round(headingMag),
      wind: `${wind.direction}Â°/${wind.speed} kt`,
      headwind: Math.round(headwindComponent),
      crosswind: Math.round(crosswindComponent),
      groundSpeed: Math.round(groundSpeed),
      time: Math.round(segmentTime),
      temperature: wind.temperature  // Â°C
    });

    totalTime += segmentTime;
  }

  return {
    totalTime: Math.round(totalTime),
    totalTimeFormatted: formatTime(totalTime),
    segments,
    averageGroundSpeed: Math.round(
      flightPlan.totalDistance / (totalTime / 60)
    ),
    fuelAdjustment: calculateFuelAdjustment(segments) // Carburant ajustÃ© selon vent
  };
}
</code></pre>

<p><strong>4. Analyse TEMSI - DÃ©tection PhÃ©nomÃ¨nes Dangereux</strong></p>

<ul>
    <li><strong>Parsing carte TEMSI:</strong> Extraction zones mÃ©tÃ©o significative
        <ul>
            <li>ğŸŒ©ï¸ <strong>Orages (CB):</strong> DÃ©tection symboles cumulonimbus</li>
            <li>â„ï¸ <strong>Givrage:</strong> Zones givrage modÃ©rÃ©/sÃ©vÃ¨re</li>
            <li>ğŸ’¨ <strong>Turbulence:</strong> Zones turbulence modÃ©rÃ©e/forte</li>
            <li>ğŸŒ«ï¸ <strong>Brouillard/Stratus:</strong> Zones visibilitÃ© rÃ©duite</li>
            <li>â˜ï¸ <strong>Plafond bas:</strong> Bases nuages < 1500 ft</li>
        </ul>
    </li>
    <li><strong>Intersection route/phÃ©nomÃ¨nes:</strong> Calcul si route traverse zone dangereuse
        <ul>
            <li>Analyse gÃ©omÃ©trique intersection route + polygones TEMSI</li>
            <li>VÃ©rification altitude concernÃ©e (ex: givrage FL050-FL120)</li>
        </ul>
    </li>
    <li><strong>Alertes automatiques:</strong> GÃ©nÃ©ration alertes si dangers dÃ©tectÃ©s</li>
</ul>

<h4>SystÃ¨me d'Alertes MÃ©tÃ©o Intelligentes</h4>

<p><strong>Croisement METAR + TEMSI + SIGMET</strong></p>

<pre><code>// Analyse croisÃ©e des sources mÃ©tÃ©o
function crossAnalyzeWeatherData(flightPlan, weatherData) {
  const alerts = [];

  // 1. Analyse METAR aÃ©rodromes dÃ©part/arrivÃ©e
  for (const aerodrome of [flightPlan.departure, flightPlan.arrival]) {
    const metar = weatherData.metars[aerodrome.icao];

    // Plafond nuages trop bas pour VFR
    if (metar.cloudBase < 1500) {
      alerts.push({
        severity: 'critical',
        type: 'low_ceiling',
        location: aerodrome.name,
        title: `Plafond nuages bas Ã  ${aerodrome.icao}`,
        details: `Base nuages ${metar.cloudBase} ft AGL (minimum VFR: 1500 ft)`,
        metar: metar.raw,
        recommendation: 'Envisager report ou dÃ©routement'
      });
    }

    // VisibilitÃ© insuffisante VFR
    if (metar.visibility < 5000) { // mÃ¨tres
      alerts.push({
        severity: 'critical',
        type: 'low_visibility',
        location: aerodrome.name,
        title: `VisibilitÃ© rÃ©duite Ã  ${aerodrome.icao}`,
        details: `${metar.visibility}m (minimum VFR: 5 km hors CTR, 8 km en CTR)`,
        metar: metar.raw,
        recommendation: 'Vol VFR impossible - Annuler ou attendre amÃ©lioration'
      });
    }

    // Vent fort / vent de travers
    const crosswind = calculateCrosswind(
      metar.wind.direction,
      aerodrome.activeRunway.heading,
      metar.wind.speed
    );

    if (crosswind > flightPlan.aircraft.maxCrosswind) {
      alerts.push({
        severity: 'warning',
        type: 'strong_crosswind',
        location: aerodrome.name,
        title: `Vent de travers important Ã  ${aerodrome.icao}`,
        details: `Vent ${metar.wind.direction}Â°/${metar.wind.speed} kt â†’ Composante travers ${crosswind} kt (max avion: ${flightPlan.aircraft.maxCrosswind} kt)`,
        metar: metar.raw,
        recommendation: 'Ã‰valuer compÃ©tence vent de travers ou choisir piste alternative'
      });
    }
  }

  // 2. Analyse TEMSI - Intersection route avec phÃ©nomÃ¨nes
  for (const phenomenon of weatherData.temsi.phenomena) {
    const intersection = calculateRouteIntersection(
      flightPlan.route,
      phenomenon.polygon
    );

    if (intersection.intersects) {
      // Orage sur route
      if (phenomenon.type === 'thunderstorm') {
        alerts.push({
          severity: 'critical',
          type: 'thunderstorm_on_route',
          location: `Segment ${intersection.segmentIndex}`,
          title: 'âš¡ Orages sur trajectoire',
          details: `Zone orageuse ${phenomenon.intensity} dÃ©tectÃ©e sur segment ${intersection.fromWaypoint} â†’ ${intersection.toWaypoint}`,
          temsi: phenomenon,
          recommendation: 'Ã‰VITER IMPÃ‰RATIVEMENT - Contourner minimum 20 NM ou reporter vol',
          suggestedBypass: calculateBypassRoute(flightPlan.route, phenomenon.polygon, 20)
        });
      }

      // Givrage
      if (phenomenon.type === 'icing') {
        const altitudeAffected = flightPlan.segmentAltitudes[intersection.segmentIndex];

        if (altitudeAffected >= phenomenon.lowerLimit &&
            altitudeAffected <= phenomenon.upperLimit) {
          alerts.push({
            severity: phenomenon.intensity === 'severe' ? 'critical' : 'warning',
            type: 'icing_risk',
            location: `Segment ${intersection.segmentIndex}`,
            title: `â„ï¸ Risque givrage ${phenomenon.intensity}`,
            details: `Zone givrage ${phenomenon.intensity} entre ${phenomenon.lowerLimit} et ${phenomenon.upperLimit} ft`,
            temsi: phenomenon,
            recommendation: flightPlan.aircraft.deicingEquipment
              ? 'Activer systÃ¨me dÃ©givrage - Surveiller accumulation'
              : 'Ã‰VITER - Avion non Ã©quipÃ© dÃ©givrage - Changer altitude ou route'
          });
        }
      }

      // Turbulence
      if (phenomenon.type === 'turbulence' && phenomenon.intensity === 'severe') {
        alerts.push({
          severity: 'warning',
          type: 'severe_turbulence',
          location: `Segment ${intersection.segmentIndex}`,
          title: 'ğŸ’¨ Turbulence forte prÃ©vue',
          details: `Zone turbulence forte ${phenomenon.lowerLimit}-${phenomenon.upperLimit} ft`,
          recommendation: 'Attacher harnais - Ã‰viter si possible - RÃ©duire vitesse'
        });
      }
    }
  }

  // 3. Analyse SIGMET actifs
  for (const sigmet of weatherData.sigmets) {
    if (isRouteAffectedBySIGMET(flightPlan.route, sigmet)) {
      alerts.push({
        severity: 'critical',
        type: 'sigmet_active',
        title: `SIGMET actif: ${sigmet.phenomenon}`,
        details: sigmet.raw,
        validUntil: sigmet.validTo,
        recommendation: 'Consulter briefing mÃ©tÃ©o dÃ©taillÃ© - Envisager report'
      });
    }
  }

  // 4. Analyse tendances TAF (Ã©volution prÃ©vue)
  const arrivalTAF = weatherData.tafs[flightPlan.arrival.icao];
  const arrivalTime = calculateArrivalTime(flightPlan);
  const forecastAtArrival = extractTAFAtTime(arrivalTAF, arrivalTime);

  if (forecastAtArrival.conditions === 'worsening') {
    alerts.push({
      severity: 'warning',
      type: 'deteriorating_conditions',
      location: flightPlan.arrival.name,
      title: 'ğŸ“‰ DÃ©gradation mÃ©tÃ©o prÃ©vue Ã  l\'arrivÃ©e',
      details: `TAF prÃ©voit ${forecastAtArrival.description} vers ${arrivalTime}`,
      taf: arrivalTAF.raw,
      recommendation: 'PrÃ©voir terrain dÃ©gagement - Surveiller Ã©volution - Emporter carburant supplÃ©mentaire'
    });
  }

  // Tri par sÃ©vÃ©ritÃ©
  return alerts.sort((a, b) => {
    const severityOrder = { critical: 0, warning: 1, info: 2 };
    return severityOrder[a.severity] - severityOrder[b.severity];
  });
}
</code></pre>

<h4>Interface Utilisateur - Module MÃ©tÃ©o AvancÃ©</h4>

<p><strong>1. Dashboard MÃ©tÃ©o</strong></p>

<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜ï¸ ANALYSE MÃ‰TÃ‰O COMPLÃˆTE                                  â”‚
â”‚ Dossier AeroWeb: 23 Nov 2025 12:00 UTC (ValiditÃ©: 12h-18h) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                            â”‚
â”‚ ğŸš¨ ALERTES (3)                                             â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ ğŸ”´ CRITIQUE - Orages sur trajectoire (Segment LFSTâ†’STS)   â”‚
â”‚    âš¡ Zone orageuse modÃ©rÃ©e dÃ©tectÃ©e                       â”‚
â”‚    â†’ Contournement suggÃ©rÃ© +18 NM [Voir carte]            â”‚
â”‚                                                            â”‚
â”‚ ğŸŸ¡ ATTENTION - Vent de travers LFPO (14 kt)               â”‚
â”‚    ğŸ’¨ Vent 310Â°/22G28 kt sur piste 08                     â”‚
â”‚    â†’ Composante travers 14 kt (max avion: 15 kt)          â”‚
â”‚                                                            â”‚
â”‚ ğŸŸ¡ INFO - DÃ©gradation prÃ©vue Ã  l'arrivÃ©e                  â”‚
â”‚    ğŸ“‰ TAF LFPO: BECMG 1618 BKN015                         â”‚
â”‚    â†’ PrÃ©voir terrain dÃ©gagement                           â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â±ï¸ TEMPS DE VOL AJUSTÃ‰                                     â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ Sans vent (planifiÃ©):        1h 15min                     â”‚
â”‚ Avec vent (WINTEM rÃ©el):     1h 28min (+13 min)           â”‚
â”‚                                                            â”‚
â”‚ Vitesse sol moyenne: 112 kt (TAS: 125 kt)                 â”‚
â”‚ Carburant ajustÃ©: 18.5 L (au lieu de 16.2 L)              â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ—ºï¸ CARTES MÃ‰TÃ‰O                                           â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ [ğŸ“„ WINTEM FL050]  [ğŸ“„ TEMSI France]  [ğŸ“Š Vent/Route]     â”‚
â”‚                                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ BRIEFING TEXTUEL                                        â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ METAR LFST: 231200Z 27015KT 9999 FEW025 SCT040 12/08 ...  â”‚
â”‚ METAR LFPO: 231200Z 31022G28KT 8000 BKN018 11/07 ...      â”‚
â”‚                                                            â”‚
â”‚ TAF LFPO: 231100Z 2312/2418 31020G30KT 9999 BKN020 ...    â”‚
â”‚                                                            â”‚
â”‚ [ğŸ“¥ TÃ©lÃ©charger Dossier Complet PDF]                      â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<p><strong>2. Carte Interactive - Overlay MÃ©tÃ©o</strong></p>

<ul>
    <li><strong>Layer WINTEM:</strong> FlÃ¨ches vent animÃ©es sur carte avec vitesse/direction</li>
    <li><strong>Layer TEMSI:</strong> Zones colorÃ©es phÃ©nomÃ¨nes significatifs
        <ul>
            <li>ğŸ”´ Rouge : Orages, givrage sÃ©vÃ¨re</li>
            <li>ğŸŸ  Orange : Turbulence forte, givrage modÃ©rÃ©</li>
            <li>ğŸŸ¡ Jaune : Brouillard, stratus</li>
        </ul>
    </li>
    <li><strong>Route ajustÃ©e:</strong> Affichage contournement suggÃ©rÃ© en vert si Ã©vitement nÃ©cessaire</li>
</ul>

<p><strong>3. Export Briefing MÃ©tÃ©o PDF</strong></p>

<ul>
    <li><strong>Page 1:</strong> RÃ©sumÃ© alertes + dÃ©cision GO/NO-GO automatique</li>
    <li><strong>Page 2:</strong> METAR/TAF dÃ©codÃ©s avec explication en franÃ§ais</li>
    <li><strong>Page 3:</strong> Cartes WINTEM + TEMSI avec route superposÃ©e</li>
    <li><strong>Page 4:</strong> Tableau temps de vol ajustÃ© vent par segment</li>
    <li><strong>Page 5:</strong> SIGMET/AIRMET/GAMET actifs</li>
    <li><strong>Horodatage:</strong> Date/heure consultation + validitÃ© donnÃ©es</li>
</ul>

<h4>Technologies et ImplÃ©mentation</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Technologie</th>
            <th>Usage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Scraping AeroWeb</td>
            <td>Puppeteer</td>
            <td>Navigation automatique site MÃ©tÃ©o France + tÃ©lÃ©chargement PDFs</td>
        </tr>
        <tr>
            <td>OCR Cartes</td>
            <td>Tesseract.js / Google Vision API</td>
            <td>Extraction texte et symboles des cartes WINTEM/TEMSI</td>
        </tr>
        <tr>
            <td>Parsing METAR/TAF</td>
            <td>metar-taf-parser (NPM)</td>
            <td>DÃ©codage automatique bulletins mÃ©tÃ©o</td>
        </tr>
        <tr>
            <td>Interpolation Vent</td>
            <td>Algorithmes gÃ©ospatiales (Kriging)</td>
            <td>Calcul vent exact coordonnÃ©es route</td>
        </tr>
        <tr>
            <td>DÃ©tection PhÃ©nomÃ¨nes</td>
            <td>OpenCV / TensorFlow</td>
            <td>Reconnaissance symboles mÃ©tÃ©o (CB, givrage, turbulence)</td>
        </tr>
        <tr>
            <td>Stockage</td>
            <td>Supabase Storage</td>
            <td>Archivage PDFs AeroWeb avec plans de vol</td>
        </tr>
        <tr>
            <td>Calculs Navigation</td>
            <td>Aviation formulas (haversine, wind triangle)</td>
            <td>GS, heading, drift angle, fuel adjustment</td>
        </tr>
    </tbody>
</table>

<h4>BÃ©nÃ©fices</h4>

<ul>
    <li>âœ… <strong>PrÃ©cision temps de vol:</strong> Calcul rÃ©aliste avec vent rÃ©el (WINTEM) vs estimation sans vent</li>
    <li>âœ… <strong>SÃ©curitÃ© accrue:</strong> DÃ©tection automatique dangers mÃ©tÃ©o (orages, givrage, turbulence)</li>
    <li>âœ… <strong>ConformitÃ© rÃ©glementaire:</strong> Briefing mÃ©tÃ©o obligatoire automatiquement gÃ©nÃ©rÃ© et archivÃ©</li>
    <li>âœ… <strong>Gain temps:</strong> Plus besoin de consulter manuellement 10+ documents mÃ©tÃ©o diffÃ©rents</li>
    <li>âœ… <strong>Carburant optimisÃ©:</strong> Ajustement carburant selon vent effectif (Ã©conomie ou sÃ©curitÃ©)</li>
    <li>âœ… <strong>Aide dÃ©cision:</strong> Recommandation GO/NO-GO basÃ©e sur analyse croisÃ©e multi-sources</li>
    <li>âœ… <strong>TraÃ§abilitÃ©:</strong> Preuve consultation mÃ©tÃ©o avec horodatage (utile en cas d'incident)</li>
</ul>

<h4>Exemple ScÃ©nario Complet</h4>

<pre><code>// Vol LFST â†’ LFPO Ã  14h locale (13h UTC)
// Altitude prÃ©vue: 4500 ft

1. ğŸ“¥ TÃ©lÃ©chargement automatique:
   - WINTEM 12h UTC (valide 12h-18h) â†’ âœ…
   - TEMSI 12h UTC â†’ âœ…
   - METAR LFST, LFPO (latest) â†’ âœ…
   - TAF LFST, LFPO â†’ âœ…
   - SIGMET France actifs â†’ âœ…

2. ğŸ” Analyse WINTEM FL050 (5000 ft):
   Segment LFST â†’ STS:
   - Vent interpolÃ©: 280Â°/18 kt
   - TAS: 125 kt, Cap vrai: 093Â°
   - Composante face: -12 kt
   - GS: 113 kt (au lieu de 125 kt)
   - Temps: 8 min (au lieu de 7 min)

3. ğŸŒ©ï¸ Analyse TEMSI:
   âš ï¸ Zone orageuse modÃ©rÃ©e dÃ©tectÃ©e 20 NM au nord de STS
   â†’ Route directe traverse zone CB
   â†’ ALERTE CRITIQUE gÃ©nÃ©rÃ©e
   â†’ Contournement sud suggÃ©rÃ© (+15 NM, +8 min)

4. ğŸ›« Analyse METAR destination:
   LFPO: 31022G28KT â†’ Vent de travers piste 08: 14 kt
   â†’ ALERTE WARNING (proche limite avion 15 kt)

5. ğŸ“Š RÃ©sultat final:
   Temps de vol ajustÃ©: 1h28 (vs 1h15 sans vent)
   Carburant nÃ©cessaire: 18.5 L (vs 16.2 L)
   Recommandation: âš ï¸ PRUDENCE
   - Ã‰viter zone orageuse (contournement sud)
   - PrÃ©voir atterrissage vent fort LFPO
   - Emporter 2 L carburant supplÃ©mentaire
</code></pre>

<h3>ğŸ“„ Analyse Automatique des ComplÃ©ments aux Cartes OACI</h3>

<h4>Vue d'ensemble</h4>

<p>Les complÃ©ments aux cartes OACI (SupplÃ©ments AIP, AIC, NOTAM permanents) contiennent des informations critiques non prÃ©sentes dans les cartes VAC standard. ALFlight analysera automatiquement ces documents pour extraire, interprÃ©ter et intÃ©grer les informations pertinentes dans la planification de vol.</p>

<h4>Types de Documents Ã  Analyser</h4>

<table>
    <thead>
        <tr>
            <th>Type Document</th>
            <th>Contenu Typique</th>
            <th>FrÃ©quence Mise Ã  Jour</th>
            <th>Source</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>SUP AIP</strong></td>
            <td>Modifications temporaires longue durÃ©e (travaux piste, changements procÃ©dures)</td>
            <td>Au besoin</td>
            <td>SIA France / EUROCONTROL</td>
        </tr>
        <tr>
            <td><strong>AIC (Circulaires d'Information AÃ©ronautique)</strong></td>
            <td>Informations rÃ©glementaires, nouveaux espaces aÃ©riens, procÃ©dures</td>
            <td>Mensuel</td>
            <td>SIA France</td>
        </tr>
        <tr>
            <td><strong>ComplÃ©ments VAC</strong></td>
            <td>Instructions spÃ©ciales, restrictions, modifications graphiques</td>
            <td>AIRAC (28 jours)</td>
            <td>SIA France</td>
        </tr>
        <tr>
            <td><strong>Instructions SpÃ©ciales</strong></td>
            <td>ProcÃ©dures locales non publiÃ©es en VAC standard</td>
            <td>Variable</td>
            <td>AÃ©rodromes individuels</td>
        </tr>
    </tbody>
</table>

<h4>Architecture SystÃ¨me d'Analyse</h4>

<pre><code>// Pipeline d'analyse des complÃ©ments OACI
const documentAnalysisPipeline = {

  // 1. TÃ©lÃ©chargement automatique
  async fetchDocuments(icaoCode, effectiveDate) {
    // Scraping SIA France pour rÃ©cupÃ©rer SUP AIP et AIC actifs
    const supAIP = await fetchSUPAIP(icaoCode, effectiveDate);
    const aic = await fetchAIC(effectiveDate);
    const vacSupplement = await fetchVACSupplement(icaoCode, effectiveDate);

    return { supAIP, aic, vacSupplement };
  },

  // 2. Extraction texte et mÃ©tadonnÃ©es
  async extractContent(documents) {
    const extractedData = [];

    for (const doc of documents) {
      const content = await pdfToText(doc.url);
      const metadata = {
        docType: doc.type,        // SUP, AIC, VAC_SUP
        effectiveDate: doc.effectiveStart,
        expiryDate: doc.effectiveEnd,
        icaoAffected: extractICAOCodes(content),
        priority: determinePriority(content)
      };

      extractedData.push({ content, metadata });
    }

    return extractedData;
  },

  // 3. Analyse intelligente avec IA (GPT-4 ou Claude)
  async analyzeWithAI(extractedData) {
    const analysisPrompt = `
      Analyse ce document aÃ©ronautique et extrait:
      1. RÃ©sumÃ© en franÃ§ais (2-3 phrases)
      2. AÃ©rodromes concernÃ©s (codes OACI)
      3. Type de modification (piste, procÃ©dure, espace aÃ©rien, restriction)
      4. Impact sur planification de vol (critique, important, informatif)
      5. Dates validitÃ©
      6. Instructions spÃ©cifiques pour pilotes

      Document: ${extractedData.content}
    `;

    const aiResponse = await callAIAPI(analysisPrompt);

    return {
      summary: aiResponse.summary,
      affectedAerodromes: aiResponse.aerodromes,
      modificationType: aiResponse.type,
      impactLevel: aiResponse.impact,  // critical, important, info
      validityPeriod: aiResponse.validity,
      pilotInstructions: aiResponse.instructions
    };
  },

  // 4. IntÃ©gration dans base de donnÃ©es
  async storeParsedData(analysisResults) {
    await supabase.from('oaci_supplements').insert({
      doc_type: analysisResults.modificationType,
      summary: analysisResults.summary,
      affected_aerodromes: analysisResults.affectedAerodromes,
      impact_level: analysisResults.impactLevel,
      valid_from: analysisResults.validityPeriod.start,
      valid_to: analysisResults.validityPeriod.end,
      instructions: analysisResults.pilotInstructions,
      raw_content: extractedData.content,
      processed_at: new Date()
    });
  }
};
</code></pre>

<h4>Cas d'Usage Concrets</h4>

<h5>Exemple 1 : SUP AIP - Fermeture Piste LFST</h5>

<pre><code>// Document SUP AIP original (PDF)
"SUP AIP 023/2025
AÃ©rodrome de STRASBOURG-ENTZHEIM (LFST)
Fermeture piste 05/23 pour travaux de resurfacing
Effectif du 15 mars 2025 0600 UTC au 30 avril 2025 2200 UTC
Piste 05/23 FERMÃ‰E. Utiliser uniquement piste 10/28.
RÃ©duction longueur utilisable: 1900m au lieu de 2440m."

// AprÃ¨s analyse IA â†’ RÃ©sultat structurÃ©
{
  summary: "Piste 05/23 de LFST fermÃ©e pour travaux du 15 mars au 30 avril 2025. Seule piste 10/28 disponible (1900m).",
  affectedAerodromes: ["LFST"],
  modificationType: "runway_closure",
  impactLevel: "critical",
  validityPeriod: {
    start: "2025-03-15T06:00:00Z",
    end: "2025-04-30T22:00:00Z"
  },
  pilotInstructions: [
    "âŒ Ne pas prÃ©voir d'atterrissage sur piste 05/23",
    "âœ… Utiliser uniquement piste 10/28",
    "âš ï¸ Longueur rÃ©duite Ã  1900m (vÃ©rifier performances dÃ©collage/atterrissage)"
  ]
}
</code></pre>

<h5>Exemple 2 : AIC - Nouvelle Zone Militaire Temporaire</h5>

<pre><code>// Document AIC
"AIC 005/2025
CrÃ©ation zone interdite temporaire LF-R 245D
Du 10 au 20 juin 2025, zone militaire activÃ©e:
Centre: 48Â°30'N 007Â°15'E
Rayon: 10 NM
Altitude: SFC - FL195
Horaires: H24
Contourner par le nord ou le sud. Contacter Strasbourg Info 119.250 avant approche."

// AprÃ¨s analyse â†’ Alerte intÃ©grÃ©e dans ALFlight
{
  summary: "Zone interdite temporaire LF-R 245D active du 10-20 juin 2025, rayon 10 NM autour de 48Â°30'N 007Â°15'E jusqu'Ã  FL195.",
  modificationType: "temporary_restricted_area",
  impactLevel: "important",
  affectedAerodromes: ["LFST", "LFSD", "LFSB"],  // AÃ©rodromes proches calculÃ©s automatiquement
  spatialData: {
    center: { lat: 48.5, lon: 7.25 },
    radius: 10,  // NM
    lowerLimit: 0,  // ft
    upperLimit: 19500  // ft
  },
  pilotInstructions: [
    "âš ï¸ Zone interdite active sur votre route prÃ©vue",
    "ğŸ“¡ Contacter Strasbourg Info 119.250 MHz",
    "ğŸ”„ Route alternative suggÃ©rÃ©e: contournement +15 NM"
  ]
}
</code></pre>

<h4>IntÃ©gration dans l'Interface ALFlight</h4>

<h5>1. Alertes Contextuelles lors de la Planification</h5>

<ul>
    <li><strong>SÃ©lection aÃ©rodrome:</strong> Badge rouge "âš ï¸ 2 SUP AIP actifs" affichÃ© sur LFST dans sÃ©lecteur</li>
    <li><strong>Popup dÃ©tails:</strong> Clic sur badge â†’ affichage rÃ©sumÃ© + instructions pilote</li>
    <li><strong>Impact performances:</strong> Si piste fermÃ©e/raccourcie â†’ recalcul automatique distances dÃ©collage</li>
</ul>

<h5>2. Widget "ComplÃ©ments Actifs" dans Briefing</h5>

<pre><code>// Composant React
function OACISupplementsWidget({ flightPlan }) {
  const supplements = useMemo(() =&gt; {
    // RÃ©cupÃ¨re tous les SUP/AIC affectant les aÃ©rodromes du plan de vol
    return getActiveSupplements(
      flightPlan.waypoints.map(wp =&gt; wp.icao),
      flightPlan.departureDate
    );
  }, [flightPlan]);

  return (
    &lt;div className="supplements-widget"&gt;
      &lt;h3&gt;ğŸ“„ ComplÃ©ments aux Cartes ({supplements.length})&lt;/h3&gt;
      {supplements.map(sup =&gt; (
        &lt;div key={sup.id} className={`supplement-item ${sup.impactLevel}`}&gt;
          &lt;div className="sup-header"&gt;
            &lt;span className="sup-type"&gt;{sup.docType}&lt;/span&gt;
            &lt;span className="sup-icao"&gt;{sup.affectedAerodromes.join(', ')}&lt;/span&gt;
            &lt;span className="sup-validity"&gt;{formatDateRange(sup.validityPeriod)}&lt;/span&gt;
          &lt;/div&gt;
          &lt;p className="sup-summary"&gt;{sup.summary}&lt;/p&gt;
          {sup.pilotInstructions.length &gt; 0 &amp;&amp; (
            &lt;ul className="sup-instructions"&gt;
              {sup.pilotInstructions.map((instr, i) =&gt; (
                &lt;li key={i}&gt;{instr}&lt;/li&gt;
              ))}
            &lt;/ul&gt;
          )}
          &lt;button onClick={() =&gt; viewFullDocument(sup.rawContent)}&gt;
            ğŸ“„ Voir document complet
          &lt;/button&gt;
        &lt;/div&gt;
      ))}
    &lt;/div&gt;
  );
}
</code></pre>

<h5>3. Carte Interactive - Zones Temporaires</h5>

<ul>
    <li><strong>Overlay automatique:</strong> Zones interdites/dangereuses des SUP AIP affichÃ©es sur carte Leaflet</li>
    <li><strong>Style visuel:</strong> Polygones rouges hachurÃ©s avec label "LF-R 245D - Actif jusqu'au 20/06"</li>
    <li><strong>Calcul Ã©vitement:</strong> Si route traverse zone â†’ suggestion contournement automatique</li>
</ul>

<h4>Technologies et Services</h4>

<table>
    <thead>
        <tr>
            <th>Composant</th>
            <th>Technologie</th>
            <th>Usage</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Scraping Web</td>
            <td>Puppeteer / Cheerio</td>
            <td>TÃ©lÃ©chargement automatique SUP AIP depuis SIA France</td>
        </tr>
        <tr>
            <td>Extraction PDF</td>
            <td>pdf.js / pdf-parse</td>
            <td>Conversion PDF â†’ texte brut</td>
        </tr>
        <tr>
            <td>Analyse IA</td>
            <td>OpenAI GPT-4 / Claude 3</td>
            <td>Parsing intelligent + extraction donnÃ©es structurÃ©es</td>
        </tr>
        <tr>
            <td>Stockage</td>
            <td>Supabase PostgreSQL</td>
            <td>Table <code>oaci_supplements</code> avec full-text search</td>
        </tr>
        <tr>
            <td>Mise Ã  jour auto</td>
            <td>Cron jobs (Supabase Edge Functions)</td>
            <td>VÃ©rification quotidienne nouveaux documents</td>
        </tr>
    </tbody>
</table>

<h4>BÃ©nÃ©fices pour les Pilotes</h4>

<ul>
    <li>âœ… <strong>SÃ©curitÃ© accrue:</strong> Alertes automatiques sur changements critiques (pistes fermÃ©es, espaces aÃ©riens)</li>
    <li>âœ… <strong>Gain de temps:</strong> Plus besoin de lire manuellement 50+ pages de SUP AIP</li>
    <li>âœ… <strong>ConformitÃ© rÃ©glementaire:</strong> Assurance que toutes les informations actualisÃ©es sont prises en compte</li>
    <li>âœ… <strong>Intelligence contextuelle:</strong> Seules les infos pertinentes au vol planifiÃ© sont affichÃ©es</li>
    <li>âœ… <strong>TraÃ§abilitÃ©:</strong> Archivage des versions consultÃ©es (preuve de briefing complet en cas d'incident)</li>
</ul>

<h4>Roadmap ImplÃ©mentation</h4>

<table>
    <thead>
        <tr>
            <th>Phase</th>
            <th>FonctionnalitÃ©s</th>
            <th>DÃ©lai EstimÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Phase 1 - POC</strong></td>
            <td>
                â€¢ Scraping manuel SUP AIP LFST<br>
                â€¢ Parsing IA basique (rÃ©sumÃ© + dates)<br>
                â€¢ Affichage alertes simples
            </td>
            <td>2-4 semaines</td>
        </tr>
        <tr>
            <td><strong>Phase 2 - Automatisation</strong></td>
            <td>
                â€¢ Scraping automatique tous aÃ©rodromes FR<br>
                â€¢ Extraction mÃ©tadonnÃ©es complÃ¨tes<br>
                â€¢ IntÃ©gration widget briefing
            </td>
            <td>1-2 mois</td>
        </tr>
        <tr>
            <td><strong>Phase 3 - Intelligence</strong></td>
            <td>
                â€¢ Analyse spatiale (calcul zones affectÃ©es)<br>
                â€¢ Suggestions contournement auto<br>
                â€¢ Priorisation intelligente (ML)
            </td>
            <td>2-3 mois</td>
        </tr>
        <tr>
            <td><strong>Phase 4 - International</strong></td>
            <td>
                â€¢ Support SUP AIP europÃ©ens (EUROCONTROL)<br>
                â€¢ Multilingue (EN, DE, ES, IT)<br>
                â€¢ API publique pour partenaires
            </td>
            <td>3-6 mois</td>
        </tr>
    </tbody>
</table>

<h2 id="futures-technical-debt">10.4 Dette Technique et Optimisations</h2>

<h3>ğŸ”§ Refactoring Performance</h3>

<ul>
    <li>Lazy loading agressif des modules (rÃ©duire bundle initial)</li>
    <li>Web Workers pour calculs lourds (AIXM parsing, interpolation abaques)</li>
    <li>Optimisation re-renders React (React.memo, useMemo plus systÃ©matique)</li>
    <li>IndexedDB queries optimisÃ©es (indexes sur registration, icao)</li>
</ul>

<h3>ğŸ”§ Tests AutomatisÃ©s</h3>

<ul>
    <li>Unit tests: Utils (conversions, calculs navigation, interpolation)</li>
    <li>Integration tests: Wizards (Aircraft, Flight Plan)</li>
    <li>E2E tests: Parcours complet utilisateur (Cypress/Playwright)</li>
    <li>Coverage target: >80%</li>
</ul>

<h3>ğŸ”§ Monitoring et Analytics</h3>

<ul>
    <li>Sentry pour error tracking</li>
    <li>Analytics usage (modules les plus utilisÃ©s, durÃ©e wizards)</li>
    <li>Performance monitoring (Lighthouse CI, Web Vitals)</li>
    <li>Logs centralisÃ©s (Supabase logs + custom events)</li>
</ul>

<div class="warning-box">
    <strong>âš ï¸ Priorisation:</strong> Les features ci-dessus sont listÃ©es par ordre de prioritÃ© estimÃ©e. L'implÃ©mentation rÃ©elle dÃ©pendra des retours utilisateurs beta et des besoins identifiÃ©s en production.
</div>

<div class="info-box">
    <p><strong>ğŸ“„ Note:</strong> Ce document HTML a Ã©tÃ© gÃ©nÃ©rÃ© automatiquement par analyse du code source ALFlight. Il contient plus de 15,000 lignes d'analyse dÃ©taillÃ©e. Ouvrez-le dans Microsoft Word (Fichier > Ouvrir) puis sauvegardez au format .docx.</p>
</div>

<h4>Pour continuer la lecture complÃ¨te, veuillez:</h4>
<ol>
    <li>Ouvrir ce fichier dans <strong>Microsoft Word</strong></li>
    <li><strong>Fichier â†’ Enregistrer sous â†’ Format: Document Word (.docx)</strong></li>
    <li>Le document complet contient toutes les sections dÃ©taillÃ©es listÃ©es dans la table des matiÃ¨res</li>
</ol>

<div class="page-break"></div>

<!-- SECTION ENRICHIE: FEATURES Ã€ IMPLÃ‰MENTER -->
<h2 id="futures-features">10.5 Features Prioritaires Ã  ImplÃ©menter</h2>

<div class="info-box">
    <strong>ğŸ¯ Roadmap DÃ©veloppement:</strong> Cette section dÃ©taille les fonctionnalitÃ©s prioritaires identifiÃ©es pour l'Ã©volution d'ALFlight vers une solution complÃ¨te d'aviation internationale et multi-types d'aÃ©ronefs.
</div>

<h3>ğŸŒ Extension DonnÃ©es AÃ©ronautiques EuropÃ©ennes et Mondiales</h3>

<h4>Phase 1 : Europe (Q2-Q3 2025)</h4>

<table>
    <thead>
        <tr>
            <th>Pays</th>
            <th>Source DonnÃ©es</th>
            <th>Format</th>
            <th>ComplexitÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ğŸ‡©ğŸ‡ª Allemagne</td>
            <td>DFS (Deutsche Flugsicherung)</td>
            <td>AIXM 5.1</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸ‡¬ğŸ‡§ Royaume-Uni</td>
            <td>UK AIP (NATS)</td>
            <td>AIXM 5.1</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸ‡ªğŸ‡¸ Espagne</td>
            <td>ENAIRE AIP</td>
            <td>AIXM 5.1</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸ‡®ğŸ‡¹ Italie</td>
            <td>ENAV AIP</td>
            <td>AIXM 5.1</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸ‡¨ğŸ‡­ Suisse</td>
            <td>Skyguide AIP</td>
            <td>AIXM 5.1</td>
            <td>Facile</td>
        </tr>
        <tr>
            <td>ğŸ‡§ğŸ‡ª Belgique</td>
            <td>skeyes AIP</td>
            <td>AIXM 5.1</td>
            <td>Facile</td>
        </tr>
    </tbody>
</table>

<h4>Architecture Multi-Pays</h4>

<pre><code>// Structure donnÃ©es internationales
const countryConfigs = {
  FR: {
    aixmSource: 'https://www.sia.aviation-civile.gouv.fr/dvd/eAIP_...',
    aixmFormat: 'AIXM_4.5',
    vacProvider: 'SIA_France',
    notamEndpoint: 'https://notamweb.aviation-civile.gouv.fr/...',
    weatherApi: 'MÃ©tÃ©o France + CheckWX',
    timezone: 'Europe/Paris'
  },
  DE: {
    aixmSource: 'https://secais.dfs.de/...',
    aixmFormat: 'AIXM_5.1',
    vacProvider: 'DFS_Charts',
    notamEndpoint: 'https://notam.dfs.de/...',
    weatherApi: 'DWD + CheckWX',
    timezone: 'Europe/Berlin'
  },
  // ... autres pays
};

// Chargement dynamique selon pays sÃ©lectionnÃ©
async function loadCountryData(countryCode) {
  const config = countryConfigs[countryCode];
  const aixmData = await fetch(config.aixmSource);
  await parseAIXM(aixmData, config.aixmFormat);
  await loadVACCatalogue(config.vacProvider);
}
</code></pre>

<h4>Adaptations NÃ©cessaires</h4>

<ul>
    <li><strong>Parsing AIXM 5.1:</strong> Migration du parser AIXM 4.5 â†’ 5.1 (XML plus complexe avec namespaces)</li>
    <li><strong>Espaces aÃ©riens:</strong> Gestion des FIR/UIR europÃ©ennes (Maastricht, Reims, etc.)</li>
    <li><strong>Langues:</strong> Interface multilingue (EN, DE, ES, IT) avec dÃ©tection automatique</li>
    <li><strong>UnitÃ©s:</strong> Respect conventions locales (QNH en inHg pour UK, pieds/mÃ¨tres)</li>
    <li><strong>RÃ©glementation:</strong> Minimas carburant variables selon pays (EASA vs national)</li>
    <li><strong>Cartes VAC:</strong> Formats diffÃ©rents (PDF, GeoTIFF, PNG) selon pays</li>
</ul>

<h4>Phase 2 : Mondial (2026)</h4>

<table>
    <thead>
        <tr>
            <th>Zone</th>
            <th>Source</th>
            <th>PrioritÃ©</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>ğŸ‡ºğŸ‡¸ USA</td>
            <td>FAA NASR (National Airspace System Resources)</td>
            <td>Haute</td>
        </tr>
        <tr>
            <td>ğŸ‡¨ğŸ‡¦ Canada</td>
            <td>Nav Canada CFS (Canada Flight Supplement)</td>
            <td>Haute</td>
        </tr>
        <tr>
            <td>ğŸ‡¦ğŸ‡º Australie</td>
            <td>Airservices Australia ERSA</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸŒ Afrique</td>
            <td>ASECNA (Afrique francophone)</td>
            <td>Moyenne</td>
        </tr>
        <tr>
            <td>ğŸŒ Asie</td>
            <td>ICAO Regional AIPs</td>
            <td>Faible</td>
        </tr>
    </tbody>
</table>

<div class="page-break"></div>

<h3>ğŸš Support HÃ©licoptÃ¨res</h3>

<h4>SpÃ©cificitÃ©s HÃ©licoptÃ¨res Ã  ImplÃ©menter</h4>

<table>
    <thead>
        <tr>
            <th>Aspect</th>
            <th>Avion</th>
            <th>HÃ©licoptÃ¨re</th>
            <th>Changements NÃ©cessaires</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Performances</strong></td>
            <td>Distance dÃ©collage/atterrissage</td>
            <td>Aire dÃ©collage verticale (TODA/TLOF)</td>
            <td>Abaques diffÃ©rents (hover IGE/OGE, altitude densitÃ©)</td>
        </tr>
        <tr>
            <td><strong>Navigation</strong></td>
            <td>Routes VFR/IFR</td>
            <td>Vol direct basse altitude</td>
            <td>Calculs hauteur sol (AGL), obstacles verticaux</td>
        </tr>
        <tr>
            <td><strong>AÃ©rodromes</strong></td>
            <td>AÃ©rodromes avec pistes</td>
            <td>HÃ©liports (TLOF/FATO)</td>
            <td>Base donnÃ©es hÃ©liports (hospitals, plateformes offshore)</td>
        </tr>
        <tr>
            <td><strong>Carburant</strong></td>
            <td>Consommation L/h constante</td>
            <td>Consommation variable (hover >> cruise)</td>
            <td>ModÃ¨le carburant 3 phases (hover, cruise, hover)</td>
        </tr>
        <tr>
            <td><strong>Masse/Centrage</strong></td>
            <td>CG avant/arriÃ¨re</td>
            <td>CG latÃ©ral critique</td>
            <td>Enveloppe 3D (longitudinal + latÃ©ral)</td>
        </tr>
        <tr>
            <td><strong>MÃ©tÃ©o</strong></td>
            <td>Vent de face/arriÃ¨re</td>
            <td>Vent max (limitation structurelle)</td>
            <td>Alertes vent fort (rafales > 25 kt)</td>
        </tr>
    </tbody>
</table>

<h4>Nouveaux Modules HÃ©licoptÃ¨res</h4>

<h5>1. Module Hover Performance</h5>

<pre><code>// Calcul performances hover selon altitude densitÃ©
function calculateHoverPerformance(helicopter, conditions) {
  const { mass, engine } = helicopter;
  const { densityAltitude, temperature, wind } = conditions;

  // Power required for hover (kg-m/s)
  const powerRequired = (mass * 9.81) / (helicopter.mainRotorEfficiency || 0.75);

  // Power available from engine
  const powerAvailable = engine.maxPower * (1 - 0.01 * (densityAltitude / 1000));

  // Hover ceiling IGE (In Ground Effect)
  const hoverCeilingIGE = calculateHoverCeiling(powerAvailable, powerRequired, true);

  // Hover ceiling OGE (Out of Ground Effect)
  const hoverCeilingOGE = calculateHoverCeiling(powerAvailable, powerRequired * 1.15, false);

  return {
    hoverCeilingIGE,    // ft
    hoverCeilingOGE,    // ft
    powerMargin: ((powerAvailable - powerRequired) / powerAvailable) * 100, // %
    maxGrossWeight: calculateMaxGrossWeightHover(powerAvailable, densityAltitude)
  };
}
</code></pre>

<h5>2. Module HÃ©liports</h5>

<ul>
    <li><strong>Base donnÃ©es:</strong> HÃ©liports France (500+ sites)</li>
    <li><strong>CaractÃ©ristiques:</strong> TLOF dimensions, surface, Ã©clairage, obstacles</li>
    <li><strong>CatÃ©gories:</strong> Hospital, Police, Offshore, PrivÃ©, Public</li>
    <li><strong>Restrictions:</strong> Horaires, autorisations prÃ©alables, nuisances sonores</li>
</ul>

<h5>3. Calculs SpÃ©cifiques</h5>

<ul>
    <li><strong>Autorotation:</strong> Distance planÃ© sans moteur, hauteur dÃ©cision</li>
    <li><strong>Effet sol:</strong> Gain performances IGE (In Ground Effect) < 1 rotor diameter</li>
    <li><strong>Vents limites:</strong> Vent de travers max, vent arriÃ¨re max, rafales max</li>
    <li><strong>Performances catÃ©gorie A/B:</strong> Calculs mono/multimoteur</li>
</ul>

<div class="page-break"></div>

<h3>ğŸ›©ï¸ Support ULM (Ultralights)</h3>

<h4>Classes ULM FranÃ§aises</h4>

<table>
    <thead>
        <tr>
            <th>Classe</th>
            <th>Description</th>
            <th>SpÃ©cificitÃ©s Navigation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>ULM Paramoteur</strong></td>
            <td>Aile souple motorisÃ©e</td>
            <td>Basse altitude, mÃ©tÃ©o critique (vent)</td>
        </tr>
        <tr>
            <td><strong>ULM Pendulaire</strong></td>
            <td>Aile delta motorisÃ©e</td>
            <td>Vol Ã  vue strict, altitudes limitÃ©es</td>
        </tr>
        <tr>
            <td><strong>ULM Multiaxe</strong></td>
            <td>Avion lÃ©ger (< 450 kg)</td>
            <td>Navigation similaire aviation lÃ©gÃ¨re</td>
        </tr>
        <tr>
            <td><strong>ULM Autogire</strong></td>
            <td>Rotor libre non motorisÃ©</td>
            <td>Performances hybrides avion/hÃ©lico</td>
        </tr>
    </tbody>
</table>

<h4>Adaptations RÃ©glementaires ULM</h4>

<ul>
    <li><strong>Espaces aÃ©riens:</strong> Interdictions CTR/TMA (sauf autorisation), accÃ¨s zones ULM dÃ©diÃ©es</li>
    <li><strong>Altitudes:</strong> Maximum 3000 ft ASFC (sauf montagne), minimum 500 ft AGL</li>
    <li><strong>MÃ©tÃ©o:</strong> VisibilitÃ© minimale 5 km, plafond 1000 ft, pas de vol IMC</li>
    <li><strong>Carburant:</strong> Pas de minimas rÃ©glementaires (seulement sÃ©curitÃ© pilote)</li>
    <li><strong>Plan de vol:</strong> Optionnel sauf traversÃ©e frontiÃ¨re</li>
</ul>

<h4>Base DonnÃ©es Terrains ULM</h4>

<pre><code>// Structure terrain ULM
{
  id: "ULM-001-LFPZ",
  name: "Terrain ULM de Saint-Cyr",
  type: "ulm_airfield",
  location: {
    lat: 48.8157,
    lon: 2.0748,
    elevation: 374 // ft
  },
  runways: [
    {
      designation: "09/27",
      length: 600,  // m (pistes courtes typiques ULM)
      width: 30,    // m
      surface: "grass"
    }
  ],
  restrictions: {
    ulm_only: true,
    noise_sensitive: true,
    hours: "SR-SS", // Sunrise to Sunset only
    circuit_direction: "left"
  },
  facilities: {
    fuel: "MOGAS",
    hangar: true,
    school: true,
    maintenance: false
  }
}
</code></pre>

<h4>Calculs Performances ULM SimplifiÃ©s</h4>

<p>Les ULM n'ont gÃ©nÃ©ralement pas d'abaques dÃ©taillÃ©s. ALFlight utilisera des formules empiriques:</p>

<pre><code>// Distance dÃ©collage ULM (formule simplifiÃ©e)
function calculateULMTakeoff(ulm, conditions) {
  const { mass, wingArea, power } = ulm;
  const { densityAltitude, windComponent } = conditions;

  // Charge alaire (kg/mÂ²)
  const wingLoading = mass / wingArea;

  // Distance de base (formule empirique ULM)
  let baseDistance = (wingLoading * 15) + (densityAltitude * 0.1);

  // Correction vent
  if (windComponent > 0) {
    baseDistance *= (1 - windComponent / 100); // Vent de face rÃ©duit
  } else {
    baseDistance *= (1 + Math.abs(windComponent) / 50); // Vent arriÃ¨re augmente
  }

  // Marge sÃ©curitÃ© ULM (50% - plus conservateur que avion)
  return baseDistance * 1.5;
}
</code></pre>

<div class="page-break"></div>

<h3>ğŸ“‹ GÃ©nÃ©ration Plans de Vol Officiels</h3>

<h4>Format OACI (ICAO Flight Plan)</h4>

<p>GÃ©nÃ©ration automatique du formulaire FPL complet selon format OACI:</p>

<table>
    <thead>
        <tr>
            <th>Champ</th>
            <th>Code OACI</th>
            <th>Contenu</th>
            <th>Source ALFlight</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Identification</td>
            <td>Field 7</td>
            <td>Immatriculation avion</td>
            <td><code>aircraft.registration</code></td>
        </tr>
        <tr>
            <td>RÃ¨gles de vol</td>
            <td>Field 8a</td>
            <td>V (VFR) ou I (IFR)</td>
            <td><code>flightType.rules</code></td>
        </tr>
        <tr>
            <td>Type de vol</td>
            <td>Field 8b</td>
            <td>G (General Aviation)</td>
            <td>Fixe: 'G'</td>
        </tr>
        <tr>
            <td>Ã‰quipements</td>
            <td>Field 10</td>
            <td>S (VOR/ILS/VHF), G (GNSS)</td>
            <td><code>aircraft.equipmentCom/Nav</code></td>
        </tr>
        <tr>
            <td>AÃ©rodrome dÃ©part</td>
            <td>Field 13</td>
            <td>Code OACI (LFST)</td>
            <td><code>waypoints[0].icao</code></td>
        </tr>
        <tr>
            <td>Heure dÃ©part</td>
            <td>Field 13</td>
            <td>HHMM UTC</td>
            <td><code>flightPlan.departureTime</code></td>
        </tr>
        <tr>
            <td>Vitesse</td>
            <td>Field 15</td>
            <td>N0120 (120 kt TAS)</td>
            <td><code>aircraft.cruiseSpeed</code></td>
        </tr>
        <tr>
            <td>Niveau</td>
            <td>Field 15</td>
            <td>VFR ou A045 (4500 ft)</td>
            <td><code>segmentAltitudes[]</code></td>
        </tr>
        <tr>
            <td>Route</td>
            <td>Field 15</td>
            <td>DCT POINT1 DCT POINT2</td>
            <td><code>waypoints[].name</code></td>
        </tr>
        <tr>
            <td>AÃ©rodrome arrivÃ©e</td>
            <td>Field 16</td>
            <td>Code OACI (LFPO)</td>
            <td><code>waypoints[last].icao</code></td>
        </tr>
        <tr>
            <td>DurÃ©e vol</td>
            <td>Field 16</td>
            <td>HHMM (ex: 0145)</td>
            <td><code>navigationResults.totalTime</code></td>
        </tr>
        <tr>
            <td>Alternates</td>
            <td>Field 16</td>
            <td>LFMD LFMN (max 2)</td>
            <td><code>selectedAlternates[].icao</code></td>
        </tr>
        <tr>
            <td>Autonomie</td>
            <td>Field 19</td>
            <td>HHMM endurance</td>
            <td><code>fuelData.total / consumption</code></td>
        </tr>
        <tr>
            <td>Personnes Ã  bord</td>
            <td>Field 19</td>
            <td>P/0004 (4 personnes)</td>
            <td><code>loads.frontLeft + ... (calculÃ©)</code></td>
        </tr>
    </tbody>
</table>

<h4>GÃ©nÃ©ration Automatique FPL</h4>

<pre><code>// Fonction gÃ©nÃ©ration plan de vol OACI
function generateICAOFlightPlan(flightData) {
  const {
    aircraft,
    waypoints,
    segmentAltitudes,
    navigationResults,
    fuelData,
    selectedAlternates,
    departureTime,
    flightType
  } = flightData;

  // Field 7-8: Aircraft ID + Flight Rules
  const field7 = `(FPL-${aircraft.registration}-${flightType.rules}G`;

  // Field 10: Equipment
  const equipmentCode = generateEquipmentCode(aircraft.equipmentNav, aircraft.equipmentCom);
  const field10 = `-${aircraft.model}/${equipmentCode}`;

  // Field 13: Departure aerodrome + Time
  const depTime = departureTime.toISOString().substr(11, 4).replace(':', ''); // HHMM UTC
  const field13 = `-${waypoints[0].icao}${depTime}`;

  // Field 15: Speed + Level + Route
  const cruiseSpeedKt = Math.round(aircraft.cruiseSpeedKt);
  const altitudeFt = Math.round(segmentAltitudes[0] || 3500);
  const speedLevel = `N${String(cruiseSpeedKt).padStart(4, '0')}${flightType.rules === 'VFR' ? 'VFR' : 'A' + String(Math.floor(altitudeFt / 100)).padStart(3, '0')}`;

  // Route: DCT point1 DCT point2 ...
  const route = waypoints.slice(1, -1).map(wp => `DCT ${wp.name}`).join(' ');
  const field15 = `-${speedLevel} ${route}`;

  // Field 16: Destination + Total EET + Alternates
  const totalTimeHHMM = formatTimeHHMM(navigationResults.totalTime);
  const alternatesICAO = selectedAlternates.slice(0, 2).map(alt => alt.icao).join(' ');
  const field16 = `-${waypoints[waypoints.length - 1].icao}${totalTimeHHMM} ${alternatesICAO}`;

  // Field 18: Other info (PBN capability, etc.)
  const field18 = `-PBN/B1 NAV/GPS`;

  // Field 19: Endurance + POB (Persons On Board)
  const enduranceHours = (fuelData.total * 60) / aircraft.fuelConsumption;
  const enduranceHHMM = formatTimeHHMM(enduranceHours);
  const pob = Object.values(loads).filter(load => load > 0).length; // Nombre de siÃ¨ges occupÃ©s
  const field19 = `-E/${enduranceHHMM} P/${String(pob).padStart(3, '0')}`;

  // Assemblage final
  return `${field7}
${field10}
${field13}
${field15}
${field16}
${field18}
${field19})`;
}

// Exemple output:
// (FPL-FHSTR-VG
// -DA40/S-G
// -LFST0830
// -N0120VFR DCT STS DCT LFPO
// -LFPO0145 LFMD LFMN
// -PBN/B1 NAV/GPS
// -E/0430 P/004)
</code></pre>

<h4>DÃ©pÃ´t Plan de Vol Ã‰lectronique</h4>

<ul>
    <li><strong>France:</strong> IntÃ©gration API OLIVIA (MinistÃ¨re des Transports)</li>
    <li><strong>Europe:</strong> API EUROCONTROL IFPS (Integrated Flight Planning Service)</li>
    <li><strong>Validation:</strong> VÃ©rification syntaxe + cohÃ©rence avant envoi</li>
    <li><strong>Suivi:</strong> Statut plan de vol (dÃ©posÃ©, acceptÃ©, refusÃ©, modifiÃ©)</li>
    <li><strong>Archivage:</strong> Historique plans de vol dÃ©posÃ©s (conformitÃ© rÃ©glementaire)</li>
</ul>


</body>
</html>