<!DOCTYPE html>
<html>
<head>
    <title>Test API OpenAIP</title>
</head>
<body>
    <h1>Test API OpenAIP</h1>
    <button onclick="testAPI()">Tester l'API</button>
    <button onclick="clearStorage()">Clear Storage</button>
    <pre id="result"></pre>

    <script>
        async function testAPI() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = 'Test en cours...\n\n';
            
            try {
                // Test 1: Health check
                const healthRes = await fetch('http://localhost:3001/api/health');
                const health = await healthRes.json();
                resultDiv.textContent += 'Health Check:\n' + JSON.stringify(health, null, 2) + '\n\n';
                
                // Test 2: Airports
                const airportsRes = await fetch('http://localhost:3001/api/openaip/airports?country=FR&limit=5');
                const airports = await airportsRes.json();
                resultDiv.textContent += 'Airports Response:\n';
                resultDiv.textContent += `Total: ${airports.totalCount || 0}\n`;
                resultDiv.textContent += `Items: ${airports.items?.length || 0}\n`;
                if (airports.items && airports.items[0]) {
                    resultDiv.textContent += `First airport: ${airports.items[0].name} (${airports.items[0].icaoCode})\n`;
                }
                
            } catch (error) {
                resultDiv.textContent += 'ERREUR: ' + error.message + '\n';
                console.error(error);
            }
        }
        
        function clearStorage() {
            localStorage.clear();
            alert('localStorage cleared! Recharger la page.');
        }
    </script>
</body>
</html>