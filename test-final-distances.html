<!DOCTYPE html>
<html>
<head>
    <title>Test Final Distances</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .runway { 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .distances {
            background: white;
            color: #333;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
        }
        .distance-item {
            display: inline-block;
            margin: 5px 10px;
            padding: 5px 10px;
            background: #f0f0f0;
            border-radius: 3px;
        }
        .vfr-points {
            background: #e8f5e9;
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <h1>üõ¨ Test Final - LFST Strasbourg</h1>
    <div id="output">‚è≥ Chargement...</div>
    
    <script type="module">
        import { aixmParser } from '/src/services/aixmParser.js';
        
        async function testFinal() {
            const output = document.getElementById('output');
            
            try {
                const data = await aixmParser.loadAndParse();
                const lfst = data.find(ad => ad.icao === 'LFST');
                
                if (!lfst) {
                    output.innerHTML = '<div class="error">‚ùå LFST non trouv√©!</div>';
                    return;
                }
                
                let html = '<div class="success">‚úÖ LFST trouv√© avec succ√®s!</div>';
                
                // Info g√©n√©rale
                html += '<h2>üìç ' + lfst.name + ' (' + lfst.city + ')</h2>';
                html += '<p>Altitude: ' + lfst.elevation.value + ' ft</p>';
                
                // Pistes
                html += '<h2>üõ¨ Pistes</h2>';
                if (lfst.runways && lfst.runways.length > 0) {
                    for (const runway of lfst.runways) {
                        html += '<div class="runway">';
                        html += '<h3>Piste ' + runway.designation + '</h3>';
                        html += '<div>Dimensions: ' + runway.length + ' √ó ' + runway.width + ' m</div>';
                        html += '<div>Surface: ' + runway.surface + '</div>';
                        html += '<div>QFU: ' + (runway.qfu || runway.magneticBearing) + '¬∞</div>';
                        
                        html += '<div class="distances">';
                        html += '<strong>Distances d√©clar√©es:</strong><br>';
                        
                        const tora = runway.tora !== null ? runway.tora + ' m' : '<span class="error">‚ùå NULL</span>';
                        const toda = runway.toda !== null ? runway.toda + ' m' : '<span class="error">‚ùå NULL</span>';
                        const asda = runway.asda !== null ? runway.asda + ' m' : '<span class="error">‚ùå NULL</span>';
                        const lda = runway.lda !== null ? runway.lda + ' m' : '<span class="error">‚ùå NULL</span>';
                        
                        html += '<span class="distance-item">TORA: <strong>' + tora + '</strong></span>';
                        html += '<span class="distance-item">TODA: <strong>' + toda + '</strong></span>';
                        html += '<span class="distance-item">ASDA: <strong>' + asda + '</strong></span>';
                        html += '<span class="distance-item">LDA: <strong>' + lda + '</strong></span>';
                        
                        if (runway.ils) {
                            html += '<br><br>ILS: CAT ' + runway.ils.category;
                        }
                        
                        html += '</div>';
                        html += '</div>';
                    }
                } else {
                    html += '<div class="error">Aucune piste trouv√©e</div>';
                }
                
                // Points VFR
                html += '<h2>üìç Points VFR</h2>';
                if (lfst.vfrPoints && lfst.vfrPoints.length > 0) {
                    html += '<div class="vfr-points">';
                    html += '<div class="success">‚úÖ ' + lfst.vfrPoints.length + ' points VFR trouv√©s</div>';
                    html += '<ul>';
                    for (let i = 0; i < Math.min(5, lfst.vfrPoints.length); i++) {
                        const point = lfst.vfrPoints[i];
                        html += '<li><strong>' + point.name + '</strong> - ' + point.description + '</li>';
                    }
                    if (lfst.vfrPoints.length > 5) {
                        html += '<li>... et ' + (lfst.vfrPoints.length - 5) + ' autres points</li>';
                    }
                    html += '</ul>';
                    html += '</div>';
                } else {
                    html += '<div class="error">Aucun point VFR trouv√©</div>';
                }
                
                output.innerHTML = html;
                
                // Log pour debug
                console.log('LFST complet:', lfst);
                
            } catch (error) {
                output.innerHTML = '<div class="error">‚ùå Erreur: ' + error.message + '</div>';
                console.error('Erreur:', error);
            }
        }
        
        testFinal();
    </script>
</body>
</html>